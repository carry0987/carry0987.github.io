import{r as o,j as e,w as Ae}from"./chunk-JMJ3UQ3L-DTa-kQyz.js";import{_ as Se,a as je,u as be,C as Ie}from"./OrbitControls-DRK-Wmte.js";import{c as H}from"./createLucideIcon-DJfiQI6J.js";import{H as ze}from"./house-BtsHXS8_.js";import{s as _e,g as Le,r as Oe}from"./index-tSOQ2Rud.js";import{V as D,S as ve,B as Ue,a as Be,j as Te,k as We,_ as Me,h as Ge,aq as Fe,C as ne,M as ge,ao as De,z as Ve,ar as te}from"./three.module-DNtCYGiW.js";import{G as $e}from"./Grid-Cn1Ie2V6.js";import{S as He,a as Ye,R as Ke}from"./smile-aaLCMfHJ.js";import{X as qe}from"./x-DoNpzKz6.js";import{v as Xe,E as Ze}from"./Environment-D3Xp-jp-.js";import{T as Je,C as Qe,a as et}from"./trash-2-BtpQbHB9.js";import{O as tt}from"./OrbitControls-ClhYfUAP.js";import{T as rt}from"./triangle-alert-b9EnD7-w.js";import"./shaderMaterial-BL2Umirn.js";import"./constants-BCyxaF58.js";const st=[["path",{d:"M8 6v6",key:"18i7km"}],["path",{d:"M15 6v6",key:"1sg6z9"}],["path",{d:"M2 12h19.6",key:"de5uta"}],["path",{d:"M18 18h3s.5-1.7.8-2.8c.1-.4.2-.8.2-1.2 0-.4-.1-.8-.2-1.2l-1.4-5C20.1 6.8 19.1 6 18 6H4a2 2 0 0 0-2 2v10h3",key:"1wwztk"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M9 18h5",key:"lrx6i"}],["circle",{cx:"16",cy:"18",r:"2",key:"1v4tcr"}]],ot=H("bus",st);const at=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],nt=H("eraser",at);const it=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M3 19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5a.5.5 0 0 0-.769-.422l-4.462 2.844A.5.5 0 0 1 15 10.5v-2a.5.5 0 0 0-.769-.422L9.77 10.922A.5.5 0 0 1 9 10.5V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z",key:"1iv0i2"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],ct=H("factory",it);const lt=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],dt=H("pencil",lt);const ut=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],ht=H("route",ut);const ft=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],pt=H("shopping-cart",ft);const xt=[["path",{d:"M10 10v.2A3 3 0 0 1 8.9 16H5a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z",key:"1l6gj6"}],["path",{d:"M7 16v6",key:"1a82de"}],["path",{d:"M13 19v3",key:"13sx9i"}],["path",{d:"M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .8-1.7L13 3l-1.4 1.5",key:"1sj9kv"}]],mt=H("trees",xt);const vt=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],gt=H("trending-up",vt);const yt=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],St=H("users",yt);const bt=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],jt=H("wallet",bt);var Mt=Object.defineProperty,wt=(r,s,a)=>s in r?Mt(r,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[s]=a,we=(r,s,a)=>(wt(r,typeof s!="symbol"?s+"":s,a),a);const Pt=(()=>{const r={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new D},up:{value:new D(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${Xe>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},s=new ve({name:"SkyShader",fragmentShader:r.fragmentShader,vertexShader:r.vertexShader,uniforms:Be.clone(r.uniforms),side:Ue,depthWrite:!1});class a extends Te{constructor(){super(new We(1,1,1),s)}}return we(a,"SkyShader",r),we(a,"material",s),a})(),Ct={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},Rt={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `};function ie(r,s){const a=r+"Geometry";return o.forwardRef(({args:l,children:n,...c},C)=>{const y=o.useRef(null);return o.useImperativeHandle(C,()=>y.current),o.useLayoutEffect(()=>{s?.(y.current)}),o.createElement("mesh",Se({ref:y},c),o.createElement(a,{attach:"geometry",args:l}),n)})}const S=ie("box"),pe=ie("cone"),Y=ie("cylinder"),Nt=ie("sphere"),Et=ie("plane"),Tt=o.forwardRef(({scale:r=10,frames:s=1/0,opacity:a=1,width:l=1,height:n=1,blur:c=1,near:C=0,far:y=10,resolution:m=512,smooth:d=!0,color:w="#000000",depthWrite:z=!1,renderOrder:T,..._},p)=>{const k=o.useRef(null),j=je(L=>L.scene),t=je(L=>L.gl),x=o.useRef(null);l=l*(Array.isArray(r)?r[0]:r||1),n=n*(Array.isArray(r)?r[1]:r||1);const[g,P,I,i,u,h,v]=o.useMemo(()=>{const L=new Me(m,m),B=new Me(m,m);B.texture.generateMipmaps=L.texture.generateMipmaps=!1;const q=new Ge(l,n).rotateX(Math.PI/2),he=new Te(q),Q=new Fe;Q.depthTest=Q.depthWrite=!1,Q.onBeforeCompile=b=>{b.uniforms={...b.uniforms,ucolor:{value:new ne(w)}},b.fragmentShader=b.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),b.fragmentShader=b.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const ce=new ve(Ct),le=new ve(Rt);return le.depthTest=ce.depthTest=!1,[L,q,Q,he,ce,le,B]},[m,l,n,r,w]),N=L=>{i.visible=!0,i.material=u,u.uniforms.tDiffuse.value=g.texture,u.uniforms.h.value=L*1/256,t.setRenderTarget(v),t.render(i,x.current),i.material=h,h.uniforms.tDiffuse.value=v.texture,h.uniforms.v.value=L*1/256,t.setRenderTarget(g),t.render(i,x.current),i.visible=!1};let A=0,E,F;return be(()=>{x.current&&(s===1/0||A<s)&&(A++,E=j.background,F=j.overrideMaterial,k.current.visible=!1,j.background=null,j.overrideMaterial=I,t.setRenderTarget(g),t.render(j,x.current),N(c),d&&N(c*.4),t.setRenderTarget(null),k.current.visible=!0,j.overrideMaterial=F,j.background=E)}),o.useImperativeHandle(p,()=>k.current,[]),o.createElement("group",Se({"rotation-x":Math.PI/2},_,{ref:k}),o.createElement("mesh",{renderOrder:T,geometry:P,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},o.createElement("meshBasicMaterial",{transparent:!0,map:g.texture,opacity:a,depthWrite:z})),o.createElement("orthographicCamera",{ref:x,args:[-l/2,l/2,n/2,-n/2,C,y]}))});function Dt(r,s,a=new D){const l=Math.PI*(r-.5),n=2*Math.PI*(s-.5);return a.x=Math.cos(n),a.y=Math.sin(l),a.z=Math.sin(n),a}const kt=o.forwardRef(({inclination:r=.6,azimuth:s=.1,distance:a=1e3,mieCoefficient:l=.005,mieDirectionalG:n=.8,rayleigh:c=.5,turbidity:C=10,sunPosition:y=Dt(r,s),...m},d)=>{const w=o.useMemo(()=>new D().setScalar(a),[a]),[z]=o.useState(()=>new Pt);return o.createElement("primitive",Se({object:z,ref:d,"material-uniforms-mieCoefficient-value":l,"material-uniforms-mieDirectionalG-value":n,"material-uniforms-rayleigh-value":c,"material-uniforms-sunPosition-value":y,"material-uniforms-turbidity-value":C,scale:w},m))});var f=(r=>(r.EMPTY="EMPTY",r.ROAD="ROAD",r.RESIDENTIAL="RESIDENTIAL",r.COMMERCIAL="COMMERCIAL",r.INDUSTRIAL="INDUSTRIAL",r.PARK="PARK",r.BUS_STOP="BUS_STOP",r))(f||{});const R=16,Pe=1,ye={[f.EMPTY]:{type:f.EMPTY,cost:0,color:"#2d3748",label:"Bulldoze",icon:nt,description:"Clear the land for new developments."},[f.ROAD]:{type:f.ROAD,cost:10,color:"#4a5568",label:"Road",icon:ht,description:"Connect your city. Essential for cars and growth."},[f.RESIDENTIAL]:{type:f.RESIDENTIAL,cost:50,color:"#48bb78",label:"Residential",icon:ze,description:"Where your citizens live. Provides population."},[f.COMMERCIAL]:{type:f.COMMERCIAL,cost:80,color:"#4299e1",label:"Commercial",icon:pt,description:"Stores and offices. Boosts city income and happiness."},[f.INDUSTRIAL]:{type:f.INDUSTRIAL,cost:120,color:"#ecc94b",label:"Industrial",icon:ct,description:"Factories and production. High income but low happiness."},[f.PARK]:{type:f.PARK,cost:200,color:"#38b2ac",label:"Park",icon:mt,description:"Green spaces for relaxation. Greatly improves happiness."},[f.BUS_STOP]:{type:f.BUS_STOP,cost:150,color:"#f6ad55",label:"Bus Stop",icon:ot,description:"Define routes. Buses stop at nearby roads to pick up citizens."}},At={money:5e3,population:0,happiness:80,income:0,expense:0},It="neo-city-db",Z="saves",re="current-save",zt=1;class _t{db=null;dbReady;constructor(){this.dbReady=this.initDB()}initDB(){return new Promise((s,a)=>{if(typeof window>"u"||!window.indexedDB){s();return}const l=indexedDB.open(It,1);l.onerror=()=>{console.error("Failed to open IndexedDB:",l.error),a(l.error)},l.onsuccess=()=>{this.db=l.result,s()},l.onupgradeneeded=n=>{const c=n.target.result;c.objectStoreNames.contains(Z)||c.createObjectStore(Z)}})}async save(s,a,l,n,c){await this.dbReady;const C={cityData:s,stats:a,cityName:l,gameTime:n,feedMessages:c,savedAt:Date.now(),version:zt};return this.db?new Promise(y=>{const w=this.db.transaction([Z],"readwrite").objectStore(Z).put(C,re);w.onsuccess=()=>y(!0),w.onerror=()=>{console.error("IndexedDB save failed, trying localStorage"),y(this.saveToLocalStorage(C))}}):this.saveToLocalStorage(C)}saveToLocalStorage(s){try{return _e(re,s),!0}catch(a){return console.error("localStorage save failed:",a),!1}}async load(){if(await this.dbReady,this.db){const s=await new Promise(a=>{const c=this.db.transaction([Z],"readonly").objectStore(Z).get(re);c.onsuccess=()=>a(c.result||null),c.onerror=()=>{console.error("IndexedDB load failed, trying localStorage"),a(null)}});if(s)return s}return this.loadFromLocalStorage()}loadFromLocalStorage(){try{const s=Le(re,!0);if(s)return s}catch(s){console.error("localStorage load failed:",s)}return null}async deleteSave(){if(await this.dbReady,this.db)return new Promise(s=>{const n=this.db.transaction([Z],"readwrite").objectStore(Z).delete(re);n.onsuccess=()=>s(!0),n.onerror=()=>s(!1)});try{return Oe(re),!0}catch{return!1}}async hasSave(){return await this.load()!==null}}const xe=new _t,Lt=({type:r,variant:s=0,position:a,isSelected:l,connections:n})=>{const c=o.useRef(null);be(y=>{c.current&&l?c.current.position.y=Math.sin(y.clock.elapsedTime*4)*.1+.1:c.current&&(c.current.position.y=ge.lerp(c.current.position.y,0,.1))});const C=o.useMemo(()=>{const y=l?"#ffffff":"#000000",m=l?.5:0,d="#fbbf24",w="#ffffff",z="#1a1a1a",T="#a0aec0",_="#2d3748";switch(r){case f.ROAD:{const{n:p=!1,s:k=!1,e:j=!1,w:t=!1}=n||{},x=[p,k,j,t].filter(Boolean).length,g=p&&k&&!j&&!t,P=j&&t&&!p&&!k,I=x>2,i=({type:v="double",rotation:N=0,length:A=.5,position:E=[0,.081,0]})=>v==="double"?e.jsxs("group",{rotation:[0,N,0],position:E,children:[e.jsx(S,{args:[.02,.005,A],children:e.jsx("meshStandardMaterial",{color:d})}),e.jsx(S,{args:[.02,.005,A],position:[.04,0,0],children:e.jsx("meshStandardMaterial",{color:d})})]}):v==="dashed"?e.jsxs("group",{rotation:[0,N,0],position:E,children:[e.jsx(S,{args:[.02,.005,A*.3],position:[.02,0,A*.3],children:e.jsx("meshStandardMaterial",{color:d})}),e.jsx(S,{args:[.02,.005,A*.3],position:[.02,0,-A*.3],children:e.jsx("meshStandardMaterial",{color:d})})]}):e.jsx(S,{args:[.03,.005,A],rotation:[0,N,0],position:E,children:e.jsx("meshStandardMaterial",{color:d})}),u=({rotation:v=0,position:N=[0,.083,0]})=>e.jsx("group",{rotation:[0,v,0],position:N,children:[-.24,-.12,0,.12,.24].map((A,E)=>e.jsx(S,{args:[.08,.004,.22],position:[A,0,0],children:e.jsx("meshStandardMaterial",{color:w,roughness:.4})},E))}),h=({rotation:v=0,position:N=[0,0,0],args:A=[1,.03,.04]})=>e.jsx(S,{args:A,rotation:[0,v,0],position:N,children:e.jsx("meshStandardMaterial",{color:_,roughness:.7})});return e.jsxs("group",{children:[e.jsx(S,{args:[1,.08,1],position:[0,.04,0],children:e.jsx("meshStandardMaterial",{color:z,emissive:y,emissiveIntensity:m,roughness:.9})}),e.jsx(S,{args:[.1,.022,1],position:[-.45,.08,0],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:T})}),e.jsx(S,{args:[.1,.022,1],position:[.45,.08,0],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:T})}),e.jsx(S,{args:[1,.022,.1],position:[0,.08,-.45],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:T})}),e.jsx(S,{args:[1,.022,.1],position:[0,.08,.45],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:T})}),p&&(!g||I)&&e.jsx(u,{position:[0,.083,-.36]}),k&&(!g||I)&&e.jsx(u,{position:[0,.083,.36]}),t&&(!P||I)&&e.jsx(u,{rotation:Math.PI/2,position:[-.36,.083,0]}),j&&(!P||I)&&e.jsx(u,{rotation:Math.PI/2,position:[.36,.083,0]}),e.jsxs("group",{position:[-.01,0,0],children:[p&&e.jsx(i,{type:g?"dashed":"double",length:.4,position:[0,.081,-.25]}),k&&e.jsx(i,{type:g?"dashed":"double",length:.4,position:[0,.081,.25]}),t&&e.jsx(i,{type:P?"dashed":"double",rotation:Math.PI/2,length:.4,position:[-.25,.081,0]}),j&&e.jsx(i,{type:P?"dashed":"double",rotation:Math.PI/2,length:.4,position:[.25,.081,0]})]}),!p&&e.jsx(h,{position:[0,.09,-.48],args:[1,.04,.04]}),!k&&e.jsx(h,{position:[0,.09,.48],args:[1,.04,.04]}),!j&&e.jsx(h,{position:[.48,.09,0],args:[.04,.04,1]}),!t&&e.jsx(h,{position:[-.48,.09,0],args:[.04,.04,1]})]})}case f.RESIDENTIAL:{const p="#48bb78";return s===1?e.jsxs("group",{children:[e.jsx(S,{args:[.4,.7,.6],position:[-.15,.35,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(S,{args:[.4,.4,.6],position:[.15,.2,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#c6f6d5"})}),e.jsx(S,{args:[.8,.05,.7],position:[0,.7,0],children:e.jsx("meshStandardMaterial",{color:"#2d3748"})})]}):s===2?e.jsxs("group",{children:[e.jsx(S,{args:[.8,.35,.4],position:[0,.175,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(S,{args:[.9,.1,.5],position:[0,.35,0],rotation:[.05,0,0],children:e.jsx("meshStandardMaterial",{color:"#22543d"})})]}):e.jsxs("group",{children:[e.jsx(S,{args:[.6,.5,.6],position:[0,.25,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(pe,{args:[.5,.4,4],position:[0,.7,0],rotation:[0,Math.PI/4,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#276749"})})]})}case f.COMMERCIAL:{const p="#4299e1";return s===1?e.jsxs("group",{children:[e.jsx(S,{args:[.6,1.2,.6],position:[0,.6,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m,transparent:!0,opacity:.9,metalness:1,roughness:0})}),e.jsx(S,{args:[.65,.05,.65],position:[0,1.2,0],children:e.jsx("meshStandardMaterial",{color:"#2b6cb0"})})]}):s===2?e.jsxs("group",{children:[e.jsx(S,{args:[.8,.4,.8],position:[0,.2,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(S,{args:[.2,.5,.1],position:[.2,.45,.35],children:e.jsx("meshStandardMaterial",{color:"#f6e05e",emissive:"#f6e05e",emissiveIntensity:.5})}),e.jsx(S,{args:[.9,.05,.9],position:[0,.4,0],children:e.jsx("meshStandardMaterial",{color:"#2c5282"})})]}):e.jsxs("group",{children:[e.jsx(S,{args:[.7,.8,.7],position:[0,.4,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(S,{args:[.75,.1,.75],position:[0,.85,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#2b6cb0"})})]})}case f.INDUSTRIAL:{const p="#ecc94b";return s===1?e.jsxs("group",{children:[e.jsx(Y,{args:[.2,.2,.5,12],position:[-.2,.25,-.2],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#cbd5e0",emissive:y,emissiveIntensity:m})}),e.jsx(Y,{args:[.2,.2,.5,12],position:[.2,.25,.2],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#cbd5e0"})}),e.jsx(S,{args:[.8,.1,.8],position:[0,.05,0],children:e.jsx("meshStandardMaterial",{color:"#4a5568"})})]}):s===2?e.jsxs("group",{children:[e.jsx(S,{args:[.7,.4,.7],position:[0,.2,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(Y,{args:[.05,.05,.8,6],position:[.2,.4,.2],children:e.jsx("meshStandardMaterial",{color:"#744210"})}),e.jsx(Y,{args:[.05,.05,.8,6],position:[-.2,.4,.2],children:e.jsx("meshStandardMaterial",{color:"#744210"})}),e.jsx(Y,{args:[.05,.05,.8,6],position:[0,.4,-.2],children:e.jsx("meshStandardMaterial",{color:"#744210"})})]}):e.jsxs("group",{children:[e.jsx(S,{args:[.8,.6,.8],position:[0,.3,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(Y,{args:[.1,.1,1,8],position:[.2,.6,.2],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#744210"})})]})}case f.PARK:{const p="#38b2ac";return s===1?e.jsxs("group",{children:[e.jsx(S,{args:[.9,.1,.9],position:[0,.05,0],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(Y,{args:[.3,.3,.05,16],position:[0,.1,0],children:e.jsx("meshStandardMaterial",{color:"#63b3ed",metalness:1,roughness:0})}),e.jsx(Nt,{args:[.1,8,8],position:[0,.2,0],children:e.jsx("meshStandardMaterial",{color:"#ebf8ff",transparent:!0,opacity:.6})})]}):s===2?e.jsxs("group",{children:[e.jsx(S,{args:[.9,.1,.9],position:[0,.05,0],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(S,{args:[.2,.2,.2],position:[-.2,.2,.2],children:e.jsx("meshStandardMaterial",{color:"#f56565"})}),e.jsx(Y,{args:[.02,.2,.4,4],position:[.2,.2,-.2],rotation:[0,0,.5],children:e.jsx("meshStandardMaterial",{color:"#4299e1"})})]}):e.jsxs("group",{children:[e.jsx(S,{args:[.9,.1,.9],position:[0,.05,0],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:p,emissive:y,emissiveIntensity:m})}),e.jsx(pe,{args:[.2,.5,8],position:[0,.4,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#234e52"})}),e.jsx(pe,{args:[.15,.3,8],position:[.25,.25,.2],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#2d6a4f"})})]})}case f.BUS_STOP:return e.jsxs("group",{children:[e.jsx(S,{args:[.8,.05,.8],position:[0,.025,0],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#718096",emissive:y,emissiveIntensity:m})}),e.jsx(S,{args:[.6,.5,.05],position:[0,.25,-.3],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#4a5568",transparent:!0,opacity:.8})}),e.jsx(S,{args:[.7,.05,.4],position:[0,.5,-.15],rotation:[.1,0,0],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#2d3748"})}),e.jsx(S,{args:[.4,.1,.15],position:[0,.1,-.15],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#744210"})}),e.jsx(Y,{args:[.02,.02,.6,8],position:[.3,.3,.2],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#a0aec0"})}),e.jsx(S,{args:[.15,.1,.02],position:[.3,.55,.2],castShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#f6ad55"})})]});default:return null}},[r,s,l,n]);return e.jsx("group",{position:a,ref:c,children:C})},Ot=({cityData:r,onTileClick:s,selectedType:a,selectedBuilding:l})=>{const[n,c]=o.useState(null),C=d=>{d.stopPropagation();const w=Math.floor(d.point.x+R/2),z=Math.floor(d.point.z+R/2);w>=0&&w<R&&z>=0&&z<R?c({x:w,z}):c(null)},y=d=>{d.stopPropagation(),n&&s(n.x,n.z)},m=(d,w)=>r.some(z=>z.x===d&&z.z===w&&z.type===f.ROAD);return e.jsxs("group",{children:[e.jsxs("group",{position:[0,-.25,0],children:[e.jsx(S,{args:[R,.5,R],children:e.jsx("meshStandardMaterial",{color:"#38a169"})}),e.jsx(S,{args:[R,1.5,R],position:[0,-1,0],children:e.jsx("meshStandardMaterial",{color:"#4a3728"})})]}),e.jsx($e,{infiniteGrid:!1,args:[R,R],fadeDistance:30,sectionSize:Pe,sectionThickness:1.5,sectionColor:"#2d3748",cellSize:Pe,cellThickness:.5,cellColor:"#2d3748",position:[0,.01,0]}),e.jsx(Et,{args:[R,R],rotation:[-Math.PI/2,0,0],position:[0,.02,0],onPointerMove:C,onPointerOut:()=>c(null),onClick:y,receiveShadow:!0,children:e.jsx("meshStandardMaterial",{transparent:!0,opacity:0})}),r.map(d=>{if(d.type===f.EMPTY)return null;const w=d.type===f.ROAD?{n:m(d.x,d.z-1),s:m(d.x,d.z+1),e:m(d.x+1,d.z),w:m(d.x-1,d.z)}:void 0;return e.jsx(Lt,{type:d.type,variant:d.level,isSelected:l?.x===d.x&&l?.z===d.z,position:[d.x-R/2+.5,0,d.z-R/2+.5],connections:w},`${d.x}-${d.z}`)}),n&&e.jsxs("mesh",{position:[n.x-R/2+.5,.03,n.z-R/2+.5],rotation:[-Math.PI/2,0,0],children:[e.jsx("planeGeometry",{args:[.95,.95]}),e.jsx("meshStandardMaterial",{color:a===f.EMPTY?"#f56565":"#ffffff",transparent:!0,opacity:.3})]})]})},Ut=({stats:r,cityName:s,onRenameCity:a,selectedType:l,onSelectType:n,selectedBuildingInfo:c,onDeselect:C,isFeedVisible:y,onToggleFeed:m,saveSettings:d,onSave:w,onToggleAutoSave:z})=>{const[T,_]=o.useState(!1),[p,k]=o.useState(s),j=o.useRef(null),t=c?c.type:l,x=t!==f.EMPTY?ye[t]:null;o.useEffect(()=>{T&&j.current&&(j.current.focus(),j.current.select())},[T]);const g=P=>{P?.preventDefault();const I=p.trim()||s;a(I),k(I),_(!1)};return e.jsxs("div",{className:"absolute inset-0 pointer-events-none flex flex-col justify-between p-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 items-start w-full relative",children:[e.jsx("div",{className:"pointer-events-auto group",children:T?e.jsx("form",{onSubmit:g,className:"flex items-center",children:e.jsx("input",{ref:j,type:"text",value:p,onChange:P=>k(P.target.value),onBlur:()=>g(),className:"bg-gray-800/80 backdrop-blur-md border-2 border-blue-500 rounded-lg px-4 py-1 text-2xl font-black text-white shadow-[0_0_15px_rgba(59,130,246,0.5)] focus:outline-none tracking-tight",maxLength:24})}):e.jsxs("div",{onClick:()=>_(!0),className:"flex items-center space-x-3 cursor-pointer hover:translate-x-1 transition-transform duration-200",children:[e.jsx("h1",{className:"text-3xl font-black italic tracking-tighter drop-shadow-[0_2px_4px_rgba(0,0,0,0.8)] text-white bg-linear-to-br from-white to-gray-400 bg-clip-text",children:s}),e.jsx(dt,{className:"w-3 h-3 text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),e.jsx("div",{className:"flex justify-start items-start pointer-events-auto w-full",children:e.jsxs("div",{className:"bg-gray-900/80 backdrop-blur-md border border-gray-700 p-4 rounded-xl shadow-2xl flex space-x-8",children:[e.jsx(ue,{icon:jt,label:"Budget",value:`$${r.money.toLocaleString()}`,color:"text-yellow-400"}),e.jsx(ue,{icon:St,label:"Population",value:r.population.toLocaleString(),color:"text-green-400"}),e.jsx(ue,{icon:He,label:"Happiness",value:`${r.happiness}%`,color:"text-blue-400"}),e.jsx(ue,{icon:gt,label:"Cashflow",value:`$${r.income-r.expense}/m`,color:r.income-r.expense>=0?"text-green-400":"text-red-400"})]})}),e.jsxs("div",{className:"flex items-center space-x-3 pointer-events-auto",children:[e.jsxs("button",{onClick:w,className:"bg-blue-600/80 hover:bg-blue-500 backdrop-blur-md text-white px-4 py-2 rounded-lg border border-blue-400/50 transition-all flex items-center space-x-2 text-sm font-bold shadow-lg shadow-blue-900/20",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsx("span",{children:"Save City"})]}),e.jsxs("button",{onClick:z,className:`backdrop-blur-md px-4 py-2 rounded-lg border transition-all flex items-center space-x-2 text-sm font-bold shadow-lg ${d.autoSaveEnabled?"bg-green-600/80 border-green-400/50 text-white shadow-green-900/20":"bg-gray-700/80 border-gray-500/50 text-gray-300 shadow-black/20"}`,children:[e.jsx(Ke,{className:`w-4 h-4 ${d.autoSaveEnabled?"animate-spin":""}`}),e.jsxs("span",{children:["Auto-save: ",d.autoSaveEnabled?"ON":"OFF"]})]}),d.lastSavedAt&&e.jsxs("span",{className:"text-[10px] text-gray-400 font-mono uppercase tracking-tighter",children:["Last Sync: ",new Date(d.lastSavedAt).toLocaleTimeString()]})]})]}),x&&e.jsxs("div",{className:"absolute top-1/2 left-6 -translate-y-1/2 w-72 bg-gray-900/95 backdrop-blur-xl border border-blue-500/30 rounded-2xl shadow-2xl p-6 pointer-events-auto animate-in slide-in-from-left duration-300",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-gray-800",children:e.jsx(x.icon,{className:"w-6 h-6",style:{color:x.color}})}),c&&e.jsx("button",{onClick:C,className:"text-gray-500 hover:text-white transition-colors",children:e.jsx(qe,{className:"w-5 h-5"})})]}),e.jsx("h3",{className:"text-xl font-bold mb-1",children:x.label}),e.jsx("p",{className:"text-xs text-gray-500 mb-4 uppercase tracking-widest",children:c?"Building Inspector":"Construction Tool"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-300 leading-relaxed italic",children:['"',x.description,'"']}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 border-t border-gray-800 pt-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold",children:"Cost"}),e.jsxs("p",{className:`text-sm ${r.money>=x.cost?"text-green-400":"text-red-400"}`,children:["$",x.cost.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold",children:"Status"}),e.jsx("p",{className:"text-sm text-green-400",children:c?"Operational":"Ready"})]}),c&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold",children:"Coordinates"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["X: ",c.x,", Z: ",c.z]})]})]})]})]}),e.jsx("div",{className:"flex justify-start pointer-events-auto",children:e.jsx("div",{className:"bg-gray-900/90 backdrop-blur-md border border-gray-700 p-2 rounded-2xl shadow-2xl flex space-x-2",children:Object.values(ye).map(P=>e.jsxs("button",{onClick:()=>n(P.type),className:`flex flex-col items-center justify-center w-20 h-20 rounded-xl transition-all ${l===P.type?"bg-blue-600 ring-2 ring-white scale-105":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx(P.icon,{className:"w-6 h-6 mb-1"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-tighter",children:P.label}),e.jsxs("span",{className:"text-[10px] opacity-70",children:["$",P.cost]})]},P.type))})})]})},ue=({icon:r,label:s,value:a,color:l})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-400 tracking-widest",children:s}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(r,{className:`w-4 h-4 ${l}`}),e.jsx("span",{className:"text-xl font-bold tabular-nums",children:a})]})]}),K=[.14,.32],Bt=.42,Wt=.85,me=1.6,J=24,se=40,oe=6,Gt=3,Ft=2,Vt=2.5,W=new De,M=new De,ae=new ne,$t=new Ve().makeScale(0,0,0),Ce=["#f56565","#4299e1","#f6e05e","#ffffff","#2d3748","#38b2ac","#9f7aea"],Re=["#f6ad55","#4fd1c5","#6366f1"],Ne=["#8d5524","#c68642","#e0ac69","#f1c27d","#ffdbac"],Ee=["#2563eb","#dc2626","#16a34a","#d97706","#7c3aed","#db2777","#4b5563","#1e293b","#f97316","#06b6d4","#84cc16","#6366f1"],Ht=({cityData:r})=>{const s=o.useRef(null),a=o.useRef(null),l=o.useRef(null),n=o.useRef(null),c=o.useRef(null),C=o.useRef(null),y=o.useRef(null),m=o.useRef(null),d=o.useRef(null),w=o.useRef([]);o.useEffect(()=>{const T=r.filter(i=>i.type===f.ROAD),_=r.filter(i=>i.type===f.BUS_STOP),p=r.filter(i=>i.type!==f.EMPTY&&i.type!==f.ROAD),k=w.current.filter(i=>i.type==="car"),j=w.current.filter(i=>i.type==="person"),t=w.current.filter(i=>i.type==="bus");let x=[...w.current];x=x.filter(i=>{const u=Math.floor(i.targetPos.x+R/2),h=Math.floor(i.targetPos.z+R/2),v=r.find(N=>N.x===u&&N.z===h);return i.type==="car"||i.type==="bus"?v&&v.type===f.ROAD:v&&v.type!==f.EMPTY});const g=Math.min(J,T.length)-k.length;if(g>0)for(let i=0;i<g;i++){const u=T[Math.floor(Math.random()*T.length)],h=new D(u.x-R/2+.5,.08,u.z-R/2+.5),v=Math.floor(Math.random()*K.length);x.push({id:Math.random(),type:"car",prevPos:h.clone(),currentPos:h.clone(),targetPos:h.clone(),actualWorldPos:h.clone(),progress:1,baseSpeed:.5+Math.random()*.4,currentSpeed:.5,color:Ce[Math.floor(Math.random()*Ce.length)],waitTimer:0,lastDirection:new D(0,0,1),targetRotation:new te,currentRotation:new te,laneIndex:v,visualLaneOffset:K[v],laneChangeTimer:0,preferredSide:0,isStoppedAtStation:!1})}const P=Math.min(oe,_.length*2)-t.length;if(P>0&&T.length>0)for(let i=0;i<P;i++){const u=T[Math.floor(Math.random()*T.length)],h=new D(u.x-R/2+.5,.12,u.z-R/2+.5);x.push({id:Math.random(),type:"bus",prevPos:h.clone(),currentPos:h.clone(),targetPos:h.clone(),actualWorldPos:h.clone(),progress:1,baseSpeed:.35,currentSpeed:.35,color:Re[Math.floor(Math.random()*Re.length)],waitTimer:0,lastDirection:new D(0,0,1),targetRotation:new te,currentRotation:new te,laneIndex:1,visualLaneOffset:K[1],laneChangeTimer:0,preferredSide:0,isStoppedAtStation:!1})}const I=Math.min(se,p.length)-j.length;if(I>0)for(let i=0;i<I;i++){const u=p[Math.floor(Math.random()*p.length)],h=new D(u.x-R/2+.5,.05,u.z-R/2+.5);x.push({id:Math.random(),type:"person",prevPos:h.clone(),currentPos:h.clone(),targetPos:h.clone(),actualWorldPos:h.clone(),progress:1,baseSpeed:.12+Math.random()*.1,currentSpeed:.12,color:Ee[Math.floor(Math.random()*Ee.length)],headColor:Ne[Math.floor(Math.random()*Ne.length)],scale:.85+Math.random()*.3,waitTimer:0,lastDirection:new D(0,0,1),targetRotation:new te,currentRotation:new te,laneIndex:0,visualLaneOffset:0,laneChangeTimer:0,preferredSide:Math.random()>.5?1:-1,isStoppedAtStation:!1})}if(w.current=x,s.current){const i=x.filter(u=>u.type==="car");for(let u=0;u<J;u++)u<i.length&&(s.current.setColorAt(u,ae.set(i[u].color)),a.current?.setColorAt(u,ae.set(i[u].color)));s.current.instanceColor&&(s.current.instanceColor.needsUpdate=!0),a.current?.instanceColor&&(a.current.instanceColor.needsUpdate=!0)}if(C.current){const i=x.filter(u=>u.type==="bus");for(let u=0;u<oe;u++)u<i.length&&C.current.setColorAt(u,ae.set(i[u].color));C.current.instanceColor&&(C.current.instanceColor.needsUpdate=!0)}if(m.current){const i=x.filter(u=>u.type==="person");for(let u=0;u<se;u++)u<i.length&&(m.current.setColorAt(u,ae.set(i[u].color)),d.current?.setColorAt(u,ae.set(i[u].headColor)));m.current.instanceColor&&(m.current.instanceColor.needsUpdate=!0),d.current?.instanceColor&&(d.current.instanceColor.needsUpdate=!0)}},[r]);const z=(T,_,p,k,j)=>{const x=[{x:T+1,z:_},{x:T-1,z:_},{x:T,z:_+1},{x:T,z:_-1}].map(g=>{const P=r.find(i=>i.x===g.x&&i.z===g.z);if(!P)return{...g,score:-1/0};if((j==="car"||j==="bus")&&P.type!==f.ROAD)return{...g,score:-1/0};if(j==="person"&&P.type===f.EMPTY)return{...g,score:-1/0};let I=100;return g.x===p&&g.z===k&&(I-=195),I+=Math.random()*20,{...g,score:I}}).filter(g=>g.score!==-1/0);return x.length>0?(x.sort((g,P)=>P.score-g.score),x[0]):null};return be((T,_)=>{[s,a,l,n,c,C,y,m,d].forEach(t=>{if(t.current)for(let x=0;x<(t.current.count||0);x++)t.current.setMatrixAt(x,$t)});let p=0,k=0,j=0;w.current.forEach(t=>{const x=t.type==="car",g=t.type==="bus",P=t.type==="person";if((x||g)&&t.currentSpeed<.05){if(t.waitTimer+=_,t.waitTimer>Gt){const h=t.currentPos.clone();t.currentPos.copy(t.targetPos),t.targetPos.copy(h),t.progress=1-t.progress,t.waitTimer=0}}else t.waitTimer=0;if(t.progress>=1){const h=Math.floor(t.targetPos.x+R/2),v=Math.floor(t.targetPos.z+R/2);if(g&&!t.isStoppedAtStation&&[{x:h+1,z:v},{x:h-1,z:v},{x:h,z:v+1},{x:h,z:v-1}].some(L=>r.find(B=>B.x===L.x&&B.z===L.z)?.type===f.BUS_STOP)&&(t.isStoppedAtStation=!0,t.waitTimer=Vt),g&&t.isStoppedAtStation)if(t.waitTimer-=_,t.waitTimer<=0)t.isStoppedAtStation=!1;else return;const N=Math.floor(t.prevPos.x+R/2),A=Math.floor(t.prevPos.z+R/2),E=z(h,v,N,A,t.type);if(E){t.prevPos.copy(t.currentPos),t.currentPos.copy(t.targetPos);const F=r.find(B=>B.x===E.x&&B.z===E.z),L=new D(E.x-R/2+.5,g?.12:x?.08:.05,E.z-R/2+.5);if(x||g){const B=new D().subVectors(L,t.currentPos).normalize(),q=new D(-B.z,0,B.x).multiplyScalar(K[t.laneIndex]);t.targetPos.copy(L.add(q))}else if(F?.type===f.ROAD){const B=new D().subVectors(L,t.currentPos).normalize(),q=new D(-B.z,0,B.x).multiplyScalar(Bt*t.preferredSide);t.targetPos.copy(L.add(q))}else{const B=new D((Math.random()-.5)*.45,0,(Math.random()-.5)*.45);t.targetPos.copy(L.add(B))}t.progress=0}else if(x||g){const F=t.currentPos.clone();t.currentPos.copy(t.targetPos),t.targetPos.copy(F),t.progress=0}}let I=t.baseSpeed;if(x||g){t.laneChangeTimer=Math.max(0,t.laneChangeTimer-_);const h=new D().subVectors(t.targetPos,t.currentPos).normalize();let v=!1;for(const N of w.current)if((N.type==="car"||N.type==="bus")&&N.id!==t.id){const A=t.actualWorldPos.distanceTo(N.actualWorldPos);if(A<me){const E=new D().subVectors(N.actualWorldPos,t.actualWorldPos).normalize();h.dot(E)>.6&&t.laneIndex===N.laneIndex&&(I=A<(g?1.2:Wt)?0:t.baseSpeed*.4,x&&A<me*.8&&N.currentSpeed<t.baseSpeed*.6&&(v=!0))}}if(x&&v&&t.laneChangeTimer<=0){const N=(t.laneIndex+1)%K.length;let A=!0;for(const E of w.current)if((E.type==="car"||E.type==="bus")&&E.id!==t.id&&E.laneIndex===N&&t.actualWorldPos.distanceTo(E.actualWorldPos)<me){A=!1;break}if(A){t.laneIndex=N,t.laneChangeTimer=Ft;const E=new D().subVectors(t.targetPos,t.currentPos).normalize(),F=t.targetPos.clone().sub(new D(-E.z,0,E.x).multiplyScalar(K[1-N]));t.targetPos.copy(F.add(new D(-E.z,0,E.x).multiplyScalar(K[N])))}}t.visualLaneOffset=ge.lerp(t.visualLaneOffset,K[t.laneIndex],.05)}else for(const h of w.current)h.type==="person"&&h.id!==t.id&&t.actualWorldPos.distanceTo(h.actualWorldPos)<.2&&(I*=.5);t.currentSpeed=ge.lerp(t.currentSpeed,I,.1),t.progress=Math.min(1,t.progress+_*t.currentSpeed);const i=new D().lerpVectors(t.currentPos,t.targetPos,t.progress);if(x||g){const h=new D().subVectors(t.targetPos,t.currentPos).normalize(),v=new D(-h.z,0,h.x).multiplyScalar(t.visualLaneOffset-K[t.laneIndex]);t.actualWorldPos.copy(i.add(v))}else t.actualWorldPos.copy(i);W.position.copy(t.actualWorldPos);const u=new D().subVectors(t.targetPos,t.currentPos).normalize();if(u.lengthSq()>.001&&(W.lookAt(t.actualWorldPos.clone().add(u)),t.targetRotation.copy(W.quaternion),t.lastDirection.copy(u)),t.currentRotation.slerp(t.targetRotation,P?.3:.12),W.quaternion.copy(t.currentRotation),x&&p<J){W.updateMatrix(),s.current?.setMatrixAt(p,W.matrix),M.copy(W),M.position.y+=.07,M.position.add(t.lastDirection.clone().multiplyScalar(-.04)),M.scale.set(.8,.7,.5),M.updateMatrix(),a.current?.setMatrixAt(p,M.matrix),M.scale.set(.85,.75,.55),M.updateMatrix(),l.current?.setMatrixAt(p,M.matrix);const h=new D(-t.lastDirection.z,0,t.lastDirection.x).normalize();M.copy(W),M.position.add(t.lastDirection.clone().multiplyScalar(.201)).add(h.clone().multiplyScalar(.06)),M.scale.set(1,1,1),M.updateMatrix(),n.current?.setMatrixAt(p*2,M.matrix),M.position.add(h.clone().multiplyScalar(-.12)),M.updateMatrix(),n.current?.setMatrixAt(p*2+1,M.matrix),M.copy(W),M.position.add(t.lastDirection.clone().multiplyScalar(-.201)).add(h.clone().multiplyScalar(.06)),M.updateMatrix(),c.current?.setMatrixAt(p*2,M.matrix),M.position.add(h.clone().multiplyScalar(-.12)),M.updateMatrix(),c.current?.setMatrixAt(p*2+1,M.matrix),p++}else if(g&&k<oe)W.updateMatrix(),C.current?.setMatrixAt(k,W.matrix),M.copy(W),M.position.y+=.08,M.scale.set(.9,.6,.85),M.updateMatrix(),y.current?.setMatrixAt(k,M.matrix),k++;else if(P&&j<se){const h=Math.abs(Math.sin(T.clock.elapsedTime*10+t.id))*.03,v=t.scale||1;W.scale.set(v,v,v),W.position.y=t.actualWorldPos.y+h+.05*v,W.updateMatrix(),m.current?.setMatrixAt(j,W.matrix),M.copy(W),M.position.y+=.09*v,M.scale.set(v*.8,v*.8,v*.8),M.updateMatrix(),d.current?.setMatrixAt(j,M.matrix),j++}}),[s,a,l,n,c,C,y,m,d].forEach(t=>{t.current&&(t.current.instanceMatrix.needsUpdate=!0)})}),e.jsxs("group",{children:[e.jsxs("instancedMesh",{ref:s,args:[void 0,void 0,J],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.2,.1,.4]}),e.jsx("meshStandardMaterial",{roughness:.3,metalness:.7})]}),e.jsxs("instancedMesh",{ref:a,args:[void 0,void 0,J],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.2,.1,.4]}),e.jsx("meshStandardMaterial",{roughness:.3,metalness:.7})]}),e.jsxs("instancedMesh",{ref:l,args:[void 0,void 0,J],children:[e.jsx("boxGeometry",{args:[.2,.1,.4]}),e.jsx("meshStandardMaterial",{color:"#050505",roughness:0,metalness:1})]}),e.jsxs("instancedMesh",{ref:n,args:[void 0,void 0,J*2],children:[e.jsx("boxGeometry",{args:[.05,.03,.01]}),e.jsx("meshStandardMaterial",{color:"#ffffff",emissive:"#ffffff",emissiveIntensity:3})]}),e.jsxs("instancedMesh",{ref:c,args:[void 0,void 0,J*2],children:[e.jsx("boxGeometry",{args:[.05,.03,.01]}),e.jsx("meshStandardMaterial",{color:"#ff0000",emissive:"#ff0000",emissiveIntensity:3})]}),e.jsxs("instancedMesh",{ref:C,args:[void 0,void 0,oe],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.35,.25,.8]}),e.jsx("meshStandardMaterial",{roughness:.4,metalness:.3})]}),e.jsxs("instancedMesh",{ref:y,args:[void 0,void 0,oe],children:[e.jsx("boxGeometry",{args:[.35,.25,.8]}),e.jsx("meshStandardMaterial",{color:"#0a0a0a",roughness:0,metalness:1})]}),e.jsxs("instancedMesh",{ref:m,args:[void 0,void 0,se],castShadow:!0,children:[e.jsx("capsuleGeometry",{args:[.04,.08,4,8]}),e.jsx("meshStandardMaterial",{roughness:.8})]}),e.jsxs("instancedMesh",{ref:d,args:[void 0,void 0,se],castShadow:!0,children:[e.jsx("sphereGeometry",{args:[.035,8,8]}),e.jsx("meshStandardMaterial",{roughness:.6})]})]})},Yt=({gameTime:r})=>{const s=(r-6)/24*Math.PI*2,a=25,l=o.useMemo(()=>new D(Math.cos(s)*a,Math.sin(s)*a,8),[s]),n=r<5.5||r>19.5,c=r>=5.5&&r<=7||r>=18&&r<=19.5,C=o.useMemo(()=>n?new ne("#3b82f6"):c?new ne("#ffaa44"):new ne("#ffffff"),[n,c]),y=o.useMemo(()=>n?.2:c?.8:1.2,[n,c]);return e.jsxs("group",{children:[e.jsx(kt,{sunPosition:l,turbidity:n?.1:.5,rayleigh:n?.1:2}),e.jsx("directionalLight",{position:l,intensity:y,color:C,castShadow:!0,"shadow-bias":-5e-4,"shadow-mapSize":[2048,2048]}),e.jsx("ambientLight",{intensity:n?.1:.4,color:n?"#1e3a8a":"#ffffff"})]})},Kt=({messages:r,isVisible:s,onClear:a})=>{const[l,n]=o.useState(!1);return s?e.jsxs("div",{className:"fixed bottom-6 right-6 w-70 z-50 flex flex-col pointer-events-auto",children:[e.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-xl border border-slate-700/50 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-700/50 bg-slate-800/30",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-400",children:"City Feed"})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:a,className:"text-slate-500 hover:text-red-400 transition-colors",title:"Clear all logs",children:e.jsx(Je,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>n(!l),className:"text-slate-500 hover:text-white transition-colors",children:l?e.jsx(Qe,{className:"w-3 h-3"}):e.jsx(et,{className:"w-3 h-3"})}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)] animate-pulse"})]})]}),!l&&e.jsx("div",{className:"h-64 overflow-y-auto p-4 space-y-3 custom-scrollbar",children:r.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-slate-600 italic text-xs font-mono",children:"Waiting for citizen feedback..."}):r.map(c=>e.jsx("div",{className:"relative group animate-in fade-in slide-in-from-bottom-2 duration-300",children:e.jsxs("div",{className:"bg-slate-800/40 border-l-2 border-green-500/80 p-3 pl-4 rounded-r-lg hover:bg-slate-800/60 transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsxs("span",{className:"text-[10px] font-bold text-slate-500 font-mono tracking-tight",children:["@",c.user]}),e.jsx("span",{className:"text-[9px] text-slate-600 font-mono uppercase",children:c.timestamp})]}),e.jsx("p",{className:"text-xs text-slate-200 font-mono leading-relaxed pr-8",children:c.content})]})},c.id))})]}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .custom-scrollbar::-webkit-scrollbar {
          width: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: rgba(71, 85, 105, 0.5);
          border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: rgba(100, 116, 139, 0.8);
        }
      `}})]}):null},qt=({onStart:r,hasSavedGame:s})=>e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-50 text-white font-sans p-6 bg-black/30 backdrop-blur-sm transition-all duration-1000",children:e.jsxs("div",{className:"max-w-md w-full bg-slate-900/90 p-8 rounded-2xl border border-slate-700 shadow-2xl backdrop-blur-xl relative overflow-hidden animate-fade-in",children:[e.jsx("div",{className:"absolute -top-24 -right-24 w-48 h-48 bg-cyan-500/20 rounded-full blur-3xl pointer-events-none"}),e.jsx("div",{className:"absolute -bottom-24 -left-24 w-48 h-48 bg-indigo-500/20 rounded-full blur-3xl pointer-events-none"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h1",{className:"text-5xl font-black mb-2 bg-linear-to-br from-white via-cyan-200 to-blue-400 bg-clip-text text-transparent tracking-tight",children:"Neo City"}),e.jsx("p",{className:"text-slate-400 mb-8 text-sm font-medium uppercase tracking-widest",children:"Cyberpunk City Simulation"}),e.jsxs("div",{className:"space-y-3",children:[s&&e.jsxs("button",{onClick:()=>r(!0),className:"w-full py-4 bg-linear-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white font-bold rounded-xl shadow-lg shadow-green-900/20 transform transition-all hover:scale-[1.02] active:scale-[0.98] text-lg tracking-wide flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Continue"]}),e.jsx("button",{onClick:()=>r(!1),className:`w-full py-4 text-white font-bold rounded-xl shadow-lg transform transition-all hover:scale-[1.02] active:scale-[0.98] text-lg tracking-wide ${s?"bg-linear-to-r from-slate-600 to-slate-700 hover:from-slate-500 hover:to-slate-600 shadow-slate-900/20":"bg-linear-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 shadow-cyan-900/20"}`,children:s?"New Game":"Start Building"})]})]})]})}),Xt=()=>{const[r,s]=o.useState(!1),[a,l]=o.useState([]),[n,c]=o.useState(At),[C,y]=o.useState("Neo City"),[m,d]=o.useState(f.ROAD),[w,z]=o.useState(null),[T,_]=o.useState(null),[p,k]=o.useState(10),[j,t]=o.useState([]),[x,g]=o.useState(!0),[P,I]=o.useState({autoSaveEnabled:!0,lastSavedAt:null}),[i,u]=o.useState(!1),h=o.useRef(a),v=o.useRef(n),N=o.useRef(C),A=o.useRef(p),E=o.useRef(j),F=o.useRef(n.money);o.useEffect(()=>{h.current=a},[a]),o.useEffect(()=>{v.current=n},[n]),o.useEffect(()=>{N.current=C},[C]),o.useEffect(()=>{A.current=p},[p]),o.useEffect(()=>{E.current=j},[j]),o.useEffect(()=>{(async()=>{const U=await xe.hasSave();u(U)})()},[]);const L=o.useCallback(async(b=!1)=>{const U=await xe.save(h.current,v.current,N.current,A.current,E.current);if(U&&(I(O=>({...O,lastSavedAt:Date.now()})),!b)){const V=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});t(G=>[{id:Math.random().toString(36).substr(2,9),user:"SYSTEM",content:"City data synchronized to neural network.",timestamp:V,type:"positive"},...G])}return U},[t]),B=o.useCallback(async()=>{const b=await xe.load();return b?(l(b.cityData),c(b.stats),y(b.cityName),k(b.gameTime),t(b.feedMessages),I(U=>({...U,lastSavedAt:b.savedAt})),!0):!1},[]),q=async(b=!1)=>{if(b)await B();else{const U=[];for(let V=0;V<R;V++)for(let G=0;G<R;G++)U.push({x:V,z:G,type:f.EMPTY,level:0});l(U);const O={id:"welcome",user:"SYSTEM",content:`Welcome to ${C}. Terrain generation complete. Ready for development.`,timestamp:"11:30 PM",type:"neutral"};t([O])}s(!0)},he=()=>{I(b=>({...b,autoSaveEnabled:!b.autoSaveEnabled}))};o.useEffect(()=>{if(!r||!P.autoSaveEnabled)return;const b=setInterval(()=>{L(!0)},6e4);return()=>clearInterval(b)},[r,P.autoSaveEnabled,L]),o.useEffect(()=>{if(!r)return;const b=setInterval(()=>{l(U=>{const O=U.reduce((X,fe)=>(X[fe.type]=(X[fe.type]||0)+1,X),{}),V=(O[f.RESIDENTIAL]||0)*10,G=(O[f.COMMERCIAL]||0)*15+(O[f.INDUSTRIAL]||0)*25,ee=(O[f.ROAD]||0)*2+(O[f.PARK]||0)*10,de=Math.min(100,Math.max(0,70+(O[f.PARK]||0)*2));return c(X=>({...X,population:V,money:X.money+(G-ee),income:G,expense:ee,happiness:Math.round(de)})),U}),k(U=>(U+.1)%24)},5e3);return()=>clearInterval(b)},[r]),o.useEffect(()=>{if(r){if(n.money<0&&F.current>=0){const U=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});t(O=>[{id:Math.random().toString(36).substr(2,9),user:"SYSTEM",content:"Warning: City treasury is in deficit! Revenue generation required.",timestamp:U,type:"negative"},...O].slice(0,50))}F.current=n.money}},[n.money]);const Q=o.useCallback((b,U)=>{r&&(_(null),l(O=>{const V=O.findIndex($=>$.x===b&&$.z===U);if(V===-1)return O;const G=O[V];if(m===f.EMPTY){if(G.type===f.EMPTY)return O;const $=[...O];return $[V]={...G,type:f.EMPTY,level:0},z(null),$}if(G.type!==f.EMPTY)return z({x:b,z:U}),O;const ee=ye[m];if(v.current.money<ee.cost)return _("Insufficient budget!"),O;const de=[...O],X=Math.floor(Math.random()*3);de[V]={...G,type:m,level:X};const ke=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return t($=>[{id:Math.random().toString(36).substr(2,9),user:"SYSTEM",content:`Construction complete: ${ee.label} deployed at [${b}, ${U}].`,timestamp:ke,type:"neutral"},...$].slice(0,50)),c($=>({...$,money:$.money-ee.cost})),z({x:b,z:U}),de}))},[m,r]),ce=b=>{d(b),z(null),_(null)},le=a.find(b=>b.x===w?.x&&b.z===w?.z)||null;return e.jsxs("div",{className:"relative w-full h-screen",children:[e.jsxs(Ie,{shadows:!0,camera:{position:[15,15,15],fov:40},children:[e.jsx(Yt,{gameTime:p}),e.jsx(Ot,{cityData:a,onTileClick:Q,selectedType:m,selectedBuilding:w}),e.jsx(Ht,{cityData:a}),e.jsx(Tt,{position:[0,-.01,0],opacity:.3,scale:30,blur:2.5,far:5}),e.jsx(Ze,{preset:"city"}),e.jsx(tt,{makeDefault:!0,maxPolarAngle:Math.PI/2.1,minDistance:5,maxDistance:40})]}),!r&&e.jsx(qt,{onStart:q,hasSavedGame:i}),r&&e.jsxs(e.Fragment,{children:[e.jsx(Kt,{messages:j,isVisible:x,onClear:()=>t([])}),T&&e.jsxs("div",{className:"absolute top-24 left-1/2 -translate-x-1/2 z-50 bg-red-600/90 text-white px-6 py-2 rounded-full shadow-lg border border-red-400 animate-bounce pointer-events-none flex items-center",children:[e.jsx(rt,{className:"w-5 h-5 mr-2"}),T]}),e.jsx(Ut,{stats:n,cityName:C,onRenameCity:y,selectedType:m,onSelectType:ce,selectedBuildingInfo:le,onDeselect:()=>z(null),isFeedVisible:x,onToggleFeed:()=>g(!x),saveSettings:P,onSave:()=>L(!1),onToggleAutoSave:he})]})]})},hr={fullscreen:!0};function fr(){return[{title:"Neo City"},{property:"og:title",content:"Neo City"},{name:"description",content:"Neo City - A city building simulation game with isometric 3D graphics."}]}const pr=Ae(Xt);export{pr as default,hr as handle,fr as meta};
