function b(...n){console.error(...n)}function E(n,t,e=!0){let r,a=[];if(typeof n=="object"){if(r=n.url,Array.isArray(n.ignore))a=n.ignore.map(o=>o.startsWith("?")||o.startsWith("&")?o.substring(1):o);else if(typeof n.ignore=="string"){let o=n.ignore;(o.startsWith("?")||o.startsWith("&"))&&(o=o.substring(1)),a.push(o)}}else r=n;const s=new URL(r);if(t===null)return s.search="",s.toString();let f=s.search.substring(1);const i=f.length>0?f.split("&"):[],h=[],u=[];for(const o of i)a.includes(o)?h.push(o):u.push(o);const p=new URLSearchParams(u.join("&"));for(const[o,m]of Object.entries(t)){const c=m===null?"":String(m);!e&&p.has(o)||p.set(o,c)}const g=h.concat(p.toString().split("&").filter(o=>o)).join("&");return s.search=g?"?"+g:"",s.toString()}function T(n,t,e=!0){e&&(t=JSON.stringify(t)),window.localStorage.setItem(n,t)}function L(n,t=!0){const e=window.localStorage.getItem(n);if(e===null)return null;if(t)try{return JSON.parse(e)}catch(r){b("Error while parsing stored json value: ",r)}return e}function S(n,t=new FormData){const{data:e,parentKey:r=""}=n;if(e instanceof FormData)e.forEach((a,s)=>{t.append(s,a)});else if(e!==null&&typeof e=="object")if(e instanceof Blob||e instanceof File){const a=r||"file";t.append(a,e)}else Object.keys(e).forEach(a=>{const s=e[a],f=r?`${r}[${a}]`:a;s!==null&&typeof s=="object"?S({data:s,parentKey:f},t):s!==null&&t.append(f,String(s))});else e!==null&&t.append(r,e);return t}function j(n,t=""){return n instanceof FormData?n:S({data:n,parentKey:t})}function P(n){const t={};return n.forEach((e,r)=>{typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e===null?t[r]=e:t[r]=e.toString()}),t}function U(n){const t={};return n instanceof FormData?P(n):(typeof n=="object"&&Object.entries(n).forEach(([e,r])=>{typeof r=="string"||typeof r=="number"||typeof r=="boolean"||r===null?t[e]=r:t[e]=JSON.stringify(r)}),t)}async function O(n){const{url:t,method:e="GET",headers:r={},cache:a="no-cache",mode:s="cors",credentials:f="same-origin",body:i=null,beforeSend:h=null,success:u=null,error:p=null}=n;let l=t;const g=r instanceof Headers?r:new Headers(r),o={method:e,mode:s,headers:g,cache:a,credentials:f};if(i&&i!==null&&e.toUpperCase()==="GET"){const c=U(i);l=E(typeof t=="string"?t:t.toString(),c,!0)}else if(i&&i!==null&&["PUT","POST","DELETE"].includes(e.toUpperCase())){let c=i;i instanceof FormData||(c=JSON.stringify(i),o.headers instanceof Headers||(o.headers=new Headers(o.headers)),o.headers.append("Content-Type","application/json")),o.body=c}let m;if(typeof l=="string"||l instanceof URL)m=new Request(l,o);else if(l instanceof Request)m=l;else throw new Error("Invalid URL type");try{const c=await new Promise(y=>{h?.(),y(m)}),d=await fetch(c);if(d.ok){if(typeof u=="function"){const w=await d.clone().json();u?.(w)}}else throw new Error(`HTTP error! status: ${d.status}`);return d}catch(c){const d=c instanceof Error?c:new Error(String(c));throw p?.(d),d}}async function R(n){const{url:t,data:e,method:r="POST",headers:a,cache:s,mode:f,credentials:i,success:h,error:u,beforeSend:p,encode:l=!0}=n,g={url:t,method:r,headers:a,cache:s,mode:f,credentials:i,body:l&&r.toUpperCase()!=="GET"?j(e):e,beforeSend:p,success:h,error:u};return(await O(g)).json()}const F=R;export{F as f,L as g,T as s};
