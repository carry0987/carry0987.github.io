function b(...t){console.error(...t)}function E(t,n,e=!0){let r,a=[];if(typeof t=="object"){if(r=t.url,Array.isArray(t.ignore))a=t.ignore.map(o=>o.startsWith("?")||o.startsWith("&")?o.substring(1):o);else if(typeof t.ignore=="string"){let o=t.ignore;(o.startsWith("?")||o.startsWith("&"))&&(o=o.substring(1)),a.push(o)}}else r=t;const s=new URL(r);if(n===null)return s.search="",s.toString();let f=s.search.substring(1);const i=f.length>0?f.split("&"):[],h=[],u=[];for(const o of i)a.includes(o)?h.push(o):u.push(o);const p=new URLSearchParams(u.join("&"));for(const[o,g]of Object.entries(n)){const c=g===null?"":String(g);!e&&p.has(o)||p.set(o,c)}const m=h.concat(p.toString().split("&").filter(o=>o)).join("&");return s.search=m?"?"+m:"",s.toString()}function R(t,n,e=!0){e&&(n=JSON.stringify(n)),window.localStorage.setItem(t,n)}function T(t,n=!0){const e=window.localStorage.getItem(t);if(e===null)return null;if(n)try{return JSON.parse(e)}catch(r){b("Error while parsing stored json value: ",r)}return e}function F(t){window.localStorage.removeItem(t)}function S(t,n=new FormData){const{data:e,parentKey:r=""}=t;if(e instanceof FormData)e.forEach((a,s)=>{n.append(s,a)});else if(e!==null&&typeof e=="object")if(e instanceof Blob||e instanceof File){const a=r||"file";n.append(a,e)}else Object.keys(e).forEach(a=>{const s=e[a],f=r?`${r}[${a}]`:a;s!==null&&typeof s=="object"?S({data:s,parentKey:f},n):s!==null&&n.append(f,String(s))});else e!==null&&n.append(r,e);return n}function j(t,n=""){return t instanceof FormData?t:S({data:t,parentKey:n})}function P(t){const n={};return t.forEach((e,r)=>{typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e===null?n[r]=e:n[r]=e.toString()}),n}function U(t){const n={};return t instanceof FormData?P(t):(typeof t=="object"&&Object.entries(t).forEach(([e,r])=>{typeof r=="string"||typeof r=="number"||typeof r=="boolean"||r===null?n[e]=r:n[e]=JSON.stringify(r)}),n)}async function L(t){const{url:n,method:e="GET",headers:r={},cache:a="no-cache",mode:s="cors",credentials:f="same-origin",body:i=null,beforeSend:h=null,success:u=null,error:p=null}=t;let l=n;const m=r instanceof Headers?r:new Headers(r),o={method:e,mode:s,headers:m,cache:a,credentials:f};if(i&&i!==null&&e.toUpperCase()==="GET"){const c=U(i);l=E(typeof n=="string"?n:n.toString(),c,!0)}else if(i&&i!==null&&["PUT","POST","DELETE"].includes(e.toUpperCase())){let c=i;i instanceof FormData||(c=JSON.stringify(i),o.headers instanceof Headers||(o.headers=new Headers(o.headers)),o.headers.append("Content-Type","application/json")),o.body=c}let g;if(typeof l=="string"||l instanceof URL)g=new Request(l,o);else if(l instanceof Request)g=l;else throw new Error("Invalid URL type");try{const c=await new Promise(y=>{h?.(),y(g)}),d=await fetch(c);if(d.ok){if(typeof u=="function"){const w=await d.clone().json();u?.(w)}}else throw new Error(`HTTP error! status: ${d.status}`);return d}catch(c){const d=c instanceof Error?c:new Error(String(c));throw p?.(d),d}}async function O(t){const{url:n,data:e,method:r="POST",headers:a,cache:s,mode:f,credentials:i,success:h,error:u,beforeSend:p,encode:l=!0}=t,m={url:n,method:r,headers:a,cache:s,mode:f,credentials:i,body:l&&r.toUpperCase()!=="GET"?j(e):e,beforeSend:p,success:h,error:u};return(await L(m)).json()}const D=O;export{D as f,T as g,F as r,R as s};
