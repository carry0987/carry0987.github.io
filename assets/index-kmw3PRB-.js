import{r as u,j as a,w as qe}from"./chunk-JZWAC4HX-CEDt07HX.js";import{c as Ke,C as Q,n as Je,P as Qe,W as $e,o as et,p as tt,q as xe,r as nt,G as rt,j as Le,s as ae,i as X,t as ot,u as st,h as Pe,D as we,v as Ie,A as ve,w as at,B as je,d as ie,e as it,f as ct,S as lt,k as ut,V as F,x as dt}from"./three.module-D2towu2S.js";import{T as ft}from"./trophy-D6c6WoYN.js";import{T as mt}from"./triangle-alert-Ck2ViR_N.js";import{S as ht,P as pt}from"./smartphone-CZ3NPXkh.js";import{R as xt}from"./rotate-ccw-iPDkDlPR.js";import{H as wt}from"./house-BiNovosF.js";import"./createLucideIcon-Cddq2NQa.js";const p=2,Y=.6,Se=.15,Ce=.96,ce=.8,vt=15,C=[[1,1,1,1,1,1,1,1,1,1],[1,2,0,0,1,0,0,4,0,1],[1,0,1,0,1,0,1,1,0,1],[1,0,1,0,0,0,0,1,0,1],[1,0,1,1,4,1,0,1,0,1],[1,0,0,0,0,1,0,0,0,1],[1,1,1,1,0,1,1,1,0,1],[1,0,0,0,0,0,0,1,3,1],[1,1,1,1,1,1,1,1,1,1]];var i=(o=>(o.MENU="MENU",o.PLAYING="PLAYING",o.WON="WON",o.GAME_OVER="GAME_OVER",o))(i||{});const $=1e3,gt=.3,le=40,yt=.4,bt=()=>{const o=document.createElement("canvas");o.width=32,o.height=32;const w=o.getContext("2d");if(w){const g=w.createRadialGradient(16,16,0,16,16,16);g.addColorStop(0,"rgba(255, 255, 255, 1)"),g.addColorStop(.4,"rgba(255, 255, 255, 0.5)"),g.addColorStop(1,"rgba(255, 255, 255, 0)"),w.fillStyle=g,w.fillRect(0,0,32,32)}return new ut(o)},Mt=({gameState:o,onGameStateChange:w,hasPermission:R})=>{const g=u.useRef(null),O=u.useRef(null),U=u.useRef(null),ee=u.useRef(null),E=u.useRef(null),P=u.useRef(null),d=u.useRef({x:0,y:0,z:0}),s=u.useRef({x:0,y:Y,z:0}),x=u.useRef({x:0,z:0}),ge=u.useRef(0),te=u.useRef(!1),V=u.useRef(null),ne=u.useRef(null),ue=u.useRef(null),T=u.useRef(null),k=u.useRef([]),_=u.useRef(null),W=u.useRef([]),H=u.useRef(null);return u.useEffect(()=>{if(!g.current)return;const A=new Ke,B=new Q(131589);A.background=B,A.fog=new Je(B,10,60),O.current=A;const N=new Qe(45,window.innerWidth/window.innerHeight,.1,100);N.position.set(0,22,18),N.lookAt(0,0,0),U.current=N;const b=new $e({antialias:!0,alpha:!1});b.setSize(window.innerWidth,window.innerHeight),b.shadowMap.enabled=!0,b.shadowMap.type=et,b.setPixelRatio(Math.min(window.devicePixelRatio,2)),g.current.appendChild(b.domElement),ee.current=b;const I=new tt(16777215,.1);A.add(I);const f=new xe(65535,1.5,50);f.position.set(0,15,0),f.castShadow=!0,f.shadow.mapSize.width=2048,f.shadow.mapSize.height=2048,f.shadow.bias=-1e-4,A.add(f),V.current=f;const M=new nt(100,40,17476,4369);M.position.y=-8,A.add(M),T.current=M;const m=new rt;A.add(m),P.current=m;const Z=[];let j={x:0,z:0},q={x:0,z:0};const Oe=new Le(p,p,p),ye=new ae({color:1710638,roughness:.2,metalness:.8,emissive:255,emissiveIntensity:.1}),Te=new Le(p,.5,p),D=new ae({color:328965,roughness:.5,metalness:.5});D.onBeforeCompile=h=>{h.uniforms.tiltX={value:0},h.uniforms.tiltZ={value:0},h.uniforms.time={value:0},D.userData.uniforms=h.uniforms,h.fragmentShader=`
        uniform float tiltX;
        uniform float tiltZ;
        uniform float time;
      `+h.fragmentShader,h.fragmentShader=h.fragmentShader.replace("#include <emissivemap_fragment>",`
        #include <emissivemap_fragment>
        
        vec2 tiltDir = vec2(tiltZ, tiltX); 
        float tiltLen = length(tiltDir);
        
        if (tiltLen > 0.1) {
          float pulse = sin(time * 5.0) * 0.5 + 0.5;
          vec3 tiltColor = vec3(0.0, 1.0, 1.0) * tiltLen * 0.5; 
          totalEmissiveRadiance += tiltColor * pulse;
        }
        `)};const be=C[0].length*p/2-p/2,Me=C.length*p/2-p/2;C.forEach((h,G)=>{h.forEach((v,S)=>{const y=S*p-be,r=G*p-Me;if(v!==4){const t=new X(Te,D);t.position.set(y,-.25,r),t.receiveShadow=!0,m.add(t)}if(v===1){const t=new X(Oe,ye);t.position.set(y,0,r),t.castShadow=!0,t.receiveShadow=!0,m.add(t);const e=new ot().setFromObject(t);e.expandByScalar(-.1),Z.push(e)}else if(v===2){j={x:y,z:r};const t=new st(.5,.8,32),e=new Pe({color:65280,side:we}),n=new X(t,e);n.rotation.x=-Math.PI/2,n.position.set(y,-p/2+.3,r),m.add(n)}else if(v===3){q={x:y,z:r};const t=new Ie(.3,.3,40,16,1,!0),e=new Pe({color:16711935,transparent:!0,opacity:.3,blending:ve,side:we,depthWrite:!1}),n=new X(t,e);n.position.set(y,20,r),m.add(n),ue.current=e;const c=new Ie(.8,1,.2,32),l=new ae({color:16711935,emissive:16711935,emissiveIntensity:2}),z=new X(c,l);z.position.set(y,-p/2+.3,r),m.add(z);const L=new xe(16711935,2,8);L.position.set(y,1,r),m.add(L)}})});const _e=new at(Y,32,32),Ve=new ae({color:65535,metalness:.6,roughness:.2,emissive:35071,emissiveIntensity:.5}),K=new X(_e,Ve);K.castShadow=!0,s.current={x:j.x,y:0,z:j.z},K.position.set(j.x,0,j.z);const ze=new xe(35071,2,12);K.add(ze),ne.current=ze,m.add(K),E.current=K;const Re=[];for(let h=0;h<$;h++)Re.push({active:!1,x:0,y:0,z:0,vx:0,vy:0,vz:0,life:0,maxLife:1,color:new Q,sizeScale:1});k.current=Re;const re=new je,De=new Float32Array($*3),Xe=new Float32Array($*3);re.setAttribute("position",new ie(De,3)),re.setAttribute("color",new ie(Xe,3));const Ye=new it({size:gt,vertexColors:!0,map:bt(),blending:ve,depthWrite:!1,transparent:!0,opacity:.8}),ke=new ct(re,Ye);m.add(ke),_.current=re;const de=new je,We=new Float32Array(le*2*3),He=new Float32Array(le*2);de.setAttribute("position",new ie(We,3)),de.setAttribute("alpha",new ie(He,1));const Ze=new lt({uniforms:{color:{value:new Q(65535)}},vertexShader:`
        attribute float alpha;
        varying float vAlpha;
        void main() {
          vAlpha = alpha;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,fragmentShader:`
        uniform vec3 color;
        varying float vAlpha;
        void main() {
          gl_FragColor = vec4(color, vAlpha);
        }
      `,transparent:!0,depthWrite:!1,blending:ve,side:we}),fe=new X(de,Ze);fe.frustumCulled=!1,m.add(fe),H.current=fe;const Ee=(h,G,v,S,y,r,t)=>{let e=0;for(let n=0;n<$;n++)if(!k.current[n].active){const c=k.current[n];c.active=!0,c.x=h,c.y=G,c.z=v;const l=Math.random()*Math.PI*2,z=Math.random()*Math.PI,L=Math.random()*r;if(c.vx=Math.sin(z)*Math.cos(l)*L+(Math.random()-.5)*t,c.vy=Math.cos(z)*L+(Math.random()-.5)*t,c.vz=Math.sin(z)*Math.sin(l)*L+(Math.random()-.5)*t,c.life=1,c.maxLife=.5+Math.random()*.5,c.color.copy(S),e++,e>=y)break}},Fe=()=>{if(o!==i.PLAYING)return;const h=x.current.x,G=x.current.z,v=Math.round((s.current.x+be)/p),S=Math.round((s.current.z+Me)/p),y=C.length,r=C[0].length;let t=!1;if((S<0||S>=y||v<0||v>=r||C[S][v]===4)&&(t=!0),t)d.current.y-=.05,s.current.y+=d.current.y,s.current.x+=d.current.x,s.current.z+=d.current.z,s.current.y<-10&&w(i.GAME_OVER);else{s.current.y=0,d.current.y=0,d.current.x+=G*Se,d.current.z+=h*Se,d.current.x*=Ce,d.current.z*=Ce,d.current.x=Math.max(Math.min(d.current.x,ce),-ce),d.current.z=Math.max(Math.min(d.current.z,ce),-ce);let e=s.current.x+d.current.x,n=s.current.z+d.current.z;const c=(l,z)=>{const L=new dt(new F(l,0,z),Y);for(const oe of Z)if(oe.intersectsSphere(L))return!0;return!1};if(c(e,s.current.z)){const l=s.current.x+(d.current.x>0?Y:-Y);Ee(l,0,s.current.z,new Q(16711935),15,.2,.1),d.current.x*=-.5,e=s.current.x}else s.current.x=e;if(c(s.current.x,n)){const l=s.current.z+(d.current.z>0?Y:-Y);Ee(s.current.x,0,l,new Q(16711935),15,.2,.1),d.current.z*=-.5,n=s.current.z}else s.current.z=n}E.current&&(E.current.position.set(s.current.x,s.current.y,s.current.z),E.current.rotation.x-=d.current.z*.2,E.current.rotation.z+=d.current.x*.2),t||Math.sqrt((s.current.x-q.x)**2+(s.current.z-q.z)**2)<1&&w(i.WON)},Ae=()=>{requestAnimationFrame(Ae);const G=(navigator.getGamepads?navigator.getGamepads():[])[0];if(G){const t=G.axes[0],e=G.axes[1];(Math.abs(t)>.1||Math.abs(e)>.1)&&(te.current=!0),te.current&&(x.current={x:Math.abs(e)<.1?0:e,z:Math.abs(t)<.1?0:t})}const v=Date.now()*.001;if(D.userData.uniforms&&(D.userData.uniforms.time.value=v,D.userData.uniforms.tiltX.value=x.current.x,D.userData.uniforms.tiltZ.value=x.current.z),P.current){P.current.rotation.x+=(x.current.x*.5-P.current.rotation.x)*.1,P.current.rotation.z+=(-x.current.z*.5-P.current.rotation.z)*.1;const t=1-Math.sqrt(x.current.x**2+x.current.z**2)*.1;P.current.scale.y+=(t-P.current.scale.y)*.1}const S=Math.sqrt(x.current.x**2+x.current.z**2);if(ye.emissiveIntensity=.1+S*.8,V.current){const r=Math.sin(v*.8)*.3;V.current.intensity=1.5+r;const t=-x.current.z*25,e=-x.current.x*25;V.current.position.x+=(t-V.current.position.x)*.05,V.current.position.z+=(e-V.current.position.z)*.05}if(T.current){const r=x.current.z*8,t=-x.current.x*8;T.current.position.x+=(r-T.current.position.x)*.05,T.current.position.z+=(t-T.current.position.z)*.05,T.current.rotation.z=-x.current.z*.15,T.current.rotation.x=x.current.x*.15}const y=Math.sin(v*3);if(ne.current&&(ne.current.intensity=2+y*.5,ne.current.distance=12+y*2),E.current){const r=E.current.material;r.emissiveIntensity=.6+y*.2}if(ue.current&&(ue.current.opacity=.3+Math.sin(v*4)*.15),_.current){const r=_.current.attributes.position.array,t=_.current.attributes.color.array;for(let e=0;e<$;e++){const n=k.current[e];if(n.active){n.x+=n.vx,n.y+=n.vy,n.z+=n.vz,n.life-=.02,r[e*3]=n.x,r[e*3+1]=n.y,r[e*3+2]=n.z;const c=n.life/n.maxLife;t[e*3]=n.color.r*c,t[e*3+1]=n.color.g*c,t[e*3+2]=n.color.b*c,n.life<=0&&(n.active=!1,r[e*3]=0,r[e*3+1]=-1e3,r[e*3+2]=0)}else r[e*3]=0,r[e*3+1]=-1e3,r[e*3+2]=0}_.current.attributes.position.needsUpdate=!0,_.current.attributes.color.needsUpdate=!0}if(o===i.PLAYING&&E.current){const r=E.current.position.clone();r.y+=.05,W.current.push(r),W.current.length>le&&W.current.shift()}if(H.current&&W.current.length>1){const r=H.current.geometry,t=r.attributes.position,e=r.attributes.alpha,n=W.current,c=n.length;for(let l=0;l<c;l++){const z=n[l],L=l<c-1?n[l+1]:null,oe=l>0?n[l-1]:null,J=new F(1,0,0);L?J.subVectors(L,z):oe&&J.subVectors(z,oe),J.normalize();const Ne=new F(-J.z,0,J.x).multiplyScalar(yt*.5),he=new F().addVectors(z,Ne),pe=new F().subVectors(z,Ne),se=l*2;t.setXYZ(se,he.x,he.y,he.z),t.setXYZ(se+1,pe.x,pe.y,pe.z);const Ge=l/(c-1);e.setX(se,Ge),e.setX(se+1,Ge)}for(let l=c*2;l<le*2;l++)t.setXYZ(l,0,0,0),e.setX(l,0);r.setDrawRange(0,c*2),t.needsUpdate=!0,e.needsUpdate=!0}Fe(),b.render(A,N)},Ue=()=>{const h=window.innerWidth/window.innerHeight,G=new F(0,22,18);let v=1;h<1&&(v=Math.max(1,1.2/h)),N.position.copy(G).multiplyScalar(v),N.lookAt(0,0,0)},me=()=>{N.aspect=window.innerWidth/window.innerHeight,N.updateProjectionMatrix(),b.setSize(window.innerWidth,window.innerHeight),Ue()};window.addEventListener("resize",me),me();const Be=requestAnimationFrame(Ae);return()=>{window.removeEventListener("resize",me),cancelAnimationFrame(Be),g.current&&g.current.removeChild(b.domElement),b.dispose(),_.current&&_.current.dispose(),H.current&&(H.current.geometry.dispose(),H.current.material.dispose())}},[o,w]),u.useEffect(()=>{const A=()=>{const I=C[0].length*p/2-p/2,f=C.length*p/2-p/2;let M={x:0,z:0};C.forEach((m,Z)=>{m.forEach((j,q)=>{j===2&&(M={x:q*p-I,z:Z*p-f})})}),s.current={x:M.x,y:0,z:M.z},d.current={x:0,y:0,z:0},k.current&&k.current.forEach(m=>m.active=!1),W.current=[]};o===i.PLAYING&&A();const B=I=>{if(te.current=!1,!R)return;let{beta:f,gamma:M}=I;if(f===null||M===null)return;const m=30;f>90&&(f=90),f<-90&&(f=-90);const Z=Math.min(Math.max(f/m,-1),1),j=Math.min(Math.max(M/m,-1),1);x.current={x:Z,z:j}},N=I=>{if(!R)return;const f=I.accelerationIncludingGravity;if(!f)return;if(Math.sqrt((f.x||0)**2+(f.y||0)**2+(f.z||0)**2)>vt){const m=Date.now();m-ge.current>1e3&&(ge.current=m,A())}},b=I=>{if(te.current=!1,R)return;const f=I.clientY/window.innerHeight*2-1,M=I.clientX/window.innerWidth*2-1;x.current={x:f,z:M}};return window.addEventListener("deviceorientation",B),window.addEventListener("devicemotion",N),window.addEventListener("mousemove",b),()=>{window.removeEventListener("deviceorientation",B),window.removeEventListener("devicemotion",N),window.removeEventListener("mousemove",b)}},[R,o]),a.jsx("div",{ref:g,className:"absolute inset-0 z-0"})},zt=({gameState:o,onStart:w,onReset:R,onMenu:g,needsPermission:O,onRequestPermission:U})=>o===i.PLAYING?a.jsxs("div",{className:"absolute top-4 left-0 right-0 flex justify-between px-6 pointer-events-none z-10",children:[a.jsx("div",{className:"text-cyan-400 font-mono text-sm opacity-80 bg-black/50 p-2 rounded",children:"TILT to Move"}),a.jsx("div",{className:"text-cyan-400 font-mono text-sm opacity-80 bg-black/50 p-2 rounded",children:"SHAKE to Reset"})]}):a.jsx("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-gray-900 border border-cyan-500 p-8 rounded-2xl shadow-[0_0_30px_rgba(6,182,212,0.3)] text-center max-w-sm w-full mx-4",children:[o===i.WON&&a.jsxs("div",{className:"mb-6 animate-bounce",children:[a.jsx(ft,{className:"w-16 h-16 text-yellow-400 mx-auto mb-2"}),a.jsx("h2",{className:"text-3xl font-bold text-transparent bg-clip-text bg-linear-to-r from-yellow-300 to-yellow-600",children:"VICTORY!"})]}),o===i.GAME_OVER&&a.jsxs("div",{className:"mb-6",children:[a.jsx(mt,{className:"w-16 h-16 text-red-500 mx-auto mb-2 animate-pulse"}),a.jsx("h2",{className:"text-3xl font-bold text-red-500",children:"YOU FELL!"}),a.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Watch out for the holes!"})]}),o===i.MENU&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-4xl font-black text-cyan-400 mb-2 tracking-wider drop-shadow-lg",children:"NEON MAZE"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Navigate the ball to the pink beam."})]}),a.jsxs("div",{className:"space-y-4",children:[O&&o===i.MENU?a.jsxs("button",{onClick:U,className:"w-full group flex items-center justify-center gap-2 bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-4 px-6 rounded-xl transition-all active:scale-95",children:[a.jsx(ht,{className:"w-6 h-6 group-hover:rotate-12 transition-transform"}),"Enable Sensors & Play"]}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:o===i.GAME_OVER?R:w,className:"w-full group flex items-center justify-center gap-2 bg-linear-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white font-bold py-4 px-6 rounded-xl transition-all active:scale-95 shadow-lg",children:[o===i.WON||o===i.GAME_OVER?a.jsx(xt,{}):a.jsx(pt,{}),o===i.WON?"Play Again":o===i.GAME_OVER?"Try Again":"Start Game"]}),(o===i.WON||o===i.GAME_OVER)&&a.jsxs("button",{onClick:g,className:"w-full group flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-gray-300 font-bold py-3 px-6 rounded-xl transition-all active:scale-95",children:[a.jsx(wt,{className:"w-5 h-5"}),"Main Menu"]})]}),!O&&o===i.MENU&&a.jsxs("p",{className:"text-xs text-gray-500 mt-4",children:["Desktop: Use mouse to tilt board.",a.jsx("br",{}),"Mobile: Tilt device to move."]})]})]})});function Rt(){const[o,w]=u.useState(i.MENU),[R,g]=u.useState(!1),[O,U]=u.useState(!1);u.useEffect(()=>{const s=typeof DeviceOrientationEvent<"u"&&typeof DeviceOrientationEvent.requestPermission=="function";U(s),s||g(!0)},[]);const ee=async()=>{if(O)try{await DeviceOrientationEvent.requestPermission()==="granted"?(g(!0),w(i.PLAYING)):alert("Motion permissions are required to play.")}catch(s){console.error(s),g(!0),w(i.PLAYING)}else g(!0),w(i.PLAYING)},E=()=>{O&&!R?ee():w(i.PLAYING)},P=()=>{w(i.PLAYING)},d=()=>{w(i.MENU)};return a.jsxs("div",{className:"relative w-full h-screen overflow-hidden bg-black select-none",children:[a.jsx(Mt,{gameState:o,onGameStateChange:w,hasPermission:R}),a.jsx(zt,{gameState:o,onStart:E,onReset:P,onMenu:d,needsPermission:O&&!R,onRequestPermission:ee})]})}const St={fullscreen:!0};function Ct(){return[{title:"Neon Gyro Maze | Carry"},{property:"og:title",content:"Neon Gyro Maze"},{name:"description",content:"A neon-themed maze game controlled by tilting your device. Navigate the glowing ball through the maze using your gyroscope."}]}const Ot=qe(Rt);export{Ot as default,St as handle,Ct as meta};
