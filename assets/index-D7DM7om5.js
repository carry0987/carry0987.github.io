import{r as b,R as Et,j as C,w as To}from"./chunk-EPOLDU6W-C81w235E.js";import{a as ot,u as et,_ as $e,s as Po,c as Fo,C as Do,O as Ro}from"./OrbitControls-DnDSUx3p.js";import{s as Io,g as Lo,r as Oo}from"./index-tSOQ2Rud.js";import{u as Bo}from"./usePageVisibility-1JvHndip.js";import{u as Oa}from"./useIsMobile--DQ0EtlN.js";import{V as xe,D as Ba,aq as st,P as Ga,Z as Na,d as pt,aB as ja,aC as aa,aD as yn,aE as Gt,aF as Go,t as sr,x as Mn,S as Wa,a as gn,aG as bn,i as Lr,aH as wt,aI as No,y as Or,M as rr,av as jo,C as St,aJ as Wo,ax as zo,aK as Ho,aL as Vo,h as Xo,aA as Yo,a2 as Jo,L as Fr,aM as Ko,g as An,B as za,R as Qo,az as qo,_ as Zo,H as $o,aN as es,E as ts,e as rs,aO as ns,aP as Nt,A as as}from"./three.module-D2towu2S.js";import{X as os}from"./x-dRgkQsHt.js";import{I as Ha,C as ss,a as oa}from"./info-CPt8cbTE.js";import{c as kt}from"./createLucideIcon-CBgGOGx9.js";import{S as Un}from"./shapes-Id8FnixG.js";import{c as is}from"./client-BFt3NF9-.js";import{v as Va}from"./constants-CGf7u7XM.js";import{v as Xa}from"./constants-DMhkyvJ3.js";import{S as ls}from"./Stars-BV3OphBA.js";import{A as cs}from"./arrow-left-CQWf9bed.js";import{D as us}from"./database-BQ3A4nIm.js";import{A as ds}from"./atom-Dxw4aBxU.js";import{a0 as nr,ac as fs,T as hs,k as sa,x as Ya,a as ms,b as ps,c as Er,d as Le,u as Ja,f as _r,e as vs,G as ys,g as gs,Y as Ft,i as bs,y as Br,o as Ze,F as xs,l as We,S as dt,L as _s,j as Sr,n as Ss,s as ws,$ as ks,q as Cs,r as Ms,t as Gr,V as Ka,v as As,K as Dt,z as Us,R as Es,J as Ts,A as ia,B as Ps,C as Fs,D as Dr,E as Ds,H as Rs,I as Is,M as Ls,p as Os,O as Bs,P as la,ad as Qa,Q as Gs,U as Ns,W as js,a1 as Ws,X as zs,a2 as Hs,a7 as qa,ae as Vs,a4 as Xs,a5 as Ys,a6 as Js,a8 as Ks,a9 as Qs,af as qs,aa as ca,ab as Zs}from"./use-text-value-DnCeh5nI.js";import{r as xn}from"./index-1cmS5RAl.js";import{C as $s}from"./cpu-CStXMEXs.js";import"./index-7OC5HNn7.js";const ei=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],Za=kt("box",ei);const ti=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]],ri=kt("circle-dot",ti);const ni=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],$a=kt("flame",ni);const ai=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],oi=kt("flask-conical",ai);const si=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],ii=kt("layout-grid",si);const li=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ci=kt("search",li);const ui=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],di=kt("table",ui);const fi=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],hi=kt("user",fi),ir=new xe,En=new xe,mi=new xe,ua=new st;function pi(l,r,c){const u=ir.setFromMatrixPosition(l.matrixWorld);u.project(r);const t=c.width/2,e=c.height/2;return[u.x*t+t,-(u.y*e)+e]}function vi(l,r){const c=ir.setFromMatrixPosition(l.matrixWorld),u=En.setFromMatrixPosition(r.matrixWorld),t=c.sub(u),e=r.getWorldDirection(mi);return t.angleTo(e)>Math.PI/2}function yi(l,r,c,u){const t=ir.setFromMatrixPosition(l.matrixWorld),e=t.clone();e.project(r),ua.set(e.x,e.y),c.setFromCamera(ua,r);const n=c.intersectObjects(u,!0);if(n.length){const o=n[0].distance;return t.distanceTo(c.ray.origin)<o}return!0}function gi(l,r){if(r instanceof Na)return r.zoom;if(r instanceof Ga){const c=ir.setFromMatrixPosition(l.matrixWorld),u=En.setFromMatrixPosition(r.matrixWorld),t=r.fov*Math.PI/180,e=c.distanceTo(u);return 1/(2*Math.tan(t/2)*e)}else return 1}function bi(l,r,c){if(r instanceof Ga||r instanceof Na){const u=ir.setFromMatrixPosition(l.matrixWorld),t=En.setFromMatrixPosition(r.matrixWorld),e=u.distanceTo(t),n=(c[1]-c[0])/(r.far-r.near),o=c[1]-n*r.far;return Math.round(n*e+o)}}const _n=l=>Math.abs(l)<1e-10?0:l;function eo(l,r,c=""){let u="matrix3d(";for(let t=0;t!==16;t++)u+=_n(r[t]*l.elements[t])+(t!==15?",":")");return c+u}const xi=(l=>r=>eo(r,l))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),_i=(l=>(r,c)=>eo(r,l(c),"translate(-50%,-50%)"))(l=>[1/l,1/l,1/l,1,-1/l,-1/l,-1/l,-1,1/l,1/l,1/l,1,1,1,1,1]);function Si(l){return l&&typeof l=="object"&&"current"in l}const wi=b.forwardRef(({children:l,eps:r=.001,style:c,className:u,prepend:t,center:e,fullscreen:n,portal:o,distanceFactor:a,sprite:s=!1,transform:i=!1,occlude:d,onOcclude:f,castShadow:h,receiveShadow:m,material:p,geometry:v,zIndexRange:E=[16777271,0],calculatePosition:w=pi,as:S="div",wrapperClass:x,pointerEvents:A="auto",...T},M)=>{const{gl:U,camera:L,scene:g,size:O,raycaster:_,events:I,viewport:F}=ot(),[V]=b.useState(()=>document.createElement(S)),Y=b.useRef(null),Q=b.useRef(null),W=b.useRef(0),N=b.useRef([0,0]),B=b.useRef(null),y=b.useRef(null),k=o?.current||I.connected||U.domElement.parentNode,D=b.useRef(null),R=b.useRef(!1),P=b.useMemo(()=>d&&d!=="blending"||Array.isArray(d)&&d.length&&Si(d[0]),[d]);b.useLayoutEffect(()=>{const q=U.domElement;d&&d==="blending"?(q.style.zIndex=`${Math.floor(E[0]/2)}`,q.style.position="absolute",q.style.pointerEvents="none"):(q.style.zIndex=null,q.style.position=null,q.style.pointerEvents=null)},[d]),b.useLayoutEffect(()=>{if(Q.current){const q=Y.current=is.createRoot(V);if(g.updateMatrixWorld(),i)V.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const j=w(Q.current,L,O);V.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${j[0]}px,${j[1]}px,0);transform-origin:0 0;`}return k&&(t?k.prepend(V):k.appendChild(V)),()=>{k&&k.removeChild(V),q.unmount()}}},[k,i]),b.useLayoutEffect(()=>{x&&(V.className=x)},[x]);const J=b.useMemo(()=>i?{position:"absolute",top:0,left:0,width:O.width,height:O.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:e?"translate3d(-50%,-50%,0)":"none",...n&&{top:-O.height/2,left:-O.width/2,width:O.width,height:O.height},...c},[c,e,n,O,i]),G=b.useMemo(()=>({position:"absolute",pointerEvents:A}),[A]);b.useLayoutEffect(()=>{if(R.current=!1,i){var q;(q=Y.current)==null||q.render(b.createElement("div",{ref:B,style:J},b.createElement("div",{ref:y,style:G},b.createElement("div",{ref:M,className:u,style:c,children:l}))))}else{var j;(j=Y.current)==null||j.render(b.createElement("div",{ref:M,style:J,className:u,children:l}))}});const z=b.useRef(!0);et(q=>{if(Q.current){L.updateMatrixWorld(),Q.current.updateWorldMatrix(!0,!1);const j=i?N.current:w(Q.current,L,O);if(i||Math.abs(W.current-L.zoom)>r||Math.abs(N.current[0]-j[0])>r||Math.abs(N.current[1]-j[1])>r){const X=vi(Q.current,L);let fe=!1;P&&(Array.isArray(d)?fe=d.map(oe=>oe.current):d!=="blending"&&(fe=[g]));const ue=z.current;if(fe){const oe=yi(Q.current,L,_,fe);z.current=oe&&!X}else z.current=!X;ue!==z.current&&(f?f(!z.current):V.style.display=z.current?"block":"none");const ee=Math.floor(E[0]/2),se=d?P?[E[0],ee]:[ee-1,0]:E;if(V.style.zIndex=`${bi(Q.current,L,se)}`,i){const[oe,K]=[O.width/2,O.height/2],ae=L.projectionMatrix.elements[5]*K,{isOrthographicCamera:ne,top:H,left:pe,bottom:te,right:ie}=L,$=xi(L.matrixWorldInverse),Se=ne?`scale(${ae})translate(${_n(-(ie+pe)/2)}px,${_n((H+te)/2)}px)`:`translateZ(${ae}px)`;let re=Q.current.matrixWorld;s&&(re=L.matrixWorldInverse.clone().transpose().copyPosition(re).scale(Q.current.scale),re.elements[3]=re.elements[7]=re.elements[11]=0,re.elements[15]=1),V.style.width=O.width+"px",V.style.height=O.height+"px",V.style.perspective=ne?"":`${ae}px`,B.current&&y.current&&(B.current.style.transform=`${Se}${$}translate(${oe}px,${K}px)`,y.current.style.transform=_i(re,1/((a||10)/400)))}else{const oe=a===void 0?1:gi(Q.current,L)*a;V.style.transform=`translate3d(${j[0]}px,${j[1]}px,0) scale(${oe})`}N.current=j,W.current=L.zoom}}if(!P&&D.current&&!R.current)if(i){if(B.current){const j=B.current.children[0];if(j!=null&&j.clientWidth&&j!=null&&j.clientHeight){const{isOrthographicCamera:X}=L;if(X||v)T.scale&&(Array.isArray(T.scale)?T.scale instanceof xe?D.current.scale.copy(T.scale.clone().divideScalar(1)):D.current.scale.set(1/T.scale[0],1/T.scale[1],1/T.scale[2]):D.current.scale.setScalar(1/T.scale));else{const fe=(a||10)/400,ue=j.clientWidth*fe,ee=j.clientHeight*fe;D.current.scale.set(ue,ee,1)}R.current=!0}}}else{const j=V.children[0];if(j!=null&&j.clientWidth&&j!=null&&j.clientHeight){const X=1/F.factor,fe=j.clientWidth*X,ue=j.clientHeight*X;D.current.scale.set(fe,ue,1),R.current=!0}D.current.lookAt(q.camera.position)}});const Z=b.useMemo(()=>({vertexShader:i?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[i]);return b.createElement("group",$e({},T,{ref:Q}),d&&!P&&b.createElement("mesh",{castShadow:h,receiveShadow:m,ref:D},v||b.createElement("planeGeometry",null),p||b.createElement("shaderMaterial",{side:Ba,vertexShader:Z.vertexShader,fragmentShader:Z.fragmentShader})))}),to=Va>=125?"uv1":"uv2";function ki(l,r=Math.PI/3){const c=Math.cos(r),u=(1+1e-10)*100,t=[new xe,new xe,new xe],e=new xe,n=new xe,o=new xe,a=new xe;function s(p){const v=~~(p.x*u),E=~~(p.y*u),w=~~(p.z*u);return`${v},${E},${w}`}const i=l.index?l.toNonIndexed():l,d=i.attributes.position,f={};for(let p=0,v=d.count/3;p<v;p++){const E=3*p,w=t[0].fromBufferAttribute(d,E+0),S=t[1].fromBufferAttribute(d,E+1),x=t[2].fromBufferAttribute(d,E+2);e.subVectors(x,S),n.subVectors(w,S);const A=new xe().crossVectors(e,n).normalize();for(let T=0;T<3;T++){const M=t[T],U=s(M);U in f||(f[U]=[]),f[U].push(A)}}const h=new Float32Array(d.count*3),m=new pt(h,3,!1);for(let p=0,v=d.count/3;p<v;p++){const E=3*p,w=t[0].fromBufferAttribute(d,E+0),S=t[1].fromBufferAttribute(d,E+1),x=t[2].fromBufferAttribute(d,E+2);e.subVectors(x,S),n.subVectors(w,S),o.crossVectors(e,n).normalize();for(let A=0;A<3;A++){const T=t[A],M=s(T),U=f[M];a.set(0,0,0);for(let L=0,g=U.length;L<g;L++){const O=U[L];o.dot(O)>c&&a.add(O)}a.normalize(),m.setXYZ(E+A,a.x,a.y,a.z)}}return i.setAttribute("normal",m),i}const da=new sr,wr=new xe;class Tn extends ja{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const r=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],c=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],u=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(u),this.setAttribute("position",new aa(r,3)),this.setAttribute("uv",new aa(c,2))}applyMatrix4(r){const c=this.attributes.instanceStart,u=this.attributes.instanceEnd;return c!==void 0&&(c.applyMatrix4(r),u.applyMatrix4(r),c.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(r){let c;r instanceof Float32Array?c=r:Array.isArray(r)&&(c=new Float32Array(r));const u=new yn(c,6,1);return this.setAttribute("instanceStart",new Gt(u,3,0)),this.setAttribute("instanceEnd",new Gt(u,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(r,c=3){let u;r instanceof Float32Array?u=r:Array.isArray(r)&&(u=new Float32Array(r));const t=new yn(u,c*2,1);return this.setAttribute("instanceColorStart",new Gt(t,c,0)),this.setAttribute("instanceColorEnd",new Gt(t,c,c)),this}fromWireframeGeometry(r){return this.setPositions(r.attributes.position.array),this}fromEdgesGeometry(r){return this.setPositions(r.attributes.position.array),this}fromMesh(r){return this.fromWireframeGeometry(new Go(r.geometry)),this}fromLineSegments(r){const c=r.geometry;return this.setPositions(c.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new sr);const r=this.attributes.instanceStart,c=this.attributes.instanceEnd;r!==void 0&&c!==void 0&&(this.boundingBox.setFromBufferAttribute(r),da.setFromBufferAttribute(c),this.boundingBox.union(da))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Mn),this.boundingBox===null&&this.computeBoundingBox();const r=this.attributes.instanceStart,c=this.attributes.instanceEnd;if(r!==void 0&&c!==void 0){const u=this.boundingSphere.center;this.boundingBox.getCenter(u);let t=0;for(let e=0,n=r.count;e<n;e++)wr.fromBufferAttribute(r,e),t=Math.max(t,u.distanceToSquared(wr)),wr.fromBufferAttribute(c,e),t=Math.max(t,u.distanceToSquared(wr));this.boundingSphere.radius=Math.sqrt(t),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(r){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(r)}}class ro extends Tn{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(r){const c=r.length-3,u=new Float32Array(2*c);for(let t=0;t<c;t+=3)u[2*t]=r[t],u[2*t+1]=r[t+1],u[2*t+2]=r[t+2],u[2*t+3]=r[t+3],u[2*t+4]=r[t+4],u[2*t+5]=r[t+5];return super.setPositions(u),this}setColors(r,c=3){const u=r.length-c,t=new Float32Array(2*u);if(c===3)for(let e=0;e<u;e+=c)t[2*e]=r[e],t[2*e+1]=r[e+1],t[2*e+2]=r[e+2],t[2*e+3]=r[e+3],t[2*e+4]=r[e+4],t[2*e+5]=r[e+5];else for(let e=0;e<u;e+=c)t[2*e]=r[e],t[2*e+1]=r[e+1],t[2*e+2]=r[e+2],t[2*e+3]=r[e+3],t[2*e+4]=r[e+4],t[2*e+5]=r[e+5],t[2*e+6]=r[e+6],t[2*e+7]=r[e+7];return super.setColors(t,c),this}fromLine(r){const c=r.geometry;return this.setPositions(c.attributes.position.array),this}}class Pn extends Wa{constructor(r){super({type:"LineMaterial",uniforms:gn.clone(gn.merge([bn.common,bn.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new st(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${Va>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(c){this.uniforms.diffuse.value=c}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(c){c===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(c){this.uniforms.linewidth.value=c}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(c){!!c!="USE_DASH"in this.defines&&(this.needsUpdate=!0),c===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(c){this.uniforms.dashScale.value=c}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(c){this.uniforms.dashSize.value=c}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(c){this.uniforms.dashOffset.value=c}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(c){this.uniforms.gapSize.value=c}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(c){this.uniforms.opacity.value=c}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(c){this.uniforms.resolution.value.copy(c)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(c){!!c!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),c===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(r)}}const ln=new wt,fa=new xe,ha=new xe,Oe=new wt,Be=new wt,lt=new wt,cn=new xe,un=new Or,Ne=new No,ma=new xe,kr=new sr,Cr=new Mn,ct=new wt;let ft,Tt;function pa(l,r,c){return ct.set(0,0,-r,1).applyMatrix4(l.projectionMatrix),ct.multiplyScalar(1/ct.w),ct.x=Tt/c.width,ct.y=Tt/c.height,ct.applyMatrix4(l.projectionMatrixInverse),ct.multiplyScalar(1/ct.w),Math.abs(Math.max(ct.x,ct.y))}function Ci(l,r){const c=l.matrixWorld,u=l.geometry,t=u.attributes.instanceStart,e=u.attributes.instanceEnd,n=Math.min(u.instanceCount,t.count);for(let o=0,a=n;o<a;o++){Ne.start.fromBufferAttribute(t,o),Ne.end.fromBufferAttribute(e,o),Ne.applyMatrix4(c);const s=new xe,i=new xe;ft.distanceSqToSegment(Ne.start,Ne.end,i,s),i.distanceTo(s)<Tt*.5&&r.push({point:i,pointOnLine:s,distance:ft.origin.distanceTo(i),object:l,face:null,faceIndex:o,uv:null,[to]:null})}}function Mi(l,r,c){const u=r.projectionMatrix,e=l.material.resolution,n=l.matrixWorld,o=l.geometry,a=o.attributes.instanceStart,s=o.attributes.instanceEnd,i=Math.min(o.instanceCount,a.count),d=-r.near;ft.at(1,lt),lt.w=1,lt.applyMatrix4(r.matrixWorldInverse),lt.applyMatrix4(u),lt.multiplyScalar(1/lt.w),lt.x*=e.x/2,lt.y*=e.y/2,lt.z=0,cn.copy(lt),un.multiplyMatrices(r.matrixWorldInverse,n);for(let f=0,h=i;f<h;f++){if(Oe.fromBufferAttribute(a,f),Be.fromBufferAttribute(s,f),Oe.w=1,Be.w=1,Oe.applyMatrix4(un),Be.applyMatrix4(un),Oe.z>d&&Be.z>d)continue;if(Oe.z>d){const S=Oe.z-Be.z,x=(Oe.z-d)/S;Oe.lerp(Be,x)}else if(Be.z>d){const S=Be.z-Oe.z,x=(Be.z-d)/S;Be.lerp(Oe,x)}Oe.applyMatrix4(u),Be.applyMatrix4(u),Oe.multiplyScalar(1/Oe.w),Be.multiplyScalar(1/Be.w),Oe.x*=e.x/2,Oe.y*=e.y/2,Be.x*=e.x/2,Be.y*=e.y/2,Ne.start.copy(Oe),Ne.start.z=0,Ne.end.copy(Be),Ne.end.z=0;const p=Ne.closestPointToPointParameter(cn,!0);Ne.at(p,ma);const v=rr.lerp(Oe.z,Be.z,p),E=v>=-1&&v<=1,w=cn.distanceTo(ma)<Tt*.5;if(E&&w){Ne.start.fromBufferAttribute(a,f),Ne.end.fromBufferAttribute(s,f),Ne.start.applyMatrix4(n),Ne.end.applyMatrix4(n);const S=new xe,x=new xe;ft.distanceSqToSegment(Ne.start,Ne.end,x,S),c.push({point:x,pointOnLine:S,distance:ft.origin.distanceTo(x),object:l,face:null,faceIndex:f,uv:null,[to]:null})}}}class no extends Lr{constructor(r=new Tn,c=new Pn({color:Math.random()*16777215})){super(r,c),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const r=this.geometry,c=r.attributes.instanceStart,u=r.attributes.instanceEnd,t=new Float32Array(2*c.count);for(let n=0,o=0,a=c.count;n<a;n++,o+=2)fa.fromBufferAttribute(c,n),ha.fromBufferAttribute(u,n),t[o]=o===0?0:t[o-1],t[o+1]=t[o]+fa.distanceTo(ha);const e=new yn(t,2,1);return r.setAttribute("instanceDistanceStart",new Gt(e,1,0)),r.setAttribute("instanceDistanceEnd",new Gt(e,1,1)),this}raycast(r,c){const u=this.material.worldUnits,t=r.camera;t===null&&!u&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const e=r.params.Line2!==void 0&&r.params.Line2.threshold||0;ft=r.ray;const n=this.matrixWorld,o=this.geometry,a=this.material;Tt=a.linewidth+e,o.boundingSphere===null&&o.computeBoundingSphere(),Cr.copy(o.boundingSphere).applyMatrix4(n);let s;if(u)s=Tt*.5;else{const d=Math.max(t.near,Cr.distanceToPoint(ft.origin));s=pa(t,d,a.resolution)}if(Cr.radius+=s,ft.intersectsSphere(Cr)===!1)return;o.boundingBox===null&&o.computeBoundingBox(),kr.copy(o.boundingBox).applyMatrix4(n);let i;if(u)i=Tt*.5;else{const d=Math.max(t.near,kr.distanceToPoint(ft.origin));i=pa(t,d,a.resolution)}kr.expandByScalar(i),ft.intersectsBox(kr)!==!1&&(u?Ci(this,c):Mi(this,t,c))}onBeforeRender(r){const c=this.material.uniforms;c&&c.resolution&&(r.getViewport(ln),this.material.uniforms.resolution.value.set(ln.z,ln.w))}}class Ai extends no{constructor(r=new ro,c=new Pn({color:Math.random()*16777215})){super(r,c),this.isLine2=!0,this.type="Line2"}}const Ui=b.forwardRef(function({children:r,follow:c=!0,lockX:u=!1,lockY:t=!1,lockZ:e=!1,...n},o){const a=b.useRef(null),s=b.useRef(null),i=new jo;return et(({camera:d})=>{if(!c||!s.current)return;const f=a.current.rotation.clone();s.current.updateMatrix(),s.current.updateWorldMatrix(!1,!1),s.current.getWorldQuaternion(i),d.getWorldQuaternion(a.current.quaternion).premultiply(i.invert()),u&&(a.current.rotation.x=f.x),t&&(a.current.rotation.y=f.y),e&&(a.current.rotation.z=f.z)}),b.useImperativeHandle(o,()=>s.current,[]),b.createElement("group",$e({ref:s},n),b.createElement("group",{ref:a},r))}),ao=b.forwardRef(function({points:r,color:c=16777215,vertexColors:u,linewidth:t,lineWidth:e,segments:n,dashed:o,...a},s){var i,d;const f=ot(E=>E.size),h=b.useMemo(()=>n?new no:new Ai,[n]),[m]=b.useState(()=>new Pn),p=(u==null||(i=u[0])==null?void 0:i.length)===4?4:3,v=b.useMemo(()=>{const E=n?new Tn:new ro,w=r.map(S=>{const x=Array.isArray(S);return S instanceof xe||S instanceof wt?[S.x,S.y,S.z]:S instanceof st?[S.x,S.y,0]:x&&S.length===3?[S[0],S[1],S[2]]:x&&S.length===2?[S[0],S[1],0]:S});if(E.setPositions(w.flat()),u){c=16777215;const S=u.map(x=>x instanceof St?x.toArray():x);E.setColors(S.flat(),p)}return E},[r,n,u,p]);return b.useLayoutEffect(()=>{h.computeLineDistances()},[r,h]),b.useLayoutEffect(()=>{o?m.defines.USE_DASH="":delete m.defines.USE_DASH,m.needsUpdate=!0},[o,m]),b.useEffect(()=>()=>{v.dispose(),m.dispose()},[v]),b.createElement("primitive",$e({object:h,ref:s},a),b.createElement("primitive",{object:v,attach:"geometry"}),b.createElement("primitive",$e({object:m,attach:"material",color:c,vertexColors:!!u,resolution:[f.width,f.height],linewidth:(d=t??e)!==null&&d!==void 0?d:1,dashed:o,transparent:p===4},a)))});function Ei(){var l=Object.create(null);function r(t,e){var n=t.id,o=t.name,a=t.dependencies;a===void 0&&(a=[]);var s=t.init;s===void 0&&(s=function(){});var i=t.getTransferables;if(i===void 0&&(i=null),!l[n])try{a=a.map(function(f){return f&&f.isWorkerModule&&(r(f,function(h){if(h instanceof Error)throw h}),f=l[f.id].value),f}),s=u("<"+o+">.init",s),i&&(i=u("<"+o+">.getTransferables",i));var d=null;typeof s=="function"?d=s.apply(void 0,a):console.error("worker module init function failed to rehydrate"),l[n]={id:n,value:d,getTransferables:i},e(d)}catch(f){f&&f.noLog||console.error(f),e(f)}}function c(t,e){var n,o=t.id,a=t.args;(!l[o]||typeof l[o].value!="function")&&e(new Error("Worker module "+o+": not found or its 'init' did not return a function"));try{var s=(n=l[o]).value.apply(n,a);s&&typeof s.then=="function"?s.then(i,function(d){return e(d instanceof Error?d:new Error(""+d))}):i(s)}catch(d){e(d)}function i(d){try{var f=l[o].getTransferables&&l[o].getTransferables(d);(!f||!Array.isArray(f)||!f.length)&&(f=void 0),e(d,f)}catch(h){console.error(h),e(h)}}}function u(t,e){var n=void 0;self.troikaDefine=function(a){return n=a};var o=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(o)}catch(a){console.error(a)}return URL.revokeObjectURL(o),delete self.troikaDefine,n}self.addEventListener("message",function(t){var e=t.data,n=e.messageId,o=e.action,a=e.data;try{o==="registerModule"&&r(a,function(s){s instanceof Error?postMessage({messageId:n,success:!1,error:s.message}):postMessage({messageId:n,success:!0,result:{isCallable:typeof s=="function"}})}),o==="callModule"&&c(a,function(s,i){s instanceof Error?postMessage({messageId:n,success:!1,error:s.message}):postMessage({messageId:n,success:!0,result:s},i||void 0)})}catch(s){postMessage({messageId:n,success:!1,error:s.stack})}})}function Ti(l){var r=function(){for(var c=[],u=arguments.length;u--;)c[u]=arguments[u];return r._getInitResult().then(function(t){if(typeof t=="function")return t.apply(void 0,c);throw new Error("Worker module function was called but `init` did not return a callable function")})};return r._getInitResult=function(){var c=l.dependencies,u=l.init;c=Array.isArray(c)?c.map(function(e){return e&&(e=e.onMainThread||e,e._getInitResult&&(e=e._getInitResult())),e}):[];var t=Promise.all(c).then(function(e){return u.apply(null,e)});return r._getInitResult=function(){return t},t},r}var oo=function(){var l=!1;if(typeof window<"u"&&typeof window.document<"u")try{var r=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));r.terminate(),l=!0}catch(c){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+c.message+"]")}return oo=function(){return l},l},Pi=0,Fi=0,dn=!1,ar=Object.create(null),or=Object.create(null),Sn=Object.create(null);function jt(l){if((!l||typeof l.init!="function")&&!dn)throw new Error("requires `options.init` function");var r=l.dependencies,c=l.init,u=l.getTransferables,t=l.workerId,e=Ti(l);t==null&&(t="#default");var n="workerModule"+ ++Pi,o=l.name||n,a=null;r=r&&r.map(function(i){return typeof i=="function"&&!i.workerModuleData&&(dn=!0,i=jt({workerId:t,name:"<"+o+"> function dependency: "+i.name,init:`function(){return (
`+Tr(i)+`
)}`}),dn=!1),i&&i.workerModuleData&&(i=i.workerModuleData),i});function s(){for(var i=[],d=arguments.length;d--;)i[d]=arguments[d];if(!oo())return e.apply(void 0,i);if(!a){a=va(t,"registerModule",s.workerModuleData);var f=function(){a=null,or[t].delete(f)};(or[t]||(or[t]=new Set)).add(f)}return a.then(function(h){var m=h.isCallable;if(m)return va(t,"callModule",{id:n,args:i});throw new Error("Worker module function was called but `init` did not return a callable function")})}return s.workerModuleData={isWorkerModule:!0,id:n,name:o,dependencies:r,init:Tr(c),getTransferables:u&&Tr(u)},s.onMainThread=e,s}function Di(l){or[l]&&or[l].forEach(function(r){r()}),ar[l]&&(ar[l].terminate(),delete ar[l])}function Tr(l){var r=l.toString();return!/^function/.test(r)&&/^\w+\s*\(/.test(r)&&(r="function "+r),r}function Ri(l){var r=ar[l];if(!r){var c=Tr(Ei);r=ar[l]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+l.replace(/\*/g,"")+` **/

;(`+c+")()"],{type:"application/javascript"}))),r.onmessage=function(u){var t=u.data,e=t.messageId,n=Sn[e];if(!n)throw new Error("WorkerModule response with empty or unknown messageId");delete Sn[e],n(t)}}return r}function va(l,r,c){return new Promise(function(u,t){var e=++Fi;Sn[e]=function(n){n.success?u(n.result):t(new Error("Error in worker "+r+" call: "+n.error))},Ri(l).postMessage({messageId:e,action:r,data:c})})}function so(){var l=(function(r){function c(N,B,y,k,D,R,P,J){var G=1-P;J.x=G*G*N+2*G*P*y+P*P*D,J.y=G*G*B+2*G*P*k+P*P*R}function u(N,B,y,k,D,R,P,J,G,z){var Z=1-G;z.x=Z*Z*Z*N+3*Z*Z*G*y+3*Z*G*G*D+G*G*G*P,z.y=Z*Z*Z*B+3*Z*Z*G*k+3*Z*G*G*R+G*G*G*J}function t(N,B){for(var y=/([MLQCZ])([^MLQCZ]*)/g,k,D,R,P,J;k=y.exec(N);){var G=k[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(z){return parseFloat(z)});switch(k[1]){case"M":P=D=G[0],J=R=G[1];break;case"L":(G[0]!==P||G[1]!==J)&&B("L",P,J,P=G[0],J=G[1]);break;case"Q":{B("Q",P,J,P=G[2],J=G[3],G[0],G[1]);break}case"C":{B("C",P,J,P=G[4],J=G[5],G[0],G[1],G[2],G[3]);break}case"Z":(P!==D||J!==R)&&B("L",P,J,D,R);break}}}function e(N,B,y){y===void 0&&(y=16);var k={x:0,y:0};t(N,function(D,R,P,J,G,z,Z,q,j){switch(D){case"L":B(R,P,J,G);break;case"Q":{for(var X=R,fe=P,ue=1;ue<y;ue++)c(R,P,z,Z,J,G,ue/(y-1),k),B(X,fe,k.x,k.y),X=k.x,fe=k.y;break}case"C":{for(var ee=R,se=P,oe=1;oe<y;oe++)u(R,P,z,Z,q,j,J,G,oe/(y-1),k),B(ee,se,k.x,k.y),ee=k.x,se=k.y;break}}})}var n="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",a=new WeakMap,s={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function i(N,B){var y=N.getContext?N.getContext("webgl",s):N,k=a.get(y);if(!k){let Z=function(ee){var se=R[ee];if(!se&&(se=R[ee]=y.getExtension(ee),!se))throw new Error(ee+" not supported");return se},q=function(ee,se){var oe=y.createShader(se);return y.shaderSource(oe,ee),y.compileShader(oe),oe},j=function(ee,se,oe,K){if(!P[ee]){var ae={},ne={},H=y.createProgram();y.attachShader(H,q(se,y.VERTEX_SHADER)),y.attachShader(H,q(oe,y.FRAGMENT_SHADER)),y.linkProgram(H),P[ee]={program:H,transaction:function(te){y.useProgram(H),te({setUniform:function($,Se){for(var re=[],le=arguments.length-2;le-- >0;)re[le]=arguments[le+2];var he=ne[Se]||(ne[Se]=y.getUniformLocation(H,Se));y["uniform"+$].apply(y,[he].concat(re))},setAttribute:function($,Se,re,le,he){var ve=ae[$];ve||(ve=ae[$]={buf:y.createBuffer(),loc:y.getAttribLocation(H,$),data:null}),y.bindBuffer(y.ARRAY_BUFFER,ve.buf),y.vertexAttribPointer(ve.loc,Se,y.FLOAT,!1,0,0),y.enableVertexAttribArray(ve.loc),D?y.vertexAttribDivisor(ve.loc,le):Z("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(ve.loc,le),he!==ve.data&&(y.bufferData(y.ARRAY_BUFFER,he,re),ve.data=he)}})}}}P[ee].transaction(K)},X=function(ee,se){G++;try{y.activeTexture(y.TEXTURE0+G);var oe=J[ee];oe||(oe=J[ee]=y.createTexture(),y.bindTexture(y.TEXTURE_2D,oe),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.NEAREST),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.NEAREST)),y.bindTexture(y.TEXTURE_2D,oe),se(oe,G)}finally{G--}},fe=function(ee,se,oe){var K=y.createFramebuffer();z.push(K),y.bindFramebuffer(y.FRAMEBUFFER,K),y.activeTexture(y.TEXTURE0+se),y.bindTexture(y.TEXTURE_2D,ee),y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,ee,0);try{oe(K)}finally{y.deleteFramebuffer(K),y.bindFramebuffer(y.FRAMEBUFFER,z[--z.length-1]||null)}},ue=function(){R={},P={},J={},G=-1,z.length=0};var D=typeof WebGL2RenderingContext<"u"&&y instanceof WebGL2RenderingContext,R={},P={},J={},G=-1,z=[];y.canvas.addEventListener("webglcontextlost",function(ee){ue(),ee.preventDefault()},!1),a.set(y,k={gl:y,isWebGL2:D,getExtension:Z,withProgram:j,withTexture:X,withTextureFramebuffer:fe,handleContextLoss:ue})}B(k)}function d(N,B,y,k,D,R,P,J){P===void 0&&(P=15),J===void 0&&(J=null),i(N,function(G){var z=G.gl,Z=G.withProgram,q=G.withTexture;q("copy",function(j,X){z.texImage2D(z.TEXTURE_2D,0,z.RGBA,D,R,0,z.RGBA,z.UNSIGNED_BYTE,B),Z("copy",n,o,function(fe){var ue=fe.setUniform,ee=fe.setAttribute;ee("aUV",2,z.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ue("1i","image",X),z.bindFramebuffer(z.FRAMEBUFFER,J||null),z.disable(z.BLEND),z.colorMask(P&8,P&4,P&2,P&1),z.viewport(y,k,D,R),z.scissor(y,k,D,R),z.drawArrays(z.TRIANGLES,0,3)})})})}function f(N,B,y){var k=N.width,D=N.height;i(N,function(R){var P=R.gl,J=new Uint8Array(k*D*4);P.readPixels(0,0,k,D,P.RGBA,P.UNSIGNED_BYTE,J),N.width=B,N.height=y,d(P,J,0,0,k,D)})}var h=Object.freeze({__proto__:null,withWebGLContext:i,renderImageData:d,resizeWebGLCanvasWithoutClearing:f});function m(N,B,y,k,D,R){R===void 0&&(R=1);var P=new Uint8Array(N*B),J=k[2]-k[0],G=k[3]-k[1],z=[];e(y,function(ee,se,oe,K){z.push({x1:ee,y1:se,x2:oe,y2:K,minX:Math.min(ee,oe),minY:Math.min(se,K),maxX:Math.max(ee,oe),maxY:Math.max(se,K)})}),z.sort(function(ee,se){return ee.maxX-se.maxX});for(var Z=0;Z<N;Z++)for(var q=0;q<B;q++){var j=fe(k[0]+J*(Z+.5)/N,k[1]+G*(q+.5)/B),X=Math.pow(1-Math.abs(j)/D,R)/2;j<0&&(X=1-X),X=Math.max(0,Math.min(255,Math.round(X*255))),P[q*N+Z]=X}return P;function fe(ee,se){for(var oe=1/0,K=1/0,ae=z.length;ae--;){var ne=z[ae];if(ne.maxX+K<=ee)break;if(ee+K>ne.minX&&se-K<ne.maxY&&se+K>ne.minY){var H=E(ee,se,ne.x1,ne.y1,ne.x2,ne.y2);H<oe&&(oe=H,K=Math.sqrt(oe))}}return ue(ee,se)&&(K=-K),K}function ue(ee,se){for(var oe=0,K=z.length;K--;){var ae=z[K];if(ae.maxX<=ee)break;var ne=ae.y1>se!=ae.y2>se&&ee<(ae.x2-ae.x1)*(se-ae.y1)/(ae.y2-ae.y1)+ae.x1;ne&&(oe+=ae.y1<ae.y2?1:-1)}return oe!==0}}function p(N,B,y,k,D,R,P,J,G,z){R===void 0&&(R=1),J===void 0&&(J=0),G===void 0&&(G=0),z===void 0&&(z=0),v(N,B,y,k,D,R,P,null,J,G,z)}function v(N,B,y,k,D,R,P,J,G,z,Z){R===void 0&&(R=1),G===void 0&&(G=0),z===void 0&&(z=0),Z===void 0&&(Z=0);for(var q=m(N,B,y,k,D,R),j=new Uint8Array(q.length*4),X=0;X<q.length;X++)j[X*4+Z]=q[X];d(P,j,G,z,N,B,1<<3-Z,J)}function E(N,B,y,k,D,R){var P=D-y,J=R-k,G=P*P+J*J,z=G?Math.max(0,Math.min(1,((N-y)*P+(B-k)*J)/G)):0,Z=N-(y+z*P),q=B-(k+z*J);return Z*Z+q*q}var w=Object.freeze({__proto__:null,generate:m,generateIntoCanvas:p,generateIntoFramebuffer:v}),S="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",x="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",A="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",T=new Float32Array([0,0,2,0,0,2]),M=null,U=!1,L={},g=new WeakMap;function O(N){if(!U&&!V(N))throw new Error("WebGL generation not supported")}function _(N,B,y,k,D,R,P){if(R===void 0&&(R=1),P===void 0&&(P=null),!P&&(P=M,!P)){var J=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!J)throw new Error("OffscreenCanvas or DOM canvas not supported");P=M=J.getContext("webgl",{depth:!1})}O(P);var G=new Uint8Array(N*B*4);i(P,function(j){var X=j.gl,fe=j.withTexture,ue=j.withTextureFramebuffer;fe("readable",function(ee,se){X.texImage2D(X.TEXTURE_2D,0,X.RGBA,N,B,0,X.RGBA,X.UNSIGNED_BYTE,null),ue(ee,se,function(oe){F(N,B,y,k,D,R,X,oe,0,0,0),X.readPixels(0,0,N,B,X.RGBA,X.UNSIGNED_BYTE,G)})})});for(var z=new Uint8Array(N*B),Z=0,q=0;Z<G.length;Z+=4)z[q++]=G[Z];return z}function I(N,B,y,k,D,R,P,J,G,z){R===void 0&&(R=1),J===void 0&&(J=0),G===void 0&&(G=0),z===void 0&&(z=0),F(N,B,y,k,D,R,P,null,J,G,z)}function F(N,B,y,k,D,R,P,J,G,z,Z){R===void 0&&(R=1),G===void 0&&(G=0),z===void 0&&(z=0),Z===void 0&&(Z=0),O(P);var q=[];e(y,function(j,X,fe,ue){q.push(j,X,fe,ue)}),q=new Float32Array(q),i(P,function(j){var X=j.gl,fe=j.isWebGL2,ue=j.getExtension,ee=j.withProgram,se=j.withTexture,oe=j.withTextureFramebuffer,K=j.handleContextLoss;if(se("rawDistances",function(ae,ne){(N!==ae._lastWidth||B!==ae._lastHeight)&&X.texImage2D(X.TEXTURE_2D,0,X.RGBA,ae._lastWidth=N,ae._lastHeight=B,0,X.RGBA,X.UNSIGNED_BYTE,null),ee("main",S,x,function(H){var pe=H.setAttribute,te=H.setUniform,ie=!fe&&ue("ANGLE_instanced_arrays"),$=!fe&&ue("EXT_blend_minmax");pe("aUV",2,X.STATIC_DRAW,0,T),pe("aLineSegment",4,X.DYNAMIC_DRAW,1,q),te.apply(void 0,["4f","uGlyphBounds"].concat(k)),te("1f","uMaxDistance",D),te("1f","uExponent",R),oe(ae,ne,function(Se){X.enable(X.BLEND),X.colorMask(!0,!0,!0,!0),X.viewport(0,0,N,B),X.scissor(0,0,N,B),X.blendFunc(X.ONE,X.ONE),X.blendEquationSeparate(X.FUNC_ADD,fe?X.MAX:$.MAX_EXT),X.clear(X.COLOR_BUFFER_BIT),fe?X.drawArraysInstanced(X.TRIANGLES,0,3,q.length/4):ie.drawArraysInstancedANGLE(X.TRIANGLES,0,3,q.length/4)})}),ee("post",n,A,function(H){H.setAttribute("aUV",2,X.STATIC_DRAW,0,T),H.setUniform("1i","tex",ne),X.bindFramebuffer(X.FRAMEBUFFER,J),X.disable(X.BLEND),X.colorMask(Z===0,Z===1,Z===2,Z===3),X.viewport(G,z,N,B),X.scissor(G,z,N,B),X.drawArrays(X.TRIANGLES,0,3)})}),X.isContextLost())throw K(),new Error("webgl context lost")})}function V(N){var B=!N||N===M?L:N.canvas||N,y=g.get(B);if(y===void 0){U=!0;var k=null;try{var D=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],R=_(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,N);y=R&&D.length===R.length&&R.every(function(P,J){return P===D[J]}),y||(k="bad trial run results",console.info(D,R))}catch(P){y=!1,k=P.message}k&&console.warn("WebGL SDF generation not supported:",k),U=!1,g.set(B,y)}return y}var Y=Object.freeze({__proto__:null,generate:_,generateIntoCanvas:I,generateIntoFramebuffer:F,isSupported:V});function Q(N,B,y,k,D,R){D===void 0&&(D=Math.max(k[2]-k[0],k[3]-k[1])/2),R===void 0&&(R=1);try{return _.apply(Y,arguments)}catch(P){return console.info("WebGL SDF generation failed, falling back to JS",P),m.apply(w,arguments)}}function W(N,B,y,k,D,R,P,J,G,z){D===void 0&&(D=Math.max(k[2]-k[0],k[3]-k[1])/2),R===void 0&&(R=1),J===void 0&&(J=0),G===void 0&&(G=0),z===void 0&&(z=0);try{return I.apply(Y,arguments)}catch(Z){return console.info("WebGL SDF generation failed, falling back to JS",Z),p.apply(w,arguments)}}return r.forEachPathCommand=t,r.generate=Q,r.generateIntoCanvas=W,r.javascript=w,r.pathToLineSegments=e,r.webgl=Y,r.webglUtils=h,Object.defineProperty(r,"__esModule",{value:!0}),r})({});return l}function Ii(){var l=(function(r){var c={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},u={},t={};u.L=1,t[1]="L",Object.keys(c).forEach(function(K,ae){u[K]=1<<ae+1,t[u[K]]=K}),Object.freeze(u);var e=u.LRI|u.RLI|u.FSI,n=u.L|u.R|u.AL,o=u.B|u.S|u.WS|u.ON|u.FSI|u.LRI|u.RLI|u.PDI,a=u.BN|u.RLE|u.LRE|u.RLO|u.LRO|u.PDF,s=u.S|u.WS|u.B|e|u.PDI|a,i=null;function d(){if(!i){i=new Map;var K=function(ne){if(c.hasOwnProperty(ne)){var H=0;c[ne].split(",").forEach(function(pe){var te=pe.split("+"),ie=te[0],$=te[1];ie=parseInt(ie,36),$=$?parseInt($,36):0,i.set(H+=ie,u[ne]);for(var Se=0;Se<$;Se++)i.set(++H,u[ne])})}};for(var ae in c)K(ae)}}function f(K){return d(),i.get(K.codePointAt(0))||u.L}function h(K){return t[f(K)]}var m={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function p(K,ae){var ne=36,H=0,pe=new Map,te=ae&&new Map,ie;return K.split(",").forEach(function $(Se){if(Se.indexOf("+")!==-1)for(var re=+Se;re--;)$(ie);else{ie=Se;var le=Se.split(">"),he=le[0],ve=le[1];he=String.fromCodePoint(H+=parseInt(he,ne)),ve=String.fromCodePoint(H+=parseInt(ve,ne)),pe.set(he,ve),ae&&te.set(ve,he)}}),{map:pe,reverseMap:te}}var v,E,w;function S(){if(!v){var K=p(m.pairs,!0),ae=K.map,ne=K.reverseMap;v=ae,E=ne,w=p(m.canonical,!1).map}}function x(K){return S(),v.get(K)||null}function A(K){return S(),E.get(K)||null}function T(K){return S(),w.get(K)||null}var M=u.L,U=u.R,L=u.EN,g=u.ES,O=u.ET,_=u.AN,I=u.CS,F=u.B,V=u.S,Y=u.ON,Q=u.BN,W=u.NSM,N=u.AL,B=u.LRO,y=u.RLO,k=u.LRE,D=u.RLE,R=u.PDF,P=u.LRI,J=u.RLI,G=u.FSI,z=u.PDI;function Z(K,ae){for(var ne=125,H=new Uint32Array(K.length),pe=0;pe<K.length;pe++)H[pe]=f(K[pe]);var te=new Map;function ie(Ye,nt){var Je=H[Ye];H[Ye]=nt,te.set(Je,te.get(Je)-1),Je&o&&te.set(o,te.get(o)-1),te.set(nt,(te.get(nt)||0)+1),nt&o&&te.set(o,(te.get(o)||0)+1)}for(var $=new Uint8Array(K.length),Se=new Map,re=[],le=null,he=0;he<K.length;he++)le||re.push(le={start:he,end:K.length-1,level:ae==="rtl"?1:ae==="ltr"?0:ra(he,!1)}),H[he]&F&&(le.end=he,le=null);for(var ve=D|k|y|B|e|z|R|F,Ae=function(Ye){return Ye+(Ye&1?1:2)},Fe=function(Ye){return Ye+(Ye&1?2:1)},ge=0;ge<re.length;ge++){le=re[ge];var be=[{_level:le.level,_override:0,_isolate:0}],de=void 0,De=0,Ee=0,Xe=0;te.clear();for(var Ue=le.start;Ue<=le.end;Ue++){var me=H[Ue];if(de=be[be.length-1],te.set(me,(te.get(me)||0)+1),me&o&&te.set(o,(te.get(o)||0)+1),me&ve)if(me&(D|k)){$[Ue]=de._level;var ke=(me===D?Fe:Ae)(de._level);ke<=ne&&!De&&!Ee?be.push({_level:ke,_override:0,_isolate:0}):De||Ee++}else if(me&(y|B)){$[Ue]=de._level;var yt=(me===y?Fe:Ae)(de._level);yt<=ne&&!De&&!Ee?be.push({_level:yt,_override:me&y?U:M,_isolate:0}):De||Ee++}else if(me&e){me&G&&(me=ra(Ue+1,!0)===1?J:P),$[Ue]=de._level,de._override&&ie(Ue,de._override);var Ce=(me===J?Fe:Ae)(de._level);Ce<=ne&&De===0&&Ee===0?(Xe++,be.push({_level:Ce,_override:0,_isolate:1,_isolInitIndex:Ue})):De++}else if(me&z){if(De>0)De--;else if(Xe>0){for(Ee=0;!be[be.length-1]._isolate;)be.pop();var _e=be[be.length-1]._isolInitIndex;_e!=null&&(Se.set(_e,Ue),Se.set(Ue,_e)),be.pop(),Xe--}de=be[be.length-1],$[Ue]=de._level,de._override&&ie(Ue,de._override)}else me&R?(De===0&&(Ee>0?Ee--:!de._isolate&&be.length>1&&(be.pop(),de=be[be.length-1])),$[Ue]=de._level):me&F&&($[Ue]=le.level);else $[Ue]=de._level,de._override&&me!==Q&&ie(Ue,de._override)}for(var Re=[],Te=null,ye=le.start;ye<=le.end;ye++){var Pe=H[ye];if(!(Pe&a)){var He=$[ye],je=Pe&e,Ie=Pe===z;Te&&He===Te._level?(Te._end=ye,Te._endsWithIsolInit=je):Re.push(Te={_start:ye,_end:ye,_level:He,_startsWithPDI:Ie,_endsWithIsolInit:je})}}for(var tt=[],gt=0;gt<Re.length;gt++){var ht=Re[gt];if(!ht._startsWithPDI||ht._startsWithPDI&&!Se.has(ht._start)){for(var bt=[Te=ht],Ct=void 0;Te&&Te._endsWithIsolInit&&(Ct=Se.get(Te._end))!=null;)for(var mt=gt+1;mt<Re.length;mt++)if(Re[mt]._start===Ct){bt.push(Te=Re[mt]);break}for(var Ve=[],Mt=0;Mt<bt.length;Mt++)for(var Ln=bt[Mt],jr=Ln._start;jr<=Ln._end;jr++)Ve.push(jr);for(var ko=$[Ve[0]],On=le.level,lr=Ve[0]-1;lr>=0;lr--)if(!(H[lr]&a)){On=$[lr];break}var Wr=Ve[Ve.length-1],Co=$[Wr],Bn=le.level;if(!(H[Wr]&e)){for(var cr=Wr+1;cr<=le.end;cr++)if(!(H[cr]&a)){Bn=$[cr];break}}tt.push({_seqIndices:Ve,_sosType:Math.max(On,ko)%2?U:M,_eosType:Math.max(Bn,Co)%2?U:M})}}for(var zr=0;zr<tt.length;zr++){var Hr=tt[zr],ce=Hr._seqIndices,Wt=Hr._sosType,Mo=Hr._eosType,Rt=$[ce[0]]&1?U:M;if(te.get(W))for(var ur=0;ur<ce.length;ur++){var Gn=ce[ur];if(H[Gn]&W){for(var Vr=Wt,dr=ur-1;dr>=0;dr--)if(!(H[ce[dr]]&a)){Vr=H[ce[dr]];break}ie(Gn,Vr&(e|z)?Y:Vr)}}if(te.get(L))for(var fr=0;fr<ce.length;fr++){var Nn=ce[fr];if(H[Nn]&L)for(var hr=fr-1;hr>=-1;hr--){var jn=hr===-1?Wt:H[ce[hr]];if(jn&n){jn===N&&ie(Nn,_);break}}}if(te.get(N))for(var Xr=0;Xr<ce.length;Xr++){var Wn=ce[Xr];H[Wn]&N&&ie(Wn,U)}if(te.get(g)||te.get(I))for(var zt=1;zt<ce.length-1;zt++){var Yr=ce[zt];if(H[Yr]&(g|I)){for(var It=0,Jr=0,Kr=zt-1;Kr>=0&&(It=H[ce[Kr]],!!(It&a));Kr--);for(var Qr=zt+1;Qr<ce.length&&(Jr=H[ce[Qr]],!!(Jr&a));Qr++);It===Jr&&(H[Yr]===g?It===L:It&(L|_))&&ie(Yr,It)}}if(te.get(L))for(var it=0;it<ce.length;it++){var Ao=ce[it];if(H[Ao]&L){for(var mr=it-1;mr>=0&&H[ce[mr]]&(O|a);mr--)ie(ce[mr],L);for(it++;it<ce.length&&H[ce[it]]&(O|a|L);it++)H[ce[it]]!==L&&ie(ce[it],L)}}if(te.get(O)||te.get(g)||te.get(I))for(var Ht=0;Ht<ce.length;Ht++){var zn=ce[Ht];if(H[zn]&(O|g|I)){ie(zn,Y);for(var pr=Ht-1;pr>=0&&H[ce[pr]]&a;pr--)ie(ce[pr],Y);for(var vr=Ht+1;vr<ce.length&&H[ce[vr]]&a;vr++)ie(ce[vr],Y)}}if(te.get(L))for(var qr=0,Hn=Wt;qr<ce.length;qr++){var Vn=ce[qr],Zr=H[Vn];Zr&L?Hn===M&&ie(Vn,M):Zr&n&&(Hn=Zr)}if(te.get(o)){var Vt=U|L|_,Xn=Vt|M,yr=[];{for(var Lt=[],Ot=0;Ot<ce.length;Ot++)if(H[ce[Ot]]&o){var Xt=K[ce[Ot]],Yn=void 0;if(x(Xt)!==null)if(Lt.length<63)Lt.push({char:Xt,seqIndex:Ot});else break;else if((Yn=A(Xt))!==null)for(var Yt=Lt.length-1;Yt>=0;Yt--){var $r=Lt[Yt].char;if($r===Yn||$r===A(T(Xt))||x(T($r))===Xt){yr.push([Lt[Yt].seqIndex,Ot]),Lt.length=Yt;break}}}yr.sort(function(Ye,nt){return Ye[0]-nt[0]})}for(var en=0;en<yr.length;en++){for(var Jn=yr[en],gr=Jn[0],tn=Jn[1],Kn=!1,rt=0,rn=gr+1;rn<tn;rn++){var Qn=ce[rn];if(H[Qn]&Xn){Kn=!0;var qn=H[Qn]&Vt?U:M;if(qn===Rt){rt=qn;break}}}if(Kn&&!rt){rt=Wt;for(var nn=gr-1;nn>=0;nn--){var Zn=ce[nn];if(H[Zn]&Xn){var $n=H[Zn]&Vt?U:M;$n!==Rt?rt=$n:rt=Rt;break}}}if(rt){if(H[ce[gr]]=H[ce[tn]]=rt,rt!==Rt){for(var Jt=gr+1;Jt<ce.length;Jt++)if(!(H[ce[Jt]]&a)){f(K[ce[Jt]])&W&&(H[ce[Jt]]=rt);break}}if(rt!==Rt){for(var Kt=tn+1;Kt<ce.length;Kt++)if(!(H[ce[Kt]]&a)){f(K[ce[Kt]])&W&&(H[ce[Kt]]=rt);break}}}}for(var xt=0;xt<ce.length;xt++)if(H[ce[xt]]&o){for(var ea=xt,an=xt,on=Wt,Qt=xt-1;Qt>=0;Qt--)if(H[ce[Qt]]&a)ea=Qt;else{on=H[ce[Qt]]&Vt?U:M;break}for(var ta=Mo,qt=xt+1;qt<ce.length;qt++)if(H[ce[qt]]&(o|a))an=qt;else{ta=H[ce[qt]]&Vt?U:M;break}for(var sn=ea;sn<=an;sn++)H[ce[sn]]=on===ta?on:Rt;xt=an}}}for(var qe=le.start;qe<=le.end;qe++){var Uo=$[qe],br=H[qe];if(Uo&1?br&(M|L|_)&&$[qe]++:br&U?$[qe]++:br&(_|L)&&($[qe]+=2),br&a&&($[qe]=qe===0?le.level:$[qe-1]),qe===le.end||f(K[qe])&(V|F))for(var xr=qe;xr>=0&&f(K[xr])&s;xr--)$[xr]=le.level}}return{levels:$,paragraphs:re};function ra(Ye,nt){for(var Je=Ye;Je<K.length;Je++){var _t=H[Je];if(_t&(U|N))return 1;if(_t&(F|M)||nt&&_t===z)return 0;if(_t&e){var na=Eo(Je);Je=na===-1?K.length:na}}return 0}function Eo(Ye){for(var nt=1,Je=Ye+1;Je<K.length;Je++){var _t=H[Je];if(_t&F)break;if(_t&z){if(--nt===0)return Je}else _t&e&&nt++}return-1}}var q="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",j;function X(){if(!j){var K=p(q,!0),ae=K.map,ne=K.reverseMap;ne.forEach(function(H,pe){ae.set(pe,H)}),j=ae}}function fe(K){return X(),j.get(K)||null}function ue(K,ae,ne,H){var pe=K.length;ne=Math.max(0,ne==null?0:+ne),H=Math.min(pe-1,H==null?pe-1:+H);for(var te=new Map,ie=ne;ie<=H;ie++)if(ae[ie]&1){var $=fe(K[ie]);$!==null&&te.set(ie,$)}return te}function ee(K,ae,ne,H){var pe=K.length;ne=Math.max(0,ne==null?0:+ne),H=Math.min(pe-1,H==null?pe-1:+H);var te=[];return ae.paragraphs.forEach(function(ie){var $=Math.max(ne,ie.start),Se=Math.min(H,ie.end);if($<Se){for(var re=ae.levels.slice($,Se+1),le=Se;le>=$&&f(K[le])&s;le--)re[le]=ie.level;for(var he=ie.level,ve=1/0,Ae=0;Ae<re.length;Ae++){var Fe=re[Ae];Fe>he&&(he=Fe),Fe<ve&&(ve=Fe|1)}for(var ge=he;ge>=ve;ge--)for(var be=0;be<re.length;be++)if(re[be]>=ge){for(var de=be;be+1<re.length&&re[be+1]>=ge;)be++;be>de&&te.push([de+$,be+$])}}}),te}function se(K,ae,ne,H){var pe=oe(K,ae,ne,H),te=[].concat(K);return pe.forEach(function(ie,$){te[$]=(ae.levels[ie]&1?fe(K[ie]):null)||K[ie]}),te.join("")}function oe(K,ae,ne,H){for(var pe=ee(K,ae,ne,H),te=[],ie=0;ie<K.length;ie++)te[ie]=ie;return pe.forEach(function($){for(var Se=$[0],re=$[1],le=te.slice(Se,re+1),he=le.length;he--;)te[re-he]=le[he]}),te}return r.closingToOpeningBracket=A,r.getBidiCharType=f,r.getBidiCharTypeName=h,r.getCanonicalBracket=T,r.getEmbeddingLevels=Z,r.getMirroredCharacter=fe,r.getMirroredCharactersMap=ue,r.getReorderSegments=ee,r.getReorderedIndices=oe,r.getReorderedString=se,r.openingToClosingBracket=x,Object.defineProperty(r,"__esModule",{value:!0}),r})({});return l}const io=/\bvoid\s+main\s*\(\s*\)\s*{/g;function wn(l){const r=/^[ \t]*#include +<([\w\d./]+)>/gm;function c(u,t){let e=Vo[t];return e?wn(e):u}return l.replace(r,c)}const Ge=[];for(let l=0;l<256;l++)Ge[l]=(l<16?"0":"")+l.toString(16);function Li(){const l=Math.random()*4294967295|0,r=Math.random()*4294967295|0,c=Math.random()*4294967295|0,u=Math.random()*4294967295|0;return(Ge[l&255]+Ge[l>>8&255]+Ge[l>>16&255]+Ge[l>>24&255]+"-"+Ge[r&255]+Ge[r>>8&255]+"-"+Ge[r>>16&15|64]+Ge[r>>24&255]+"-"+Ge[c&63|128]+Ge[c>>8&255]+"-"+Ge[c>>16&255]+Ge[c>>24&255]+Ge[u&255]+Ge[u>>8&255]+Ge[u>>16&255]+Ge[u>>24&255]).toUpperCase()}const At=Object.assign||function(){let l=arguments[0];for(let r=1,c=arguments.length;r<c;r++){let u=arguments[r];if(u)for(let t in u)Object.prototype.hasOwnProperty.call(u,t)&&(l[t]=u[t])}return l},Oi=Date.now(),ya=new WeakMap,ga=new Map;let Bi=1e10;function kn(l,r){const c=Wi(r);let u=ya.get(l);if(u||ya.set(l,u=Object.create(null)),u[c])return new u[c];const t=`_onBeforeCompile${c}`,e=function(s,i){l.onBeforeCompile.call(this,s,i);const d=this.customProgramCacheKey()+"|"+s.vertexShader+"|"+s.fragmentShader;let f=ga[d];if(!f){const h=Gi(this,s,r,c);f=ga[d]=h}s.vertexShader=f.vertexShader,s.fragmentShader=f.fragmentShader,At(s.uniforms,this.uniforms),r.timeUniform&&(s.uniforms[r.timeUniform]={get value(){return Date.now()-Oi}}),this[t]&&this[t](s)},n=function(){return o(r.chained?l:l.clone())},o=function(s){const i=Object.create(s,a);return Object.defineProperty(i,"baseMaterial",{value:l}),Object.defineProperty(i,"id",{value:Bi++}),i.uuid=Li(),i.uniforms=At({},s.uniforms,r.uniforms),i.defines=At({},s.defines,r.defines),i.defines[`TROIKA_DERIVED_MATERIAL_${c}`]="",i.extensions=At({},s.extensions,r.extensions),i._listeners=void 0,i},a={constructor:{value:n},isDerivedMaterial:{value:!0},type:{get:()=>l.type,set:s=>{l.type=s}},isDerivedFrom:{writable:!0,configurable:!0,value:function(s){const i=this.baseMaterial;return s===i||i.isDerivedMaterial&&i.isDerivedFrom(s)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return l.customProgramCacheKey()+"|"+c}},onBeforeCompile:{get(){return e},set(s){this[t]=s}},copy:{writable:!0,configurable:!0,value:function(s){return l.copy.call(this,s),!l.isShaderMaterial&&!l.isDerivedMaterial&&(At(this.extensions,s.extensions),At(this.defines,s.defines),At(this.uniforms,gn.clone(s.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const s=new l.constructor;return o(s).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let s=this._depthMaterial;return s||(s=this._depthMaterial=kn(l.isDerivedMaterial?l.getDepthMaterial():new zo({depthPacking:Ho}),r),s.defines.IS_DEPTH_MATERIAL="",s.uniforms=this.uniforms),s}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let s=this._distanceMaterial;return s||(s=this._distanceMaterial=kn(l.isDerivedMaterial?l.getDistanceMaterial():new Wo,r),s.defines.IS_DISTANCE_MATERIAL="",s.uniforms=this.uniforms),s}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:s,_distanceMaterial:i}=this;s&&s.dispose(),i&&i.dispose(),l.dispose.call(this)}}};return u[c]=n,new n}function Gi(l,{vertexShader:r,fragmentShader:c},u,t){let{vertexDefs:e,vertexMainIntro:n,vertexMainOutro:o,vertexTransform:a,fragmentDefs:s,fragmentMainIntro:i,fragmentMainOutro:d,fragmentColorTransform:f,customRewriter:h,timeUniform:m}=u;if(e=e||"",n=n||"",o=o||"",s=s||"",i=i||"",d=d||"",(a||h)&&(r=wn(r)),(f||h)&&(c=c.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),c=wn(c)),h){let p=h({vertexShader:r,fragmentShader:c});r=p.vertexShader,c=p.fragmentShader}if(f){let p=[];c=c.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,v=>(p.push(v),"")),d=`${f}
${p.join(`
`)}
${d}`}if(m){const p=`
uniform float ${m};
`;e=p+e,s=p+s}return a&&(r=`vec3 troika_position_${t};
vec3 troika_normal_${t};
vec2 troika_uv_${t};
${r}
`,e=`${e}
void troikaVertexTransform${t}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${a}
}
`,n=`
troika_position_${t} = vec3(position);
troika_normal_${t} = vec3(normal);
troika_uv_${t} = vec2(uv);
troikaVertexTransform${t}(troika_position_${t}, troika_normal_${t}, troika_uv_${t});
${n}
`,r=r.replace(/\b(position|normal|uv)\b/g,(p,v,E,w)=>/\battribute\s+vec[23]\s+$/.test(w.substr(0,E))?v:`troika_${v}_${t}`),l.map&&l.map.channel>0||(r=r.replace(/\bMAP_UV\b/g,`troika_uv_${t}`))),r=ba(r,t,e,n,o),c=ba(c,t,s,i,d),{vertexShader:r,fragmentShader:c}}function ba(l,r,c,u,t){return(u||t||c)&&(l=l.replace(io,`
${c}
void troikaOrigMain${r}() {`),l+=`
void main() {
  ${u}
  troikaOrigMain${r}();
  ${t}
}`),l}function Ni(l,r){return l==="uniforms"?void 0:typeof r=="function"?r.toString():r}let ji=0;const xa=new Map;function Wi(l){const r=JSON.stringify(l,Ni);let c=xa.get(r);return c==null&&xa.set(r,c=++ji),c}function zi(){return typeof window>"u"&&(self.window=self),(function(l){var r={parse:function(t){var e=r._bin,n=new Uint8Array(t);if(e.readASCII(n,0,4)=="ttcf"){var o=4;e.readUshort(n,o),o+=2,e.readUshort(n,o),o+=2;var a=e.readUint(n,o);o+=4;for(var s=[],i=0;i<a;i++){var d=e.readUint(n,o);o+=4,s.push(r._readFont(n,d))}return s}return[r._readFont(n,0)]},_readFont:function(t,e){var n=r._bin,o=e;n.readFixed(t,e),e+=4;var a=n.readUshort(t,e);e+=2,n.readUshort(t,e),e+=2,n.readUshort(t,e),e+=2,n.readUshort(t,e),e+=2;for(var s=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],i={_data:t,_offset:o},d={},f=0;f<a;f++){var h=n.readASCII(t,e,4);e+=4,n.readUint(t,e),e+=4;var m=n.readUint(t,e);e+=4;var p=n.readUint(t,e);e+=4,d[h]={offset:m,length:p}}for(f=0;f<s.length;f++){var v=s[f];d[v]&&(i[v.trim()]=r[v.trim()].parse(t,d[v].offset,d[v].length,i))}return i},_tabOffset:function(t,e,n){for(var o=r._bin,a=o.readUshort(t,n+4),s=n+12,i=0;i<a;i++){var d=o.readASCII(t,s,4);s+=4,o.readUint(t,s),s+=4;var f=o.readUint(t,s);if(s+=4,o.readUint(t,s),s+=4,d==e)return f}return 0}};r._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,e){return r._bin.readShort(t,e)/16384},readInt:function(t,e){return r._bin._view(t).getInt32(e)},readInt8:function(t,e){return r._bin._view(t).getInt8(e)},readShort:function(t,e){return r._bin._view(t).getInt16(e)},readUshort:function(t,e){return r._bin._view(t).getUint16(e)},readUshorts:function(t,e,n){for(var o=[],a=0;a<n;a++)o.push(r._bin.readUshort(t,e+2*a));return o},readUint:function(t,e){return r._bin._view(t).getUint32(e)},readUint64:function(t,e){return 4294967296*r._bin.readUint(t,e)+r._bin.readUint(t,e+4)},readASCII:function(t,e,n){for(var o="",a=0;a<n;a++)o+=String.fromCharCode(t[e+a]);return o},readUnicode:function(t,e,n){for(var o="",a=0;a<n;a++){var s=t[e++]<<8|t[e++];o+=String.fromCharCode(s)}return o},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,e,n){var o=r._bin._tdec;return o&&e==0&&n==t.length?o.decode(t):r._bin.readASCII(t,e,n)},readBytes:function(t,e,n){for(var o=[],a=0;a<n;a++)o.push(t[e+a]);return o},readASCIIArray:function(t,e,n){for(var o=[],a=0;a<n;a++)o.push(String.fromCharCode(t[e+a]));return o},_view:function(t){return t._dataView||(t._dataView=t.buffer?new DataView(t.buffer,t.byteOffset,t.byteLength):new DataView(new Uint8Array(t).buffer))}},r._lctf={},r._lctf.parse=function(t,e,n,o,a){var s=r._bin,i={},d=e;s.readFixed(t,e),e+=4;var f=s.readUshort(t,e);e+=2;var h=s.readUshort(t,e);e+=2;var m=s.readUshort(t,e);return e+=2,i.scriptList=r._lctf.readScriptList(t,d+f),i.featureList=r._lctf.readFeatureList(t,d+h),i.lookupList=r._lctf.readLookupList(t,d+m,a),i},r._lctf.readLookupList=function(t,e,n){var o=r._bin,a=e,s=[],i=o.readUshort(t,e);e+=2;for(var d=0;d<i;d++){var f=o.readUshort(t,e);e+=2;var h=r._lctf.readLookupTable(t,a+f,n);s.push(h)}return s},r._lctf.readLookupTable=function(t,e,n){var o=r._bin,a=e,s={tabs:[]};s.ltype=o.readUshort(t,e),e+=2,s.flag=o.readUshort(t,e),e+=2;var i=o.readUshort(t,e);e+=2;for(var d=s.ltype,f=0;f<i;f++){var h=o.readUshort(t,e);e+=2;var m=n(t,d,a+h,s);s.tabs.push(m)}return s},r._lctf.numOfOnes=function(t){for(var e=0,n=0;n<32;n++)(t>>>n&1)!=0&&e++;return e},r._lctf.readClassDef=function(t,e){var n=r._bin,o=[],a=n.readUshort(t,e);if(e+=2,a==1){var s=n.readUshort(t,e);e+=2;var i=n.readUshort(t,e);e+=2;for(var d=0;d<i;d++)o.push(s+d),o.push(s+d),o.push(n.readUshort(t,e)),e+=2}if(a==2){var f=n.readUshort(t,e);for(e+=2,d=0;d<f;d++)o.push(n.readUshort(t,e)),e+=2,o.push(n.readUshort(t,e)),e+=2,o.push(n.readUshort(t,e)),e+=2}return o},r._lctf.getInterval=function(t,e){for(var n=0;n<t.length;n+=3){var o=t[n],a=t[n+1];if(t[n+2],o<=e&&e<=a)return n}return-1},r._lctf.readCoverage=function(t,e){var n=r._bin,o={};o.fmt=n.readUshort(t,e),e+=2;var a=n.readUshort(t,e);return e+=2,o.fmt==1&&(o.tab=n.readUshorts(t,e,a)),o.fmt==2&&(o.tab=n.readUshorts(t,e,3*a)),o},r._lctf.coverageIndex=function(t,e){var n=t.tab;if(t.fmt==1)return n.indexOf(e);if(t.fmt==2){var o=r._lctf.getInterval(n,e);if(o!=-1)return n[o+2]+(e-n[o])}return-1},r._lctf.readFeatureList=function(t,e){var n=r._bin,o=e,a=[],s=n.readUshort(t,e);e+=2;for(var i=0;i<s;i++){var d=n.readASCII(t,e,4);e+=4;var f=n.readUshort(t,e);e+=2;var h=r._lctf.readFeatureTable(t,o+f);h.tag=d.trim(),a.push(h)}return a},r._lctf.readFeatureTable=function(t,e){var n=r._bin,o=e,a={},s=n.readUshort(t,e);e+=2,s>0&&(a.featureParams=o+s);var i=n.readUshort(t,e);e+=2,a.tab=[];for(var d=0;d<i;d++)a.tab.push(n.readUshort(t,e+2*d));return a},r._lctf.readScriptList=function(t,e){var n=r._bin,o=e,a={},s=n.readUshort(t,e);e+=2;for(var i=0;i<s;i++){var d=n.readASCII(t,e,4);e+=4;var f=n.readUshort(t,e);e+=2,a[d.trim()]=r._lctf.readScriptTable(t,o+f)}return a},r._lctf.readScriptTable=function(t,e){var n=r._bin,o=e,a={},s=n.readUshort(t,e);e+=2,s>0&&(a.default=r._lctf.readLangSysTable(t,o+s));var i=n.readUshort(t,e);e+=2;for(var d=0;d<i;d++){var f=n.readASCII(t,e,4);e+=4;var h=n.readUshort(t,e);e+=2,a[f.trim()]=r._lctf.readLangSysTable(t,o+h)}return a},r._lctf.readLangSysTable=function(t,e){var n=r._bin,o={};n.readUshort(t,e),e+=2,o.reqFeature=n.readUshort(t,e),e+=2;var a=n.readUshort(t,e);return e+=2,o.features=n.readUshorts(t,e,a),o},r.CFF={},r.CFF.parse=function(t,e,n){var o=r._bin;(t=new Uint8Array(t.buffer,e,n))[e=0],t[++e],t[++e],t[++e],e++;var a=[];e=r.CFF.readIndex(t,e,a);for(var s=[],i=0;i<a.length-1;i++)s.push(o.readASCII(t,e+a[i],a[i+1]-a[i]));e+=a[a.length-1];var d=[];e=r.CFF.readIndex(t,e,d);var f=[];for(i=0;i<d.length-1;i++)f.push(r.CFF.readDict(t,e+d[i],e+d[i+1]));e+=d[d.length-1];var h=f[0],m=[];e=r.CFF.readIndex(t,e,m);var p=[];for(i=0;i<m.length-1;i++)p.push(o.readASCII(t,e+m[i],m[i+1]-m[i]));if(e+=m[m.length-1],r.CFF.readSubrs(t,e,h),h.CharStrings){e=h.CharStrings,m=[],e=r.CFF.readIndex(t,e,m);var v=[];for(i=0;i<m.length-1;i++)v.push(o.readBytes(t,e+m[i],m[i+1]-m[i]));h.CharStrings=v}if(h.ROS){e=h.FDArray;var E=[];for(e=r.CFF.readIndex(t,e,E),h.FDArray=[],i=0;i<E.length-1;i++){var w=r.CFF.readDict(t,e+E[i],e+E[i+1]);r.CFF._readFDict(t,w,p),h.FDArray.push(w)}e+=E[E.length-1],e=h.FDSelect,h.FDSelect=[];var S=t[e];if(e++,S!=3)throw S;var x=o.readUshort(t,e);for(e+=2,i=0;i<x+1;i++)h.FDSelect.push(o.readUshort(t,e),t[e+2]),e+=3}return h.Encoding&&(h.Encoding=r.CFF.readEncoding(t,h.Encoding,h.CharStrings.length)),h.charset&&(h.charset=r.CFF.readCharset(t,h.charset,h.CharStrings.length)),r.CFF._readFDict(t,h,p),h},r.CFF._readFDict=function(t,e,n){var o;for(var a in e.Private&&(o=e.Private[1],e.Private=r.CFF.readDict(t,o,o+e.Private[0]),e.Private.Subrs&&r.CFF.readSubrs(t,o+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(a)!=-1&&(e[a]=n[e[a]-426+35])},r.CFF.readSubrs=function(t,e,n){var o=r._bin,a=[];e=r.CFF.readIndex(t,e,a);var s,i=a.length;s=i<1240?107:i<33900?1131:32768,n.Bias=s,n.Subrs=[];for(var d=0;d<a.length-1;d++)n.Subrs.push(o.readBytes(t,e+a[d],a[d+1]-a[d]))},r.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],r.CFF.glyphByUnicode=function(t,e){for(var n=0;n<t.charset.length;n++)if(t.charset[n]==e)return n;return-1},r.CFF.glyphBySE=function(t,e){return e<0||e>255?-1:r.CFF.glyphByUnicode(t,r.CFF.tableSE[e])},r.CFF.readEncoding=function(t,e,n){r._bin;var o=[".notdef"],a=t[e];if(e++,a!=0)throw"error: unknown encoding format: "+a;var s=t[e];e++;for(var i=0;i<s;i++)o.push(t[e+i]);return o},r.CFF.readCharset=function(t,e,n){var o=r._bin,a=[".notdef"],s=t[e];if(e++,s==0)for(var i=0;i<n;i++){var d=o.readUshort(t,e);e+=2,a.push(d)}else{if(s!=1&&s!=2)throw"error: format: "+s;for(;a.length<n;){d=o.readUshort(t,e),e+=2;var f=0;for(s==1?(f=t[e],e++):(f=o.readUshort(t,e),e+=2),i=0;i<=f;i++)a.push(d),d++}}return a},r.CFF.readIndex=function(t,e,n){var o=r._bin,a=o.readUshort(t,e)+1,s=t[e+=2];if(e++,s==1)for(var i=0;i<a;i++)n.push(t[e+i]);else if(s==2)for(i=0;i<a;i++)n.push(o.readUshort(t,e+2*i));else if(s==3)for(i=0;i<a;i++)n.push(16777215&o.readUint(t,e+3*i-1));else if(a!=1)throw"unsupported offset size: "+s+", count: "+a;return(e+=a*s)-1},r.CFF.getCharString=function(t,e,n){var o=r._bin,a=t[e],s=t[e+1];t[e+2],t[e+3],t[e+4];var i=1,d=null,f=null;a<=20&&(d=a,i=1),a==12&&(d=100*a+s,i=2),21<=a&&a<=27&&(d=a,i=1),a==28&&(f=o.readShort(t,e+1),i=3),29<=a&&a<=31&&(d=a,i=1),32<=a&&a<=246&&(f=a-139,i=1),247<=a&&a<=250&&(f=256*(a-247)+s+108,i=2),251<=a&&a<=254&&(f=256*-(a-251)-s-108,i=2),a==255&&(f=o.readInt(t,e+1)/65535,i=5),n.val=f??"o"+d,n.size=i},r.CFF.readCharString=function(t,e,n){for(var o=e+n,a=r._bin,s=[];e<o;){var i=t[e],d=t[e+1];t[e+2],t[e+3],t[e+4];var f=1,h=null,m=null;i<=20&&(h=i,f=1),i==12&&(h=100*i+d,f=2),i!=19&&i!=20||(h=i,f=2),21<=i&&i<=27&&(h=i,f=1),i==28&&(m=a.readShort(t,e+1),f=3),29<=i&&i<=31&&(h=i,f=1),32<=i&&i<=246&&(m=i-139,f=1),247<=i&&i<=250&&(m=256*(i-247)+d+108,f=2),251<=i&&i<=254&&(m=256*-(i-251)-d-108,f=2),i==255&&(m=a.readInt(t,e+1)/65535,f=5),s.push(m??"o"+h),e+=f}return s},r.CFF.readDict=function(t,e,n){for(var o=r._bin,a={},s=[];e<n;){var i=t[e],d=t[e+1];t[e+2],t[e+3],t[e+4];var f=1,h=null,m=null;if(i==28&&(m=o.readShort(t,e+1),f=3),i==29&&(m=o.readInt(t,e+1),f=5),32<=i&&i<=246&&(m=i-139,f=1),247<=i&&i<=250&&(m=256*(i-247)+d+108,f=2),251<=i&&i<=254&&(m=256*-(i-251)-d-108,f=2),i==255)throw m=o.readInt(t,e+1)/65535,f=5,"unknown number";if(i==30){var p=[];for(f=1;;){var v=t[e+f];f++;var E=v>>4,w=15&v;if(E!=15&&p.push(E),w!=15&&p.push(w),w==15)break}for(var S="",x=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],A=0;A<p.length;A++)S+=x[p[A]];m=parseFloat(S)}i<=21&&(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][i],f=1,i==12&&(h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][d],f=2)),h!=null?(a[h]=s.length==1?s[0]:s,s=[]):s.push(m),e+=f}return a},r.cmap={},r.cmap.parse=function(t,e,n){t=new Uint8Array(t.buffer,e,n),e=0;var o=r._bin,a={};o.readUshort(t,e),e+=2;var s=o.readUshort(t,e);e+=2;var i=[];a.tables=[];for(var d=0;d<s;d++){var f=o.readUshort(t,e);e+=2;var h=o.readUshort(t,e);e+=2;var m=o.readUint(t,e);e+=4;var p="p"+f+"e"+h,v=i.indexOf(m);if(v==-1){var E;v=a.tables.length,i.push(m);var w=o.readUshort(t,m);w==0?E=r.cmap.parse0(t,m):w==4?E=r.cmap.parse4(t,m):w==6?E=r.cmap.parse6(t,m):w==12?E=r.cmap.parse12(t,m):console.debug("unknown format: "+w,f,h,m),a.tables.push(E)}if(a[p]!=null)throw"multiple tables for one platform+encoding";a[p]=v}return a},r.cmap.parse0=function(t,e){var n=r._bin,o={};o.format=n.readUshort(t,e),e+=2;var a=n.readUshort(t,e);e+=2,n.readUshort(t,e),e+=2,o.map=[];for(var s=0;s<a-6;s++)o.map.push(t[e+s]);return o},r.cmap.parse4=function(t,e){var n=r._bin,o=e,a={};a.format=n.readUshort(t,e),e+=2;var s=n.readUshort(t,e);e+=2,n.readUshort(t,e),e+=2;var i=n.readUshort(t,e);e+=2;var d=i/2;a.searchRange=n.readUshort(t,e),e+=2,a.entrySelector=n.readUshort(t,e),e+=2,a.rangeShift=n.readUshort(t,e),e+=2,a.endCount=n.readUshorts(t,e,d),e+=2*d,e+=2,a.startCount=n.readUshorts(t,e,d),e+=2*d,a.idDelta=[];for(var f=0;f<d;f++)a.idDelta.push(n.readShort(t,e)),e+=2;for(a.idRangeOffset=n.readUshorts(t,e,d),e+=2*d,a.glyphIdArray=[];e<o+s;)a.glyphIdArray.push(n.readUshort(t,e)),e+=2;return a},r.cmap.parse6=function(t,e){var n=r._bin,o={};o.format=n.readUshort(t,e),e+=2,n.readUshort(t,e),e+=2,n.readUshort(t,e),e+=2,o.firstCode=n.readUshort(t,e),e+=2;var a=n.readUshort(t,e);e+=2,o.glyphIdArray=[];for(var s=0;s<a;s++)o.glyphIdArray.push(n.readUshort(t,e)),e+=2;return o},r.cmap.parse12=function(t,e){var n=r._bin,o={};o.format=n.readUshort(t,e),e+=2,e+=2,n.readUint(t,e),e+=4,n.readUint(t,e),e+=4;var a=n.readUint(t,e);e+=4,o.groups=[];for(var s=0;s<a;s++){var i=e+12*s,d=n.readUint(t,i+0),f=n.readUint(t,i+4),h=n.readUint(t,i+8);o.groups.push([d,f,h])}return o},r.glyf={},r.glyf.parse=function(t,e,n,o){for(var a=[],s=0;s<o.maxp.numGlyphs;s++)a.push(null);return a},r.glyf._parseGlyf=function(t,e){var n=r._bin,o=t._data,a=r._tabOffset(o,"glyf",t._offset)+t.loca[e];if(t.loca[e]==t.loca[e+1])return null;var s={};if(s.noc=n.readShort(o,a),a+=2,s.xMin=n.readShort(o,a),a+=2,s.yMin=n.readShort(o,a),a+=2,s.xMax=n.readShort(o,a),a+=2,s.yMax=n.readShort(o,a),a+=2,s.xMin>=s.xMax||s.yMin>=s.yMax)return null;if(s.noc>0){s.endPts=[];for(var i=0;i<s.noc;i++)s.endPts.push(n.readUshort(o,a)),a+=2;var d=n.readUshort(o,a);if(a+=2,o.length-a<d)return null;s.instructions=n.readBytes(o,a,d),a+=d;var f=s.endPts[s.noc-1]+1;for(s.flags=[],i=0;i<f;i++){var h=o[a];if(a++,s.flags.push(h),(8&h)!=0){var m=o[a];a++;for(var p=0;p<m;p++)s.flags.push(h),i++}}for(s.xs=[],i=0;i<f;i++){var v=(2&s.flags[i])!=0,E=(16&s.flags[i])!=0;v?(s.xs.push(E?o[a]:-o[a]),a++):E?s.xs.push(0):(s.xs.push(n.readShort(o,a)),a+=2)}for(s.ys=[],i=0;i<f;i++)v=(4&s.flags[i])!=0,E=(32&s.flags[i])!=0,v?(s.ys.push(E?o[a]:-o[a]),a++):E?s.ys.push(0):(s.ys.push(n.readShort(o,a)),a+=2);var w=0,S=0;for(i=0;i<f;i++)w+=s.xs[i],S+=s.ys[i],s.xs[i]=w,s.ys[i]=S}else{var x;s.parts=[];do{x=n.readUshort(o,a),a+=2;var A={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(s.parts.push(A),A.glyphIndex=n.readUshort(o,a),a+=2,1&x){var T=n.readShort(o,a);a+=2;var M=n.readShort(o,a);a+=2}else T=n.readInt8(o,a),a++,M=n.readInt8(o,a),a++;2&x?(A.m.tx=T,A.m.ty=M):(A.p1=T,A.p2=M),8&x?(A.m.a=A.m.d=n.readF2dot14(o,a),a+=2):64&x?(A.m.a=n.readF2dot14(o,a),a+=2,A.m.d=n.readF2dot14(o,a),a+=2):128&x&&(A.m.a=n.readF2dot14(o,a),a+=2,A.m.b=n.readF2dot14(o,a),a+=2,A.m.c=n.readF2dot14(o,a),a+=2,A.m.d=n.readF2dot14(o,a),a+=2)}while(32&x);if(256&x){var U=n.readUshort(o,a);for(a+=2,s.instr=[],i=0;i<U;i++)s.instr.push(o[a]),a++}}return s},r.GDEF={},r.GDEF.parse=function(t,e,n,o){var a=e;e+=4;var s=r._bin.readUshort(t,e);return{glyphClassDef:s===0?null:r._lctf.readClassDef(t,a+s)}},r.GPOS={},r.GPOS.parse=function(t,e,n,o){return r._lctf.parse(t,e,n,o,r.GPOS.subt)},r.GPOS.subt=function(t,e,n,o){var a=r._bin,s=n,i={};if(i.fmt=a.readUshort(t,n),n+=2,e==1||e==2||e==3||e==7||e==8&&i.fmt<=2){var d=a.readUshort(t,n);n+=2,i.coverage=r._lctf.readCoverage(t,d+s)}if(e==1&&i.fmt==1){var f=a.readUshort(t,n);n+=2,f!=0&&(i.pos=r.GPOS.readValueRecord(t,n,f))}else if(e==2&&i.fmt>=1&&i.fmt<=2){f=a.readUshort(t,n),n+=2;var h=a.readUshort(t,n);n+=2;var m=r._lctf.numOfOnes(f),p=r._lctf.numOfOnes(h);if(i.fmt==1){i.pairsets=[];var v=a.readUshort(t,n);n+=2;for(var E=0;E<v;E++){var w=s+a.readUshort(t,n);n+=2;var S=a.readUshort(t,w);w+=2;for(var x=[],A=0;A<S;A++){var T=a.readUshort(t,w);w+=2,f!=0&&(_=r.GPOS.readValueRecord(t,w,f),w+=2*m),h!=0&&(I=r.GPOS.readValueRecord(t,w,h),w+=2*p),x.push({gid2:T,val1:_,val2:I})}i.pairsets.push(x)}}if(i.fmt==2){var M=a.readUshort(t,n);n+=2;var U=a.readUshort(t,n);n+=2;var L=a.readUshort(t,n);n+=2;var g=a.readUshort(t,n);for(n+=2,i.classDef1=r._lctf.readClassDef(t,s+M),i.classDef2=r._lctf.readClassDef(t,s+U),i.matrix=[],E=0;E<L;E++){var O=[];for(A=0;A<g;A++){var _=null,I=null;f!=0&&(_=r.GPOS.readValueRecord(t,n,f),n+=2*m),h!=0&&(I=r.GPOS.readValueRecord(t,n,h),n+=2*p),O.push({val1:_,val2:I})}i.matrix.push(O)}}}else if(e==4&&i.fmt==1)i.markCoverage=r._lctf.readCoverage(t,a.readUshort(t,n)+s),i.baseCoverage=r._lctf.readCoverage(t,a.readUshort(t,n+2)+s),i.markClassCount=a.readUshort(t,n+4),i.markArray=r.GPOS.readMarkArray(t,a.readUshort(t,n+6)+s),i.baseArray=r.GPOS.readBaseArray(t,a.readUshort(t,n+8)+s,i.markClassCount);else if(e==6&&i.fmt==1)i.mark1Coverage=r._lctf.readCoverage(t,a.readUshort(t,n)+s),i.mark2Coverage=r._lctf.readCoverage(t,a.readUshort(t,n+2)+s),i.markClassCount=a.readUshort(t,n+4),i.mark1Array=r.GPOS.readMarkArray(t,a.readUshort(t,n+6)+s),i.mark2Array=r.GPOS.readBaseArray(t,a.readUshort(t,n+8)+s,i.markClassCount);else{if(e==9&&i.fmt==1){var F=a.readUshort(t,n);n+=2;var V=a.readUint(t,n);if(n+=4,o.ltype==9)o.ltype=F;else if(o.ltype!=F)throw"invalid extension substitution";return r.GPOS.subt(t,o.ltype,s+V)}console.debug("unsupported GPOS table LookupType",e,"format",i.fmt)}return i},r.GPOS.readValueRecord=function(t,e,n){var o=r._bin,a=[];return a.push(1&n?o.readShort(t,e):0),e+=1&n?2:0,a.push(2&n?o.readShort(t,e):0),e+=2&n?2:0,a.push(4&n?o.readShort(t,e):0),e+=4&n?2:0,a.push(8&n?o.readShort(t,e):0),e+=8&n?2:0,a},r.GPOS.readBaseArray=function(t,e,n){var o=r._bin,a=[],s=e,i=o.readUshort(t,e);e+=2;for(var d=0;d<i;d++){for(var f=[],h=0;h<n;h++)f.push(r.GPOS.readAnchorRecord(t,s+o.readUshort(t,e))),e+=2;a.push(f)}return a},r.GPOS.readMarkArray=function(t,e){var n=r._bin,o=[],a=e,s=n.readUshort(t,e);e+=2;for(var i=0;i<s;i++){var d=r.GPOS.readAnchorRecord(t,n.readUshort(t,e+2)+a);d.markClass=n.readUshort(t,e),o.push(d),e+=4}return o},r.GPOS.readAnchorRecord=function(t,e){var n=r._bin,o={};return o.fmt=n.readUshort(t,e),o.x=n.readShort(t,e+2),o.y=n.readShort(t,e+4),o},r.GSUB={},r.GSUB.parse=function(t,e,n,o){return r._lctf.parse(t,e,n,o,r.GSUB.subt)},r.GSUB.subt=function(t,e,n,o){var a=r._bin,s=n,i={};if(i.fmt=a.readUshort(t,n),n+=2,e!=1&&e!=2&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==2||e==4||e==5&&i.fmt<=2||e==6&&i.fmt<=2){var d=a.readUshort(t,n);n+=2,i.coverage=r._lctf.readCoverage(t,s+d)}if(e==1&&i.fmt>=1&&i.fmt<=2){if(i.fmt==1)i.delta=a.readShort(t,n),n+=2;else if(i.fmt==2){var f=a.readUshort(t,n);n+=2,i.newg=a.readUshorts(t,n,f),n+=2*i.newg.length}}else if(e==2&&i.fmt==1){f=a.readUshort(t,n),n+=2,i.seqs=[];for(var h=0;h<f;h++){var m=a.readUshort(t,n)+s;n+=2;var p=a.readUshort(t,m);i.seqs.push(a.readUshorts(t,m+2,p))}}else if(e==4)for(i.vals=[],f=a.readUshort(t,n),n+=2,h=0;h<f;h++){var v=a.readUshort(t,n);n+=2,i.vals.push(r.GSUB.readLigatureSet(t,s+v))}else if(e==5&&i.fmt==2){if(i.fmt==2){var E=a.readUshort(t,n);n+=2,i.cDef=r._lctf.readClassDef(t,s+E),i.scset=[];var w=a.readUshort(t,n);for(n+=2,h=0;h<w;h++){var S=a.readUshort(t,n);n+=2,i.scset.push(S==0?null:r.GSUB.readSubClassSet(t,s+S))}}}else if(e==6&&i.fmt==3){if(i.fmt==3){for(h=0;h<3;h++){f=a.readUshort(t,n),n+=2;for(var x=[],A=0;A<f;A++)x.push(r._lctf.readCoverage(t,s+a.readUshort(t,n+2*A)));n+=2*f,h==0&&(i.backCvg=x),h==1&&(i.inptCvg=x),h==2&&(i.ahedCvg=x)}f=a.readUshort(t,n),n+=2,i.lookupRec=r.GSUB.readSubstLookupRecords(t,n,f)}}else{if(e==7&&i.fmt==1){var T=a.readUshort(t,n);n+=2;var M=a.readUint(t,n);if(n+=4,o.ltype==9)o.ltype=T;else if(o.ltype!=T)throw"invalid extension substitution";return r.GSUB.subt(t,o.ltype,s+M)}console.debug("unsupported GSUB table LookupType",e,"format",i.fmt)}return i},r.GSUB.readSubClassSet=function(t,e){var n=r._bin.readUshort,o=e,a=[],s=n(t,e);e+=2;for(var i=0;i<s;i++){var d=n(t,e);e+=2,a.push(r.GSUB.readSubClassRule(t,o+d))}return a},r.GSUB.readSubClassRule=function(t,e){var n=r._bin.readUshort,o={},a=n(t,e),s=n(t,e+=2);e+=2,o.input=[];for(var i=0;i<a-1;i++)o.input.push(n(t,e)),e+=2;return o.substLookupRecords=r.GSUB.readSubstLookupRecords(t,e,s),o},r.GSUB.readSubstLookupRecords=function(t,e,n){for(var o=r._bin.readUshort,a=[],s=0;s<n;s++)a.push(o(t,e),o(t,e+2)),e+=4;return a},r.GSUB.readChainSubClassSet=function(t,e){var n=r._bin,o=e,a=[],s=n.readUshort(t,e);e+=2;for(var i=0;i<s;i++){var d=n.readUshort(t,e);e+=2,a.push(r.GSUB.readChainSubClassRule(t,o+d))}return a},r.GSUB.readChainSubClassRule=function(t,e){for(var n=r._bin,o={},a=["backtrack","input","lookahead"],s=0;s<a.length;s++){var i=n.readUshort(t,e);e+=2,s==1&&i--,o[a[s]]=n.readUshorts(t,e,i),e+=2*o[a[s]].length}return i=n.readUshort(t,e),e+=2,o.subst=n.readUshorts(t,e,2*i),e+=2*o.subst.length,o},r.GSUB.readLigatureSet=function(t,e){var n=r._bin,o=e,a=[],s=n.readUshort(t,e);e+=2;for(var i=0;i<s;i++){var d=n.readUshort(t,e);e+=2,a.push(r.GSUB.readLigature(t,o+d))}return a},r.GSUB.readLigature=function(t,e){var n=r._bin,o={chain:[]};o.nglyph=n.readUshort(t,e),e+=2;var a=n.readUshort(t,e);e+=2;for(var s=0;s<a-1;s++)o.chain.push(n.readUshort(t,e)),e+=2;return o},r.head={},r.head.parse=function(t,e,n){var o=r._bin,a={};return o.readFixed(t,e),e+=4,a.fontRevision=o.readFixed(t,e),e+=4,o.readUint(t,e),e+=4,o.readUint(t,e),e+=4,a.flags=o.readUshort(t,e),e+=2,a.unitsPerEm=o.readUshort(t,e),e+=2,a.created=o.readUint64(t,e),e+=8,a.modified=o.readUint64(t,e),e+=8,a.xMin=o.readShort(t,e),e+=2,a.yMin=o.readShort(t,e),e+=2,a.xMax=o.readShort(t,e),e+=2,a.yMax=o.readShort(t,e),e+=2,a.macStyle=o.readUshort(t,e),e+=2,a.lowestRecPPEM=o.readUshort(t,e),e+=2,a.fontDirectionHint=o.readShort(t,e),e+=2,a.indexToLocFormat=o.readShort(t,e),e+=2,a.glyphDataFormat=o.readShort(t,e),e+=2,a},r.hhea={},r.hhea.parse=function(t,e,n){var o=r._bin,a={};return o.readFixed(t,e),e+=4,a.ascender=o.readShort(t,e),e+=2,a.descender=o.readShort(t,e),e+=2,a.lineGap=o.readShort(t,e),e+=2,a.advanceWidthMax=o.readUshort(t,e),e+=2,a.minLeftSideBearing=o.readShort(t,e),e+=2,a.minRightSideBearing=o.readShort(t,e),e+=2,a.xMaxExtent=o.readShort(t,e),e+=2,a.caretSlopeRise=o.readShort(t,e),e+=2,a.caretSlopeRun=o.readShort(t,e),e+=2,a.caretOffset=o.readShort(t,e),e+=2,e+=8,a.metricDataFormat=o.readShort(t,e),e+=2,a.numberOfHMetrics=o.readUshort(t,e),e+=2,a},r.hmtx={},r.hmtx.parse=function(t,e,n,o){for(var a=r._bin,s={aWidth:[],lsBearing:[]},i=0,d=0,f=0;f<o.maxp.numGlyphs;f++)f<o.hhea.numberOfHMetrics&&(i=a.readUshort(t,e),e+=2,d=a.readShort(t,e),e+=2),s.aWidth.push(i),s.lsBearing.push(d);return s},r.kern={},r.kern.parse=function(t,e,n,o){var a=r._bin,s=a.readUshort(t,e);if(e+=2,s==1)return r.kern.parseV1(t,e-2,n,o);var i=a.readUshort(t,e);e+=2;for(var d={glyph1:[],rval:[]},f=0;f<i;f++){e+=2,n=a.readUshort(t,e),e+=2;var h=a.readUshort(t,e);e+=2;var m=h>>>8;if((m&=15)!=0)throw"unknown kern table format: "+m;e=r.kern.readFormat0(t,e,d)}return d},r.kern.parseV1=function(t,e,n,o){var a=r._bin;a.readFixed(t,e),e+=4;var s=a.readUint(t,e);e+=4;for(var i={glyph1:[],rval:[]},d=0;d<s;d++){a.readUint(t,e),e+=4;var f=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2;var h=f>>>8;if((h&=15)!=0)throw"unknown kern table format: "+h;e=r.kern.readFormat0(t,e,i)}return i},r.kern.readFormat0=function(t,e,n){var o=r._bin,a=-1,s=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2;for(var i=0;i<s;i++){var d=o.readUshort(t,e);e+=2;var f=o.readUshort(t,e);e+=2;var h=o.readShort(t,e);e+=2,d!=a&&(n.glyph1.push(d),n.rval.push({glyph2:[],vals:[]}));var m=n.rval[n.rval.length-1];m.glyph2.push(f),m.vals.push(h),a=d}return e},r.loca={},r.loca.parse=function(t,e,n,o){var a=r._bin,s=[],i=o.head.indexToLocFormat,d=o.maxp.numGlyphs+1;if(i==0)for(var f=0;f<d;f++)s.push(a.readUshort(t,e+(f<<1))<<1);if(i==1)for(f=0;f<d;f++)s.push(a.readUint(t,e+(f<<2)));return s},r.maxp={},r.maxp.parse=function(t,e,n){var o=r._bin,a={},s=o.readUint(t,e);return e+=4,a.numGlyphs=o.readUshort(t,e),e+=2,s==65536&&(a.maxPoints=o.readUshort(t,e),e+=2,a.maxContours=o.readUshort(t,e),e+=2,a.maxCompositePoints=o.readUshort(t,e),e+=2,a.maxCompositeContours=o.readUshort(t,e),e+=2,a.maxZones=o.readUshort(t,e),e+=2,a.maxTwilightPoints=o.readUshort(t,e),e+=2,a.maxStorage=o.readUshort(t,e),e+=2,a.maxFunctionDefs=o.readUshort(t,e),e+=2,a.maxInstructionDefs=o.readUshort(t,e),e+=2,a.maxStackElements=o.readUshort(t,e),e+=2,a.maxSizeOfInstructions=o.readUshort(t,e),e+=2,a.maxComponentElements=o.readUshort(t,e),e+=2,a.maxComponentDepth=o.readUshort(t,e),e+=2),a},r.name={},r.name.parse=function(t,e,n){var o=r._bin,a={};o.readUshort(t,e),e+=2;var s=o.readUshort(t,e);e+=2,o.readUshort(t,e);for(var i,d=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],f=e+=2,h=0;h<s;h++){var m=o.readUshort(t,e);e+=2;var p=o.readUshort(t,e);e+=2;var v=o.readUshort(t,e);e+=2;var E=o.readUshort(t,e);e+=2;var w=o.readUshort(t,e);e+=2;var S=o.readUshort(t,e);e+=2;var x,A=d[E],T=f+12*s+S;if(m==0)x=o.readUnicode(t,T,w/2);else if(m==3&&p==0)x=o.readUnicode(t,T,w/2);else if(p==0)x=o.readASCII(t,T,w);else if(p==1)x=o.readUnicode(t,T,w/2);else if(p==3)x=o.readUnicode(t,T,w/2);else{if(m!=1)throw"unknown encoding "+p+", platformID: "+m;x=o.readASCII(t,T,w),console.debug("reading unknown MAC encoding "+p+" as ASCII")}var M="p"+m+","+v.toString(16);a[M]==null&&(a[M]={}),a[M][A!==void 0?A:E]=x,a[M]._lang=v}for(var U in a)if(a[U].postScriptName!=null&&a[U]._lang==1033)return a[U];for(var U in a)if(a[U].postScriptName!=null&&a[U]._lang==0)return a[U];for(var U in a)if(a[U].postScriptName!=null&&a[U]._lang==3084)return a[U];for(var U in a)if(a[U].postScriptName!=null)return a[U];for(var U in a){i=U;break}return console.debug("returning name table with languageID "+a[i]._lang),a[i]},r["OS/2"]={},r["OS/2"].parse=function(t,e,n){var o=r._bin.readUshort(t,e);e+=2;var a={};if(o==0)r["OS/2"].version0(t,e,a);else if(o==1)r["OS/2"].version1(t,e,a);else if(o==2||o==3||o==4)r["OS/2"].version2(t,e,a);else{if(o!=5)throw"unknown OS/2 table version: "+o;r["OS/2"].version5(t,e,a)}return a},r["OS/2"].version0=function(t,e,n){var o=r._bin;return n.xAvgCharWidth=o.readShort(t,e),e+=2,n.usWeightClass=o.readUshort(t,e),e+=2,n.usWidthClass=o.readUshort(t,e),e+=2,n.fsType=o.readUshort(t,e),e+=2,n.ySubscriptXSize=o.readShort(t,e),e+=2,n.ySubscriptYSize=o.readShort(t,e),e+=2,n.ySubscriptXOffset=o.readShort(t,e),e+=2,n.ySubscriptYOffset=o.readShort(t,e),e+=2,n.ySuperscriptXSize=o.readShort(t,e),e+=2,n.ySuperscriptYSize=o.readShort(t,e),e+=2,n.ySuperscriptXOffset=o.readShort(t,e),e+=2,n.ySuperscriptYOffset=o.readShort(t,e),e+=2,n.yStrikeoutSize=o.readShort(t,e),e+=2,n.yStrikeoutPosition=o.readShort(t,e),e+=2,n.sFamilyClass=o.readShort(t,e),e+=2,n.panose=o.readBytes(t,e,10),e+=10,n.ulUnicodeRange1=o.readUint(t,e),e+=4,n.ulUnicodeRange2=o.readUint(t,e),e+=4,n.ulUnicodeRange3=o.readUint(t,e),e+=4,n.ulUnicodeRange4=o.readUint(t,e),e+=4,n.achVendID=[o.readInt8(t,e),o.readInt8(t,e+1),o.readInt8(t,e+2),o.readInt8(t,e+3)],e+=4,n.fsSelection=o.readUshort(t,e),e+=2,n.usFirstCharIndex=o.readUshort(t,e),e+=2,n.usLastCharIndex=o.readUshort(t,e),e+=2,n.sTypoAscender=o.readShort(t,e),e+=2,n.sTypoDescender=o.readShort(t,e),e+=2,n.sTypoLineGap=o.readShort(t,e),e+=2,n.usWinAscent=o.readUshort(t,e),e+=2,n.usWinDescent=o.readUshort(t,e),e+=2},r["OS/2"].version1=function(t,e,n){var o=r._bin;return e=r["OS/2"].version0(t,e,n),n.ulCodePageRange1=o.readUint(t,e),e+=4,n.ulCodePageRange2=o.readUint(t,e),e+=4},r["OS/2"].version2=function(t,e,n){var o=r._bin;return e=r["OS/2"].version1(t,e,n),n.sxHeight=o.readShort(t,e),e+=2,n.sCapHeight=o.readShort(t,e),e+=2,n.usDefault=o.readUshort(t,e),e+=2,n.usBreak=o.readUshort(t,e),e+=2,n.usMaxContext=o.readUshort(t,e),e+=2},r["OS/2"].version5=function(t,e,n){var o=r._bin;return e=r["OS/2"].version2(t,e,n),n.usLowerOpticalPointSize=o.readUshort(t,e),e+=2,n.usUpperOpticalPointSize=o.readUshort(t,e),e+=2},r.post={},r.post.parse=function(t,e,n){var o=r._bin,a={};return a.version=o.readFixed(t,e),e+=4,a.italicAngle=o.readFixed(t,e),e+=4,a.underlinePosition=o.readShort(t,e),e+=2,a.underlineThickness=o.readShort(t,e),e+=2,a},r==null&&(r={}),r.U==null&&(r.U={}),r.U.codeToGlyph=function(t,e){var n=t.cmap,o=-1;if(n.p0e4!=null?o=n.p0e4:n.p3e1!=null?o=n.p3e1:n.p1e0!=null?o=n.p1e0:n.p0e3!=null&&(o=n.p0e3),o==-1)throw"no familiar platform and encoding!";var a=n.tables[o];if(a.format==0)return e>=a.map.length?0:a.map[e];if(a.format==4){for(var s=-1,i=0;i<a.endCount.length;i++)if(e<=a.endCount[i]){s=i;break}return s==-1||a.startCount[s]>e?0:65535&(a.idRangeOffset[s]!=0?a.glyphIdArray[e-a.startCount[s]+(a.idRangeOffset[s]>>1)-(a.idRangeOffset.length-s)]:e+a.idDelta[s])}if(a.format==12){if(e>a.groups[a.groups.length-1][1])return 0;for(i=0;i<a.groups.length;i++){var d=a.groups[i];if(d[0]<=e&&e<=d[1])return d[2]+(e-d[0])}return 0}throw"unknown cmap table format "+a.format},r.U.glyphToPath=function(t,e){var n={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[e]){var o=t.SVG.entries[e];return o==null?n:(typeof o=="string"&&(o=r.SVG.toPath(o),t.SVG.entries[e]=o),o)}if(t.CFF){var a={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},s=t.CFF,i=t.CFF.Private;if(s.ROS){for(var d=0;s.FDSelect[d+2]<=e;)d+=2;i=s.FDArray[s.FDSelect[d+1]].Private}r.U._drawCFF(t.CFF.CharStrings[e],a,s,i,n)}else t.glyf&&r.U._drawGlyf(e,t,n);return n},r.U._drawGlyf=function(t,e,n){var o=e.glyf[t];o==null&&(o=e.glyf[t]=r.glyf._parseGlyf(e,t)),o!=null&&(o.noc>-1?r.U._simpleGlyph(o,n):r.U._compoGlyph(o,e,n))},r.U._simpleGlyph=function(t,e){for(var n=0;n<t.noc;n++){for(var o=n==0?0:t.endPts[n-1]+1,a=t.endPts[n],s=o;s<=a;s++){var i=s==o?a:s-1,d=s==a?o:s+1,f=1&t.flags[s],h=1&t.flags[i],m=1&t.flags[d],p=t.xs[s],v=t.ys[s];if(s==o)if(f){if(!h){r.U.P.moveTo(e,p,v);continue}r.U.P.moveTo(e,t.xs[i],t.ys[i])}else h?r.U.P.moveTo(e,t.xs[i],t.ys[i]):r.U.P.moveTo(e,(t.xs[i]+p)/2,(t.ys[i]+v)/2);f?h&&r.U.P.lineTo(e,p,v):m?r.U.P.qcurveTo(e,p,v,t.xs[d],t.ys[d]):r.U.P.qcurveTo(e,p,v,(p+t.xs[d])/2,(v+t.ys[d])/2)}r.U.P.closePath(e)}},r.U._compoGlyph=function(t,e,n){for(var o=0;o<t.parts.length;o++){var a={cmds:[],crds:[]},s=t.parts[o];r.U._drawGlyf(s.glyphIndex,e,a);for(var i=s.m,d=0;d<a.crds.length;d+=2){var f=a.crds[d],h=a.crds[d+1];n.crds.push(f*i.a+h*i.b+i.tx),n.crds.push(f*i.c+h*i.d+i.ty)}for(d=0;d<a.cmds.length;d++)n.cmds.push(a.cmds[d])}},r.U._getGlyphClass=function(t,e){var n=r._lctf.getInterval(e,t);return n==-1?0:e[n+2]},r.U._applySubs=function(t,e,n,o){for(var a=t.length-e-1,s=0;s<n.tabs.length;s++)if(n.tabs[s]!=null){var i,d=n.tabs[s];if(!d.coverage||(i=r._lctf.coverageIndex(d.coverage,t[e]))!=-1){if(n.ltype==1)t[e],d.fmt==1?t[e]=t[e]+d.delta:t[e]=d.newg[i];else if(n.ltype==4)for(var f=d.vals[i],h=0;h<f.length;h++){var m=f[h],p=m.chain.length;if(!(p>a)){for(var v=!0,E=0,w=0;w<p;w++){for(;t[e+E+(1+w)]==-1;)E++;m.chain[w]!=t[e+E+(1+w)]&&(v=!1)}if(v){for(t[e]=m.nglyph,w=0;w<p+E;w++)t[e+w+1]=-1;break}}}else if(n.ltype==5&&d.fmt==2)for(var S=r._lctf.getInterval(d.cDef,t[e]),x=d.cDef[S+2],A=d.scset[x],T=0;T<A.length;T++){var M=A[T],U=M.input;if(!(U.length>a)){for(v=!0,w=0;w<U.length;w++){var L=r._lctf.getInterval(d.cDef,t[e+1+w]);if(S==-1&&d.cDef[L+2]!=U[w]){v=!1;break}}if(v){var g=M.substLookupRecords;for(h=0;h<g.length;h+=2)g[h],g[h+1]}}}else if(n.ltype==6&&d.fmt==3){if(!r.U._glsCovered(t,d.backCvg,e-d.backCvg.length)||!r.U._glsCovered(t,d.inptCvg,e)||!r.U._glsCovered(t,d.ahedCvg,e+d.inptCvg.length))continue;var O=d.lookupRec;for(T=0;T<O.length;T+=2){S=O[T];var _=o[O[T+1]];r.U._applySubs(t,e+S,_,o)}}}}},r.U._glsCovered=function(t,e,n){for(var o=0;o<e.length;o++)if(r._lctf.coverageIndex(e[o],t[n+o])==-1)return!1;return!0},r.U.glyphsToPath=function(t,e,n){for(var o={cmds:[],crds:[]},a=0,s=0;s<e.length;s++){var i=e[s];if(i!=-1){for(var d=s<e.length-1&&e[s+1]!=-1?e[s+1]:0,f=r.U.glyphToPath(t,i),h=0;h<f.crds.length;h+=2)o.crds.push(f.crds[h]+a),o.crds.push(f.crds[h+1]);for(n&&o.cmds.push(n),h=0;h<f.cmds.length;h++)o.cmds.push(f.cmds[h]);n&&o.cmds.push("X"),a+=t.hmtx.aWidth[i],s<e.length-1&&(a+=r.U.getPairAdjustment(t,i,d))}}return o},r.U.P={},r.U.P.moveTo=function(t,e,n){t.cmds.push("M"),t.crds.push(e,n)},r.U.P.lineTo=function(t,e,n){t.cmds.push("L"),t.crds.push(e,n)},r.U.P.curveTo=function(t,e,n,o,a,s,i){t.cmds.push("C"),t.crds.push(e,n,o,a,s,i)},r.U.P.qcurveTo=function(t,e,n,o,a){t.cmds.push("Q"),t.crds.push(e,n,o,a)},r.U.P.closePath=function(t){t.cmds.push("Z")},r.U._drawCFF=function(t,e,n,o,a){for(var s=e.stack,i=e.nStems,d=e.haveWidth,f=e.width,h=e.open,m=0,p=e.x,v=e.y,E=0,w=0,S=0,x=0,A=0,T=0,M=0,U=0,L=0,g=0,O={val:0,size:0};m<t.length;){r.CFF.getCharString(t,m,O);var _=O.val;if(m+=O.size,_=="o1"||_=="o18")s.length%2!=0&&!d&&(f=s.shift()+o.nominalWidthX),i+=s.length>>1,s.length=0,d=!0;else if(_=="o3"||_=="o23")s.length%2!=0&&!d&&(f=s.shift()+o.nominalWidthX),i+=s.length>>1,s.length=0,d=!0;else if(_=="o4")s.length>1&&!d&&(f=s.shift()+o.nominalWidthX,d=!0),h&&r.U.P.closePath(a),v+=s.pop(),r.U.P.moveTo(a,p,v),h=!0;else if(_=="o5")for(;s.length>0;)p+=s.shift(),v+=s.shift(),r.U.P.lineTo(a,p,v);else if(_=="o6"||_=="o7")for(var I=s.length,F=_=="o6",V=0;V<I;V++){var Y=s.shift();F?p+=Y:v+=Y,F=!F,r.U.P.lineTo(a,p,v)}else if(_=="o8"||_=="o24"){I=s.length;for(var Q=0;Q+6<=I;)E=p+s.shift(),w=v+s.shift(),S=E+s.shift(),x=w+s.shift(),p=S+s.shift(),v=x+s.shift(),r.U.P.curveTo(a,E,w,S,x,p,v),Q+=6;_=="o24"&&(p+=s.shift(),v+=s.shift(),r.U.P.lineTo(a,p,v))}else{if(_=="o11")break;if(_=="o1234"||_=="o1235"||_=="o1236"||_=="o1237")_=="o1234"&&(w=v,S=(E=p+s.shift())+s.shift(),g=x=w+s.shift(),T=x,U=v,p=(M=(A=(L=S+s.shift())+s.shift())+s.shift())+s.shift(),r.U.P.curveTo(a,E,w,S,x,L,g),r.U.P.curveTo(a,A,T,M,U,p,v)),_=="o1235"&&(E=p+s.shift(),w=v+s.shift(),S=E+s.shift(),x=w+s.shift(),L=S+s.shift(),g=x+s.shift(),A=L+s.shift(),T=g+s.shift(),M=A+s.shift(),U=T+s.shift(),p=M+s.shift(),v=U+s.shift(),s.shift(),r.U.P.curveTo(a,E,w,S,x,L,g),r.U.P.curveTo(a,A,T,M,U,p,v)),_=="o1236"&&(E=p+s.shift(),w=v+s.shift(),S=E+s.shift(),g=x=w+s.shift(),T=x,M=(A=(L=S+s.shift())+s.shift())+s.shift(),U=T+s.shift(),p=M+s.shift(),r.U.P.curveTo(a,E,w,S,x,L,g),r.U.P.curveTo(a,A,T,M,U,p,v)),_=="o1237"&&(E=p+s.shift(),w=v+s.shift(),S=E+s.shift(),x=w+s.shift(),L=S+s.shift(),g=x+s.shift(),A=L+s.shift(),T=g+s.shift(),M=A+s.shift(),U=T+s.shift(),Math.abs(M-p)>Math.abs(U-v)?p=M+s.shift():v=U+s.shift(),r.U.P.curveTo(a,E,w,S,x,L,g),r.U.P.curveTo(a,A,T,M,U,p,v));else if(_=="o14"){if(s.length>0&&!d&&(f=s.shift()+n.nominalWidthX,d=!0),s.length==4){var W=s.shift(),N=s.shift(),B=s.shift(),y=s.shift(),k=r.CFF.glyphBySE(n,B),D=r.CFF.glyphBySE(n,y);r.U._drawCFF(n.CharStrings[k],e,n,o,a),e.x=W,e.y=N,r.U._drawCFF(n.CharStrings[D],e,n,o,a)}h&&(r.U.P.closePath(a),h=!1)}else if(_=="o19"||_=="o20")s.length%2!=0&&!d&&(f=s.shift()+o.nominalWidthX),i+=s.length>>1,s.length=0,d=!0,m+=i+7>>3;else if(_=="o21")s.length>2&&!d&&(f=s.shift()+o.nominalWidthX,d=!0),v+=s.pop(),p+=s.pop(),h&&r.U.P.closePath(a),r.U.P.moveTo(a,p,v),h=!0;else if(_=="o22")s.length>1&&!d&&(f=s.shift()+o.nominalWidthX,d=!0),p+=s.pop(),h&&r.U.P.closePath(a),r.U.P.moveTo(a,p,v),h=!0;else if(_=="o25"){for(;s.length>6;)p+=s.shift(),v+=s.shift(),r.U.P.lineTo(a,p,v);E=p+s.shift(),w=v+s.shift(),S=E+s.shift(),x=w+s.shift(),p=S+s.shift(),v=x+s.shift(),r.U.P.curveTo(a,E,w,S,x,p,v)}else if(_=="o26")for(s.length%2&&(p+=s.shift());s.length>0;)E=p,w=v+s.shift(),p=S=E+s.shift(),v=(x=w+s.shift())+s.shift(),r.U.P.curveTo(a,E,w,S,x,p,v);else if(_=="o27")for(s.length%2&&(v+=s.shift());s.length>0;)w=v,S=(E=p+s.shift())+s.shift(),x=w+s.shift(),p=S+s.shift(),v=x,r.U.P.curveTo(a,E,w,S,x,p,v);else if(_=="o10"||_=="o29"){var R=_=="o10"?o:n;if(s.length==0)console.debug("error: empty stack");else{var P=s.pop(),J=R.Subrs[P+R.Bias];e.x=p,e.y=v,e.nStems=i,e.haveWidth=d,e.width=f,e.open=h,r.U._drawCFF(J,e,n,o,a),p=e.x,v=e.y,i=e.nStems,d=e.haveWidth,f=e.width,h=e.open}}else if(_=="o30"||_=="o31"){var G=s.length,z=(Q=0,_=="o31");for(Q+=G-(I=-3&G);Q<I;)z?(w=v,S=(E=p+s.shift())+s.shift(),v=(x=w+s.shift())+s.shift(),I-Q==5?(p=S+s.shift(),Q++):p=S,z=!1):(E=p,w=v+s.shift(),S=E+s.shift(),x=w+s.shift(),p=S+s.shift(),I-Q==5?(v=x+s.shift(),Q++):v=x,z=!0),r.U.P.curveTo(a,E,w,S,x,p,v),Q+=4}else{if((_+"").charAt(0)=="o")throw console.debug("Unknown operation: "+_,t),_;s.push(_)}}}e.x=p,e.y=v,e.nStems=i,e.haveWidth=d,e.width=f,e.open=h};var c=r,u={Typr:c};return l.Typr=c,l.default=u,Object.defineProperty(l,"__esModule",{value:!0}),l})({}).Typr}function Hi(){return(function(l){var r=Uint8Array,c=Uint16Array,u=Uint32Array,t=new r([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new r([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),n=new r([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(_,I){for(var F=new c(31),V=0;V<31;++V)F[V]=I+=1<<_[V-1];var Y=new u(F[30]);for(V=1;V<30;++V)for(var Q=F[V];Q<F[V+1];++Q)Y[Q]=Q-F[V]<<5|V;return[F,Y]},a=o(t,2),s=a[0],i=a[1];s[28]=258,i[258]=28;for(var d=o(e,0)[0],f=new c(32768),h=0;h<32768;++h){var m=(43690&h)>>>1|(21845&h)<<1;m=(61680&(m=(52428&m)>>>2|(13107&m)<<2))>>>4|(3855&m)<<4,f[h]=((65280&m)>>>8|(255&m)<<8)>>>1}var p=function(_,I,F){for(var V=_.length,Y=0,Q=new c(I);Y<V;++Y)++Q[_[Y]-1];var W,N=new c(I);for(Y=0;Y<I;++Y)N[Y]=N[Y-1]+Q[Y-1]<<1;{W=new c(1<<I);var B=15-I;for(Y=0;Y<V;++Y)if(_[Y])for(var y=Y<<4|_[Y],k=I-_[Y],D=N[_[Y]-1]++<<k,R=D|(1<<k)-1;D<=R;++D)W[f[D]>>>B]=y}return W},v=new r(288);for(h=0;h<144;++h)v[h]=8;for(h=144;h<256;++h)v[h]=9;for(h=256;h<280;++h)v[h]=7;for(h=280;h<288;++h)v[h]=8;var E=new r(32);for(h=0;h<32;++h)E[h]=5;var w=p(v,9),S=p(E,5),x=function(_){for(var I=_[0],F=1;F<_.length;++F)_[F]>I&&(I=_[F]);return I},A=function(_,I,F){var V=I/8|0;return(_[V]|_[V+1]<<8)>>(7&I)&F},T=function(_,I){var F=I/8|0;return(_[F]|_[F+1]<<8|_[F+2]<<16)>>(7&I)},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],U=function(_,I,F){var V=new Error(I||M[_]);if(V.code=_,Error.captureStackTrace&&Error.captureStackTrace(V,U),!F)throw V;return V},L=function(_,I,F){var V=_.length;if(!V||F&&!F.l&&V<5)return I||new r(0);var Y=!I||F,Q=!F||F.i;F||(F={}),I||(I=new r(3*V));var W,N=function(de){var De=I.length;if(de>De){var Ee=new r(Math.max(2*De,de));Ee.set(I),I=Ee}},B=F.f||0,y=F.p||0,k=F.b||0,D=F.l,R=F.d,P=F.m,J=F.n,G=8*V;do{if(!D){F.f=B=A(_,y,1);var z=A(_,y+1,3);if(y+=3,!z){var Z=_[(ne=((W=y)/8|0)+(7&W&&1)+4)-4]|_[ne-3]<<8,q=ne+Z;if(q>V){Q&&U(0);break}Y&&N(k+Z),I.set(_.subarray(ne,q),k),F.b=k+=Z,F.p=y=8*q;continue}if(z==1)D=w,R=S,P=9,J=5;else if(z==2){var j=A(_,y,31)+257,X=A(_,y+10,15)+4,fe=j+A(_,y+5,31)+1;y+=14;for(var ue=new r(fe),ee=new r(19),se=0;se<X;++se)ee[n[se]]=A(_,y+3*se,7);y+=3*X;var oe=x(ee),K=(1<<oe)-1,ae=p(ee,oe);for(se=0;se<fe;){var ne,H=ae[A(_,y,K)];if(y+=15&H,(ne=H>>>4)<16)ue[se++]=ne;else{var pe=0,te=0;for(ne==16?(te=3+A(_,y,3),y+=2,pe=ue[se-1]):ne==17?(te=3+A(_,y,7),y+=3):ne==18&&(te=11+A(_,y,127),y+=7);te--;)ue[se++]=pe}}var ie=ue.subarray(0,j),$=ue.subarray(j);P=x(ie),J=x($),D=p(ie,P),R=p($,J)}else U(1);if(y>G){Q&&U(0);break}}Y&&N(k+131072);for(var Se=(1<<P)-1,re=(1<<J)-1,le=y;;le=y){var he=(pe=D[T(_,y)&Se])>>>4;if((y+=15&pe)>G){Q&&U(0);break}if(pe||U(2),he<256)I[k++]=he;else{if(he==256){le=y,D=null;break}var ve=he-254;if(he>264){var Ae=t[se=he-257];ve=A(_,y,(1<<Ae)-1)+s[se],y+=Ae}var Fe=R[T(_,y)&re],ge=Fe>>>4;if(Fe||U(3),y+=15&Fe,$=d[ge],ge>3&&(Ae=e[ge],$+=T(_,y)&(1<<Ae)-1,y+=Ae),y>G){Q&&U(0);break}Y&&N(k+131072);for(var be=k+ve;k<be;k+=4)I[k]=I[k-$],I[k+1]=I[k+1-$],I[k+2]=I[k+2-$],I[k+3]=I[k+3-$];k=be}}F.l=D,F.p=le,F.b=k,D&&(B=1,F.m=P,F.d=R,F.n=J)}while(!B);return k==I.length?I:(function(de,De,Ee){(Ee==null||Ee>de.length)&&(Ee=de.length);var Xe=new(de instanceof c?c:de instanceof u?u:r)(Ee-De);return Xe.set(de.subarray(De,Ee)),Xe})(I,0,k)},g=new r(0),O=typeof TextDecoder<"u"&&new TextDecoder;try{O.decode(g,{stream:!0})}catch{}return l.convert_streams=function(_){var I=new DataView(_),F=0;function V(){var j=I.getUint16(F);return F+=2,j}function Y(){var j=I.getUint32(F);return F+=4,j}function Q(j){Z.setUint16(q,j),q+=2}function W(j){Z.setUint32(q,j),q+=4}for(var N={signature:Y(),flavor:Y(),length:Y(),numTables:V(),reserved:V(),totalSfntSize:Y(),majorVersion:V(),minorVersion:V(),metaOffset:Y(),metaLength:Y(),metaOrigLength:Y(),privOffset:Y(),privLength:Y()},B=0;Math.pow(2,B)<=N.numTables;)B++;B--;for(var y=16*Math.pow(2,B),k=16*N.numTables-y,D=12,R=[],P=0;P<N.numTables;P++)R.push({tag:Y(),offset:Y(),compLength:Y(),origLength:Y(),origChecksum:Y()}),D+=16;var J,G=new Uint8Array(12+16*R.length+R.reduce((function(j,X){return j+X.origLength+4}),0)),z=G.buffer,Z=new DataView(z),q=0;return W(N.flavor),Q(N.numTables),Q(y),Q(B),Q(k),R.forEach((function(j){W(j.tag),W(j.origChecksum),W(D),W(j.origLength),j.outOffset=D,(D+=j.origLength)%4!=0&&(D+=4-D%4)})),R.forEach((function(j){var X,fe=_.slice(j.offset,j.offset+j.compLength);if(j.compLength!=j.origLength){var ue=new Uint8Array(j.origLength);X=new Uint8Array(fe,2),L(X,ue)}else ue=new Uint8Array(fe);G.set(ue,j.outOffset);var ee=0;(D=j.outOffset+j.origLength)%4!=0&&(ee=4-D%4),G.set(new Uint8Array(ee).buffer,j.outOffset+j.origLength),J=D+ee})),z.slice(0,J)},Object.defineProperty(l,"__esModule",{value:!0}),l})({}).convert_streams}function Vi(l,r){const c={M:2,L:2,Q:4,C:6,Z:0},u={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},t=1,e=2,n=4,o=8,a=16,s=32;let i;function d(M){if(!i){const U={R:e,L:t,D:n,C:a,U:s,T:o};i=new Map;for(let L in u){let g=0;u[L].split(",").forEach(O=>{let[_,I]=O.split("+");_=parseInt(_,36),I=I?parseInt(I,36):0,i.set(g+=_,U[L]);for(let F=I;F--;)i.set(++g,U[L])})}}return i.get(M)||s}const f=1,h=2,m=3,p=4,v=[null,"isol","init","fina","medi"];function E(M){const U=new Uint8Array(M.length);let L=s,g=f,O=-1;for(let _=0;_<M.length;_++){const I=M.codePointAt(_);let F=d(I)|0,V=f;F&o||(L&(t|n|a)?F&(e|n|a)?(V=m,(g===f||g===m)&&U[O]++):F&(t|s)&&(g===h||g===p)&&U[O]--:L&(e|s)&&(g===h||g===p)&&U[O]--,g=U[_]=V,L=F,O=_,I>65535&&_++)}return U}function w(M,U){const L=[];for(let O=0;O<U.length;O++){const _=U.codePointAt(O);_>65535&&O++,L.push(l.U.codeToGlyph(M,_))}const g=M.GSUB;if(g){const{lookupList:O,featureList:_}=g;let I;const F=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,V=[];_.forEach(Y=>{if(F.test(Y.tag))for(let Q=0;Q<Y.tab.length;Q++){if(V[Y.tab[Q]])continue;V[Y.tab[Q]]=!0;const W=O[Y.tab[Q]],N=/^(isol|init|fina|medi)$/.test(Y.tag);N&&!I&&(I=E(U));for(let B=0;B<L.length;B++)(!I||!N||v[I[B]]===Y.tag)&&l.U._applySubs(L,B,W,O)}})}return L}function S(M,U){const L=new Int16Array(U.length*3);let g=0;for(;g<U.length;g++){const F=U[g];if(F===-1)continue;L[g*3+2]=M.hmtx.aWidth[F];const V=M.GPOS;if(V){const Y=V.lookupList;for(let Q=0;Q<Y.length;Q++){const W=Y[Q];for(let N=0;N<W.tabs.length;N++){const B=W.tabs[N];if(W.ltype===1){if(l._lctf.coverageIndex(B.coverage,F)!==-1&&B.pos){I(B.pos,g);break}}else if(W.ltype===2){let y=null,k=O();if(k!==-1){const D=l._lctf.coverageIndex(B.coverage,U[k]);if(D!==-1){if(B.fmt===1){const R=B.pairsets[D];for(let P=0;P<R.length;P++)R[P].gid2===F&&(y=R[P])}else if(B.fmt===2){const R=l.U._getGlyphClass(U[k],B.classDef1),P=l.U._getGlyphClass(F,B.classDef2);y=B.matrix[R][P]}if(y){y.val1&&I(y.val1,k),y.val2&&I(y.val2,g);break}}}}else if(W.ltype===4){const y=l._lctf.coverageIndex(B.markCoverage,F);if(y!==-1){const k=O(_),D=k===-1?-1:l._lctf.coverageIndex(B.baseCoverage,U[k]);if(D!==-1){const R=B.markArray[y],P=B.baseArray[D][R.markClass];L[g*3]=P.x-R.x+L[k*3]-L[k*3+2],L[g*3+1]=P.y-R.y+L[k*3+1];break}}}else if(W.ltype===6){const y=l._lctf.coverageIndex(B.mark1Coverage,F);if(y!==-1){const k=O();if(k!==-1){const D=U[k];if(x(M,D)===3){const R=l._lctf.coverageIndex(B.mark2Coverage,D);if(R!==-1){const P=B.mark1Array[y],J=B.mark2Array[R][P.markClass];L[g*3]=J.x-P.x+L[k*3]-L[k*3+2],L[g*3+1]=J.y-P.y+L[k*3+1];break}}}}}}}}else if(M.kern&&!M.cff){const Y=O();if(Y!==-1){const Q=M.kern.glyph1.indexOf(U[Y]);if(Q!==-1){const W=M.kern.rval[Q].glyph2.indexOf(F);W!==-1&&(L[Y*3+2]+=M.kern.rval[Q].vals[W])}}}}return L;function O(F){for(let V=g-1;V>=0;V--)if(U[V]!==-1&&(!F||F(U[V])))return V;return-1}function _(F){return x(M,F)===1}function I(F,V){for(let Y=0;Y<3;Y++)L[V*3+Y]+=F[Y]||0}}function x(M,U){const L=M.GDEF&&M.GDEF.glyphClassDef;return L?l.U._getGlyphClass(U,L):0}function A(...M){for(let U=0;U<M.length;U++)if(typeof M[U]=="number")return M[U]}function T(M){const U=Object.create(null),L=M["OS/2"],g=M.hhea,O=M.head.unitsPerEm,_=A(L&&L.sTypoAscender,g&&g.ascender,O),I={unitsPerEm:O,ascender:_,descender:A(L&&L.sTypoDescender,g&&g.descender,0),capHeight:A(L&&L.sCapHeight,_),xHeight:A(L&&L.sxHeight,_),lineGap:A(L&&L.sTypoLineGap,g&&g.lineGap),supportsCodePoint(F){return l.U.codeToGlyph(M,F)>0},forEachGlyph(F,V,Y,Q){let W=0;const N=1/I.unitsPerEm*V,B=w(M,F);let y=0;const k=S(M,B);return B.forEach((D,R)=>{if(D!==-1){let P=U[D];if(!P){const{cmds:J,crds:G}=l.U.glyphToPath(M,D);let z="",Z=0;for(let ue=0,ee=J.length;ue<ee;ue++){const se=c[J[ue]];z+=J[ue];for(let oe=1;oe<=se;oe++)z+=(oe>1?",":"")+G[Z++]}let q,j,X,fe;if(G.length){q=j=1/0,X=fe=-1/0;for(let ue=0,ee=G.length;ue<ee;ue+=2){let se=G[ue],oe=G[ue+1];se<q&&(q=se),oe<j&&(j=oe),se>X&&(X=se),oe>fe&&(fe=oe)}}else q=X=j=fe=0;P=U[D]={index:D,advanceWidth:M.hmtx.aWidth[D],xMin:q,yMin:j,xMax:X,yMax:fe,path:z}}Q.call(null,P,W+k[R*3]*N,k[R*3+1]*N,y),W+=k[R*3+2]*N,Y&&(W+=Y*V)}y+=F.codePointAt(y)>65535?2:1}),W}};return I}return function(U){const L=new Uint8Array(U,0,4),g=l._bin.readASCII(L,0,4);if(g==="wOFF")U=r(U);else if(g==="wOF2")throw new Error("woff2 fonts not supported");return T(l.parse(U)[0])}}const Xi=jt({name:"Typr Font Parser",dependencies:[zi,Hi,Vi],init(l,r,c){const u=l(),t=r();return c(u,t)}});function Yi(){return(function(l){var r=function(){this.buckets=new Map};r.prototype.add=function(S){var x=S>>5;this.buckets.set(x,(this.buckets.get(x)||0)|1<<(31&S))},r.prototype.has=function(S){var x=this.buckets.get(S>>5);return x!==void 0&&(x&1<<(31&S))!=0},r.prototype.serialize=function(){var S=[];return this.buckets.forEach((function(x,A){S.push((+A).toString(36)+":"+x.toString(36))})),S.join(",")},r.prototype.deserialize=function(S){var x=this;this.buckets.clear(),S.split(",").forEach((function(A){var T=A.split(":");x.buckets.set(parseInt(T[0],36),parseInt(T[1],36))}))};var c=Math.pow(2,8),u=c-1,t=~u;function e(S){var x=(function(T){return T&t})(S).toString(16),A=(function(T){return(T&t)+c-1})(S).toString(16);return"codepoint-index/plane"+(S>>16)+"/"+x+"-"+A+".json"}function n(S,x){var A=S&u,T=x.codePointAt(A/6|0);return((T=(T||48)-48)&1<<A%6)!=0}function o(S,x){var A;(A=S,A.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(T){return T.split("-").map((function(M){return parseInt(M.trim(),16)}))}))).forEach((function(T){var M=T[0],U=T[1];U===void 0&&(U=M),x(M,U)}))}function a(S,x){o(S,(function(A,T){for(var M=A;M<=T;M++)x(M)}))}var s={},i={},d=new WeakMap,f="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function h(S){var x=d.get(S);return x||(x=new r,a(S.ranges,(function(A){return x.add(A)})),d.set(S,x)),x}var m,p=new Map;function v(S,x,A){return S[x]?x:S[A]?A:(function(T){for(var M in T)return M})(S)}function E(S,x){var A=x;if(!S.includes(A)){A=1/0;for(var T=0;T<S.length;T++)Math.abs(S[T]-x)<Math.abs(A-x)&&(A=S[T])}return A}function w(S){return m||(m=new Set,a("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(x){m.add(x)}))),m.has(S)}return l.CodePointSet=r,l.clearCache=function(){s={},i={}},l.getFontsForString=function(S,x){x===void 0&&(x={});var A,T=x.lang;T===void 0&&(T=new RegExp("\\p{Script=Hangul}","u").test(A=S)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(A)?"ja":"en");var M=x.category;M===void 0&&(M="sans-serif");var U=x.style;U===void 0&&(U="normal");var L=x.weight;L===void 0&&(L=400);var g=(x.dataUrl||f).replace(/\/$/g,""),O=new Map,_=new Uint8Array(S.length),I={},F={},V=new Array(S.length),Y=new Map,Q=!1;function W(y){var k=p.get(y);return k||(k=fetch(g+"/"+y).then((function(D){if(!D.ok)throw new Error(D.statusText);return D.json().then((function(R){if(!Array.isArray(R)||R[0]!==1)throw new Error("Incorrect schema version; need 1, got "+R[0]);return R[1]}))})).catch((function(D){if(g!==f)return Q||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+g+'", trying default CDN. '+D.message),Q=!0),g=f,p.delete(y),W(y);throw D})),p.set(y,k)),k}for(var N=function(y){var k=S.codePointAt(y),D=e(k);V[y]=D,s[D]||Y.has(D)||Y.set(D,W(D).then((function(R){s[D]=R}))),k>65535&&(y++,B=y)},B=0;B<S.length;B++)N(B);return Promise.all(Y.values()).then((function(){Y.clear();for(var y=function(D){var R=S.codePointAt(D),P=null,J=s[V[D]],G=void 0;for(var z in J){var Z=F[z];if(Z===void 0&&(Z=F[z]=new RegExp(z).test(T||"en")),Z){for(var q in G=z,J[z])if(n(R,J[z][q])){P=q;break}break}}if(!P){e:for(var j in J)if(j!==G){for(var X in J[j])if(n(R,J[j][X])){P=X;break e}}}P||(console.debug("No font coverage for U+"+R.toString(16)),P="latin"),V[D]=P,i[P]||Y.has(P)||Y.set(P,W("font-meta/"+P+".json").then((function(fe){i[P]=fe}))),R>65535&&(D++,k=D)},k=0;k<S.length;k++)y(k);return Promise.all(Y.values())})).then((function(){for(var y,k=null,D=0;D<S.length;D++){var R=S.codePointAt(D);if(k&&(w(R)||h(k).has(R)))_[D]=_[D-1];else{k=i[V[D]];var P=I[k.id];if(!P){var J=k.typeforms,G=v(J,M,"sans-serif"),z=v(J[G],U,"normal"),Z=E((y=J[G])===null||y===void 0?void 0:y[z],L);P=I[k.id]=g+"/font-files/"+k.id+"/"+G+"."+z+"."+Z+".woff"}var q=O.get(P);q==null&&(q=O.size,O.set(P,q)),_[D]=q}R>65535&&(D++,_[D]=_[D-1])}return{fontUrls:Array.from(O.keys()),chars:_}}))},Object.defineProperty(l,"__esModule",{value:!0}),l})({})}function Ji(l,r){const c=Object.create(null),u=Object.create(null);function t(n,o){const a=s=>{console.error(`Failure loading font ${n}`,s)};try{const s=new XMLHttpRequest;s.open("get",n,!0),s.responseType="arraybuffer",s.onload=function(){if(s.status>=400)a(new Error(s.statusText));else if(s.status>0)try{const i=l(s.response);i.src=n,o(i)}catch(i){a(i)}},s.onerror=a,s.send()}catch(s){a(s)}}function e(n,o){let a=c[n];a?o(a):u[n]?u[n].push(o):(u[n]=[o],t(n,s=>{s.src=n,c[n]=s,u[n].forEach(i=>i(s)),delete u[n]}))}return function(n,o,{lang:a,fonts:s=[],style:i="normal",weight:d="normal",unicodeFontsURL:f}={}){const h=new Uint8Array(n.length),m=[];n.length||w();const p=new Map,v=[];if(i!=="italic"&&(i="normal"),typeof d!="number"&&(d=d==="bold"?700:400),s&&!Array.isArray(s)&&(s=[s]),s=s.slice().filter(x=>!x.lang||x.lang.test(a)).reverse(),s.length){let M=0;(function U(L=0){for(let g=L,O=n.length;g<O;g++){const _=n.codePointAt(g);if(M===1&&m[h[g-1]].supportsCodePoint(_)||g>0&&/\s/.test(n[g]))h[g]=h[g-1],M===2&&(v[v.length-1][1]=g);else for(let I=h[g],F=s.length;I<=F;I++)if(I===F){const V=M===2?v[v.length-1]:v[v.length]=[g,g];V[1]=g,M=2}else{h[g]=I;const{src:V,unicodeRange:Y}=s[I];if(!Y||S(_,Y)){const Q=c[V];if(!Q){e(V,()=>{U(g)});return}if(Q.supportsCodePoint(_)){let W=p.get(Q);typeof W!="number"&&(W=m.length,m.push(Q),p.set(Q,W)),h[g]=W,M=1;break}}}_>65535&&g+1<O&&(h[g+1]=h[g],g++,M===2&&(v[v.length-1][1]=g))}E()})()}else v.push([0,n.length-1]),E();function E(){if(v.length){const x=v.map(A=>n.substring(A[0],A[1]+1)).join(`
`);r.getFontsForString(x,{lang:a||void 0,style:i,weight:d,dataUrl:f}).then(({fontUrls:A,chars:T})=>{const M=m.length;let U=0;v.forEach(g=>{for(let O=0,_=g[1]-g[0];O<=_;O++)h[g[0]+O]=T[U++]+M;U++});let L=0;A.forEach((g,O)=>{e(g,_=>{m[O+M]=_,++L===A.length&&w()})})})}else w()}function w(){o({chars:h,fonts:m})}function S(x,A){for(let T=0;T<A.length;T++){const[M,U=M]=A[T];if(M<=x&&x<=U)return!0}return!1}}}const Ki=jt({name:"FontResolver",dependencies:[Ji,Xi,Yi],init(l,r,c){return l(r,c())}});function Qi(l,r){const u=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,t="[^\\S\\u00A0]",e=new RegExp(`${t}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function n({text:m,lang:p,fonts:v,style:E,weight:w,preResolvedFonts:S,unicodeFontsURL:x},A){const T=({chars:M,fonts:U})=>{let L,g;const O=[];for(let _=0;_<M.length;_++)M[_]!==g?(g=M[_],O.push(L={start:_,end:_,fontObj:U[M[_]]})):L.end=_;A(O)};S?T(S):l(m,T,{lang:p,fonts:v,style:E,weight:w,unicodeFontsURL:x})}function o({text:m="",font:p,lang:v,sdfGlyphSize:E=64,fontSize:w=400,fontWeight:S=1,fontStyle:x="normal",letterSpacing:A=0,lineHeight:T="normal",maxWidth:M=1/0,direction:U,textAlign:L="left",textIndent:g=0,whiteSpace:O="normal",overflowWrap:_="normal",anchorX:I=0,anchorY:F=0,metricsOnly:V=!1,unicodeFontsURL:Y,preResolvedFonts:Q=null,includeCaretPositions:W=!1,chunkedBoundsSize:N=8192,colorRanges:B=null},y){const k=d(),D={fontLoad:0,typesetting:0};m.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),m=m.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),w=+w,A=+A,M=+M,T=T||"normal",g=+g,n({text:m,lang:v,style:x,weight:S,fonts:typeof p=="string"?[{src:p}]:p,unicodeFontsURL:Y,preResolvedFonts:Q},R=>{D.fontLoad=d()-k;const P=isFinite(M);let J=null,G=null,z=null,Z=null,q=null,j=null,X=null,fe=null,ue=0,ee=0,se=O!=="nowrap";const oe=new Map,K=d();let ae=g,ne=0,H=new f;const pe=[H];R.forEach(re=>{const{fontObj:le}=re,{ascender:he,descender:ve,unitsPerEm:Ae,lineGap:Fe,capHeight:ge,xHeight:be}=le;let de=oe.get(le);if(!de){const me=w/Ae,ke=T==="normal"?(he-ve+Fe)*me:T*w,yt=(ke-(he-ve)*me)/2,Ce=Math.min(ke,(he-ve)*me),_e=(he+ve)/2*me+Ce/2;de={index:oe.size,src:le.src,fontObj:le,fontSizeMult:me,unitsPerEm:Ae,ascender:he*me,descender:ve*me,capHeight:ge*me,xHeight:be*me,lineHeight:ke,baseline:-yt-he*me,caretTop:_e,caretBottom:_e-Ce},oe.set(le,de)}const{fontSizeMult:De}=de,Ee=m.slice(re.start,re.end+1);let Xe,Ue;le.forEachGlyph(Ee,w,A,(me,ke,yt,Ce)=>{ke+=ne,Ce+=re.start,Xe=ke,Ue=me;const _e=m.charAt(Ce),Re=me.advanceWidth*De,Te=H.count;let ye;if("isEmpty"in me||(me.isWhitespace=!!_e&&new RegExp(t).test(_e),me.canBreakAfter=!!_e&&e.test(_e),me.isEmpty=me.xMin===me.xMax||me.yMin===me.yMax||u.test(_e)),!me.isWhitespace&&!me.isEmpty&&ee++,se&&P&&!me.isWhitespace&&ke+Re+ae>M&&Te){if(H.glyphAt(Te-1).glyphObj.canBreakAfter)ye=new f,ae=-ke;else for(let He=Te;He--;)if(He===0&&_==="break-word"){ye=new f,ae=-ke;break}else if(H.glyphAt(He).glyphObj.canBreakAfter){ye=H.splitAt(He+1);const je=ye.glyphAt(0).x;ae-=je;for(let Ie=ye.count;Ie--;)ye.glyphAt(Ie).x-=je;break}ye&&(H.isSoftWrapped=!0,H=ye,pe.push(H),ue=M)}let Pe=H.glyphAt(H.count);Pe.glyphObj=me,Pe.x=ke+ae,Pe.y=yt,Pe.width=Re,Pe.charIndex=Ce,Pe.fontData=de,_e===`
`&&(H=new f,pe.push(H),ae=-(ke+Re+A*w)+g)}),ne=Xe+Ue.advanceWidth*De+A*w});let te=0;pe.forEach(re=>{let le=!0;for(let he=re.count;he--;){const ve=re.glyphAt(he);le&&!ve.glyphObj.isWhitespace&&(re.width=ve.x+ve.width,re.width>ue&&(ue=re.width),le=!1);let{lineHeight:Ae,capHeight:Fe,xHeight:ge,baseline:be}=ve.fontData;Ae>re.lineHeight&&(re.lineHeight=Ae);const de=be-re.baseline;de<0&&(re.baseline+=de,re.cap+=de,re.ex+=de),re.cap=Math.max(re.cap,re.baseline+Fe),re.ex=Math.max(re.ex,re.baseline+ge)}re.baseline-=te,re.cap-=te,re.ex-=te,te+=re.lineHeight});let ie=0,$=0;if(I&&(typeof I=="number"?ie=-I:typeof I=="string"&&(ie=-ue*(I==="left"?0:I==="center"?.5:I==="right"?1:s(I)))),F&&(typeof F=="number"?$=-F:typeof F=="string"&&($=F==="top"?0:F==="top-baseline"?-pe[0].baseline:F==="top-cap"?-pe[0].cap:F==="top-ex"?-pe[0].ex:F==="middle"?te/2:F==="bottom"?te:F==="bottom-baseline"?-pe[pe.length-1].baseline:s(F)*te)),!V){const re=r.getEmbeddingLevels(m,U);J=new Uint16Array(ee),G=new Uint8Array(ee),z=new Float32Array(ee*2),Z={},X=[1/0,1/0,-1/0,-1/0],fe=[],W&&(j=new Float32Array(m.length*4)),B&&(q=new Uint8Array(ee*3));let le=0,he=-1,ve=-1,Ae,Fe;if(pe.forEach((ge,be)=>{let{count:de,width:De}=ge;if(de>0){let Ee=0;for(let Ce=de;Ce--&&ge.glyphAt(Ce).glyphObj.isWhitespace;)Ee++;let Xe=0,Ue=0;if(L==="center")Xe=(ue-De)/2;else if(L==="right")Xe=ue-De;else if(L==="justify"&&ge.isSoftWrapped){let Ce=0;for(let _e=de-Ee;_e--;)ge.glyphAt(_e).glyphObj.isWhitespace&&Ce++;Ue=(ue-De)/Ce}if(Ue||Xe){let Ce=0;for(let _e=0;_e<de;_e++){let Re=ge.glyphAt(_e);const Te=Re.glyphObj;Re.x+=Xe+Ce,Ue!==0&&Te.isWhitespace&&_e<de-Ee&&(Ce+=Ue,Re.width+=Ue)}}const me=r.getReorderSegments(m,re,ge.glyphAt(0).charIndex,ge.glyphAt(ge.count-1).charIndex);for(let Ce=0;Ce<me.length;Ce++){const[_e,Re]=me[Ce];let Te=1/0,ye=-1/0;for(let Pe=0;Pe<de;Pe++)if(ge.glyphAt(Pe).charIndex>=_e){let He=Pe,je=Pe;for(;je<de;je++){let Ie=ge.glyphAt(je);if(Ie.charIndex>Re)break;je<de-Ee&&(Te=Math.min(Te,Ie.x),ye=Math.max(ye,Ie.x+Ie.width))}for(let Ie=He;Ie<je;Ie++){const tt=ge.glyphAt(Ie);tt.x=ye-(tt.x+tt.width-Te)}break}}let ke;const yt=Ce=>ke=Ce;for(let Ce=0;Ce<de;Ce++){const _e=ge.glyphAt(Ce);ke=_e.glyphObj;const Re=ke.index,Te=re.levels[_e.charIndex]&1;if(Te){const ye=r.getMirroredCharacter(m[_e.charIndex]);ye&&_e.fontData.fontObj.forEachGlyph(ye,0,0,yt)}if(W){const{charIndex:ye,fontData:Pe}=_e,He=_e.x+ie,je=_e.x+_e.width+ie;j[ye*4]=Te?je:He,j[ye*4+1]=Te?He:je,j[ye*4+2]=ge.baseline+Pe.caretBottom+$,j[ye*4+3]=ge.baseline+Pe.caretTop+$;const Ie=ye-he;Ie>1&&i(j,he,Ie),he=ye}if(B){const{charIndex:ye}=_e;for(;ye>ve;)ve++,B.hasOwnProperty(ve)&&(Fe=B[ve])}if(!ke.isWhitespace&&!ke.isEmpty){const ye=le++,{fontSizeMult:Pe,src:He,index:je}=_e.fontData,Ie=Z[He]||(Z[He]={});Ie[Re]||(Ie[Re]={path:ke.path,pathBounds:[ke.xMin,ke.yMin,ke.xMax,ke.yMax]});const tt=_e.x+ie,gt=_e.y+ge.baseline+$;z[ye*2]=tt,z[ye*2+1]=gt;const ht=tt+ke.xMin*Pe,bt=gt+ke.yMin*Pe,Ct=tt+ke.xMax*Pe,mt=gt+ke.yMax*Pe;ht<X[0]&&(X[0]=ht),bt<X[1]&&(X[1]=bt),Ct>X[2]&&(X[2]=Ct),mt>X[3]&&(X[3]=mt),ye%N===0&&(Ae={start:ye,end:ye,rect:[1/0,1/0,-1/0,-1/0]},fe.push(Ae)),Ae.end++;const Ve=Ae.rect;if(ht<Ve[0]&&(Ve[0]=ht),bt<Ve[1]&&(Ve[1]=bt),Ct>Ve[2]&&(Ve[2]=Ct),mt>Ve[3]&&(Ve[3]=mt),J[ye]=Re,G[ye]=je,B){const Mt=ye*3;q[Mt]=Fe>>16&255,q[Mt+1]=Fe>>8&255,q[Mt+2]=Fe&255}}}}}),j){const ge=m.length-he;ge>1&&i(j,he,ge)}}const Se=[];oe.forEach(({index:re,src:le,unitsPerEm:he,ascender:ve,descender:Ae,lineHeight:Fe,capHeight:ge,xHeight:be})=>{Se[re]={src:le,unitsPerEm:he,ascender:ve,descender:Ae,lineHeight:Fe,capHeight:ge,xHeight:be}}),D.typesetting=d()-K,y({glyphIds:J,glyphFontIndices:G,glyphPositions:z,glyphData:Z,fontData:Se,caretPositions:j,glyphColors:q,chunkedBounds:fe,fontSize:w,topBaseline:$+pe[0].baseline,blockBounds:[ie,$-te,ie+ue,$],visibleBounds:X,timings:D})})}function a(m,p){o({...m,metricsOnly:!0},v=>{const[E,w,S,x]=v.blockBounds;p({width:S-E,height:x-w})})}function s(m){let p=m.match(/^([\d.]+)%$/),v=p?parseFloat(p[1]):NaN;return isNaN(v)?0:v/100}function i(m,p,v){const E=m[p*4],w=m[p*4+1],S=m[p*4+2],x=m[p*4+3],A=(w-E)/v;for(let T=0;T<v;T++){const M=(p+T)*4;m[M]=E+A*T,m[M+1]=E+A*(T+1),m[M+2]=S,m[M+3]=x}}function d(){return(self.performance||Date).now()}function f(){this.data=[]}const h=["glyphObj","x","y","width","charIndex","fontData"];return f.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/h.length)},glyphAt(m){let p=f.flyweight;return p.data=this.data,p.index=m,p},splitAt(m){let p=new f;return p.data=this.data.splice(m*h.length),p}},f.flyweight=h.reduce((m,p,v,E)=>(Object.defineProperty(m,p,{get(){return this.data[this.index*h.length+v]},set(w){this.data[this.index*h.length+v]=w}}),m),{data:null,index:0}),{typeset:o,measure:a}}const Pt=()=>(self.performance||Date).now(),Nr=so();let _a;function qi(l,r,c,u,t,e,n,o,a,s,i=!0){return i?$i(l,r,c,u,t,e,n,o,a,s).then(null,d=>(_a||(console.warn("WebGL SDF generation failed, falling back to JS",d),_a=!0),wa(l,r,c,u,t,e,n,o,a,s))):wa(l,r,c,u,t,e,n,o,a,s)}const Pr=[],Zi=5;let Cn=0;function lo(){const l=Pt();for(;Pr.length&&Pt()-l<Zi;)Pr.shift()();Cn=Pr.length?setTimeout(lo,0):0}const $i=(...l)=>new Promise((r,c)=>{Pr.push(()=>{const u=Pt();try{Nr.webgl.generateIntoCanvas(...l),r({timing:Pt()-u})}catch(t){c(t)}}),Cn||(Cn=setTimeout(lo,0))}),el=4,tl=2e3,Sa={};let rl=0;function wa(l,r,c,u,t,e,n,o,a,s){const i="TroikaTextSDFGenerator_JS_"+rl++%el;let d=Sa[i];return d||(d=Sa[i]={workerModule:jt({name:i,workerId:i,dependencies:[so,Pt],init(f,h){const m=f().javascript.generate;return function(...p){const v=h();return{textureData:m(...p),timing:h()-v}}},getTransferables(f){return[f.textureData.buffer]}}),requests:0,idleTimer:null}),d.requests++,clearTimeout(d.idleTimer),d.workerModule(l,r,c,u,t,e).then(({textureData:f,timing:h})=>{const m=Pt(),p=new Uint8Array(f.length*4);for(let v=0;v<f.length;v++)p[v*4+s]=f[v];return Nr.webglUtils.renderImageData(n,p,o,a,l,r,1<<3-s),h+=Pt()-m,--d.requests===0&&(d.idleTimer=setTimeout(()=>{Di(i)},tl)),{timing:h}})}function nl(l){l._warm||(Nr.webgl.isSupported(l),l._warm=!0)}const al=Nr.webglUtils.resizeWebGLCanvasWithoutClearing,er={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},ol=new St;function Bt(){return(self.performance||Date).now()}const ka=Object.create(null);function co(l,r){l=ll({},l);const c=Bt(),u=[];if(l.font&&u.push({label:"user",src:cl(l.font)}),l.font=u,l.text=""+l.text,l.sdfGlyphSize=l.sdfGlyphSize||er.sdfGlyphSize,l.unicodeFontsURL=l.unicodeFontsURL||er.unicodeFontsURL,l.colorRanges!=null){let f={};for(let h in l.colorRanges)if(l.colorRanges.hasOwnProperty(h)){let m=l.colorRanges[h];typeof m!="number"&&(m=ol.set(m).getHex()),f[h]=m}l.colorRanges=f}Object.freeze(l);const{textureWidth:t,sdfExponent:e}=er,{sdfGlyphSize:n}=l,o=t/n*4;let a=ka[n];if(!a){const f=document.createElement("canvas");f.width=t,f.height=n*256/o,a=ka[n]={glyphCount:0,sdfGlyphSize:n,sdfCanvas:f,sdfTexture:new Jo(f,void 0,void 0,void 0,Fr,Fr),contextLost:!1,glyphsByFont:new Map},a.sdfTexture.generateMipmaps=!1,sl(a)}const{sdfTexture:s,sdfCanvas:i}=a;ho(l).then(f=>{const{glyphIds:h,glyphFontIndices:m,fontData:p,glyphPositions:v,fontSize:E,timings:w}=f,S=[],x=new Float32Array(h.length*4);let A=0,T=0;const M=Bt(),U=p.map(I=>{let F=a.glyphsByFont.get(I.src);return F||a.glyphsByFont.set(I.src,F=new Map),F});h.forEach((I,F)=>{const V=m[F],{src:Y,unitsPerEm:Q}=p[V];let W=U[V].get(I);if(!W){const{path:D,pathBounds:R}=f.glyphData[Y][I],P=Math.max(R[2]-R[0],R[3]-R[1])/n*(er.sdfMargin*n+.5),J=a.glyphCount++,G=[R[0]-P,R[1]-P,R[2]+P,R[3]+P];U[V].set(I,W={path:D,atlasIndex:J,sdfViewBox:G}),S.push(W)}const{sdfViewBox:N}=W,B=v[T++],y=v[T++],k=E/Q;x[A++]=B+N[0]*k,x[A++]=y+N[1]*k,x[A++]=B+N[2]*k,x[A++]=y+N[3]*k,h[F]=W.atlasIndex}),w.quads=(w.quads||0)+(Bt()-M);const L=Bt();w.sdf={};const g=i.height,O=Math.ceil(a.glyphCount/o),_=Math.pow(2,Math.ceil(Math.log2(O*n)));_>g&&(console.info(`Increasing SDF texture size ${g}->${_}`),al(i,t,_),s.dispose()),Promise.all(S.map(I=>uo(I,a,l.gpuAccelerateSDF).then(({timing:F})=>{w.sdf[I.atlasIndex]=F}))).then(()=>{S.length&&!a.contextLost&&(fo(a),s.needsUpdate=!0),w.sdfTotal=Bt()-L,w.total=Bt()-c,r(Object.freeze({parameters:l,sdfTexture:s,sdfGlyphSize:n,sdfExponent:e,glyphBounds:x,glyphAtlasIndices:h,glyphColors:f.glyphColors,caretPositions:f.caretPositions,chunkedBounds:f.chunkedBounds,ascender:f.ascender,descender:f.descender,lineHeight:f.lineHeight,capHeight:f.capHeight,xHeight:f.xHeight,topBaseline:f.topBaseline,blockBounds:f.blockBounds,visibleBounds:f.visibleBounds,timings:f.timings}))})}),Promise.resolve().then(()=>{a.contextLost||nl(i)})}function uo({path:l,atlasIndex:r,sdfViewBox:c},{sdfGlyphSize:u,sdfCanvas:t,contextLost:e},n){if(e)return Promise.resolve({timing:-1});const{textureWidth:o,sdfExponent:a}=er,s=Math.max(c[2]-c[0],c[3]-c[1]),i=Math.floor(r/4),d=i%(o/u)*u,f=Math.floor(i/(o/u))*u,h=r%4;return qi(u,u,l,c,s,a,t,d,f,h,n)}function sl(l){const r=l.sdfCanvas;r.addEventListener("webglcontextlost",c=>{console.log("Context Lost",c),c.preventDefault(),l.contextLost=!0}),r.addEventListener("webglcontextrestored",c=>{console.log("Context Restored",c),l.contextLost=!1;const u=[];l.glyphsByFont.forEach(t=>{t.forEach(e=>{u.push(uo(e,l,!0))})}),Promise.all(u).then(()=>{fo(l),l.sdfTexture.needsUpdate=!0})})}function il({font:l,characters:r,sdfGlyphSize:c},u){let t=Array.isArray(r)?r.join(`
`):""+r;co({font:l,sdfGlyphSize:c,text:t},u)}function ll(l,r){for(let c in r)r.hasOwnProperty(c)&&(l[c]=r[c]);return l}let Mr;function cl(l){return Mr||(Mr=typeof document>"u"?{}:document.createElement("a")),Mr.href=l,Mr.href}function fo(l){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:r,sdfTexture:c}=l,{width:u,height:t}=r,e=l.sdfCanvas.getContext("webgl");let n=c.image.data;(!n||n.length!==u*t*4)&&(n=new Uint8Array(u*t*4),c.image={width:u,height:t,data:n},c.flipY=!1,c.isDataTexture=!0),e.readPixels(0,0,u,t,e.RGBA,e.UNSIGNED_BYTE,n)}}const ul=jt({name:"Typesetter",dependencies:[Qi,Ki,Ii],init(l,r,c){return l(r,c())}}),ho=jt({name:"Typesetter",dependencies:[ul],init(l){return function(r){return new Promise(c=>{l.typeset(r,c)})}},getTransferables(l){const r=[];for(let c in l)l[c]&&l[c].buffer&&r.push(l[c].buffer);return r}});ho.onMainThread;const Ca={};function dl(l){let r=Ca[l];return r||(r=Ca[l]=new An(1,1,l,l).translate(.5,.5,0)),r}const fl="aTroikaGlyphBounds",Ma="aTroikaGlyphIndex",hl="aTroikaGlyphColor";class ml extends ja{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Mn,this.boundingBox=new sr}computeBoundingSphere(){}computeBoundingBox(){}set detail(r){if(r!==this._detail){this._detail=r,(typeof r!="number"||r<1)&&(r=1);let c=dl(r);["position","normal","uv"].forEach(u=>{this.attributes[u]=c.attributes[u].clone()}),this.setIndex(c.getIndex().clone())}}get detail(){return this._detail}set curveRadius(r){r!==this._curveRadius&&(this._curveRadius=r,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(r,c,u,t,e){this.updateAttributeData(fl,r,4),this.updateAttributeData(Ma,c,1),this.updateAttributeData(hl,e,3),this._blockBounds=u,this._chunkedBounds=t,this.instanceCount=c.length,this._updateBounds()}_updateBounds(){const r=this._blockBounds;if(r){const{curveRadius:c,boundingBox:u}=this;if(c){const{PI:t,floor:e,min:n,max:o,sin:a,cos:s}=Math,i=t/2,d=t*2,f=Math.abs(c),h=r[0]/f,m=r[2]/f,p=e((h+i)/d)!==e((m+i)/d)?-f:n(a(h)*f,a(m)*f),v=e((h-i)/d)!==e((m-i)/d)?f:o(a(h)*f,a(m)*f),E=e((h+t)/d)!==e((m+t)/d)?f*2:o(f-s(h)*f,f-s(m)*f);u.min.set(p,r[1],c<0?-E:0),u.max.set(v,r[3],c<0?0:E)}else u.min.set(r[0],r[1],0),u.max.set(r[2],r[3],0);u.getBoundingSphere(this.boundingSphere)}}applyClipRect(r){let c=this.getAttribute(Ma).count,u=this._chunkedBounds;if(u)for(let t=u.length;t--;){c=u[t].end;let e=u[t].rect;if(e[1]<r.w&&e[3]>r.y&&e[0]<r.z&&e[2]>r.x)break}this.instanceCount=c}updateAttributeData(r,c,u){const t=this.getAttribute(r);c?t&&t.array.length===c.length?(t.array.set(c),t.needsUpdate=!0):(this.setAttribute(r,new Yo(c,u)),delete this._maxInstanceCount,this.dispose()):t&&this.deleteAttribute(r)}}const pl=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,vl=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,yl=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,gl=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function bl(l){const r=kn(l,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new st},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new wt(0,0,0,0)},uTroikaClipRect:{value:new wt(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new st},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new St},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Ko},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:pl,vertexTransform:vl,fragmentDefs:yl,fragmentColorTransform:gl,customRewriter({vertexShader:c,fragmentShader:u}){let t=/\buniform\s+vec3\s+diffuse\b/;return t.test(u)&&(u=u.replace(t,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),t.test(c)||(c=c.replace(io,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:c,fragmentShader:u}}});return r.transparent=!0,r.forceSinglePass=!0,Object.defineProperties(r,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),r}const Fn=new Xo({color:16777215,side:Ba,transparent:!0}),Aa=8421504,Ua=new Or,Ar=new xe,fn=new xe,Zt=[],xl=new xe,hn="+x+y";function Ea(l){return Array.isArray(l)?l[0]:l}let mo=()=>{const l=new Lr(new An(1,1),Fn);return mo=()=>l,l},po=()=>{const l=new Lr(new An(1,1,32,1),Fn);return po=()=>l,l};const _l={type:"syncstart"},Sl={type:"synccomplete"},vo=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],wl=vo.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let yo=class extends Lr{constructor(){const r=new ml;super(r,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=Aa,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=hn,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(r){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(r):(this._isSyncing=!0,this.dispatchEvent(_l),co({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},c=>{this._isSyncing=!1,this._textRenderInfo=c,this.geometry.updateGlyphs(c.glyphBounds,c.glyphAtlasIndices,c.blockBounds,c.chunkedBounds,c.glyphColors);const u=this._queuedSyncs;u&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{u.forEach(t=>t&&t())})),this.dispatchEvent(Sl),r&&r()})))}onBeforeRender(r,c,u,t,e,n){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(r){return bl(r)}get material(){let r=this._derivedMaterial;const c=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Fn.clone());if((!r||!r.isDerivedFrom(c))&&(r=this._derivedMaterial=this.createDerivedMaterial(c),c.addEventListener("dispose",function u(){c.removeEventListener("dispose",u),r.dispose()})),this.hasOutline()){let u=r._outlineMtl;return u||(u=r._outlineMtl=Object.create(r,{id:{value:r.id+.1}}),u.isTextOutlineMaterial=!0,u.depthWrite=!1,u.map=null,r.addEventListener("dispose",function t(){r.removeEventListener("dispose",t),u.dispose()})),[u,r]}else return r}set material(r){r&&r.isTroikaTextMaterial?(this._derivedMaterial=r,this._baseMaterial=r.baseMaterial):this._baseMaterial=r}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(r){this.geometry.detail=r}get curveRadius(){return this.geometry.curveRadius}set curveRadius(r){this.geometry.curveRadius=r}get customDepthMaterial(){return Ea(this.material).getDepthMaterial()}set customDepthMaterial(r){}get customDistanceMaterial(){return Ea(this.material).getDistanceMaterial()}set customDistanceMaterial(r){}_prepareForRender(r){const c=r.isTextOutlineMaterial,u=r.uniforms,t=this.textRenderInfo;if(t){const{sdfTexture:o,blockBounds:a}=t;u.uTroikaSDFTexture.value=o,u.uTroikaSDFTextureSize.value.set(o.image.width,o.image.height),u.uTroikaSDFGlyphSize.value=t.sdfGlyphSize,u.uTroikaSDFExponent.value=t.sdfExponent,u.uTroikaTotalBounds.value.fromArray(a),u.uTroikaUseGlyphColors.value=!c&&!!t.glyphColors;let s=0,i=0,d=0,f,h,m,p=0,v=0;if(c){let{outlineWidth:w,outlineOffsetX:S,outlineOffsetY:x,outlineBlur:A,outlineOpacity:T}=this;s=this._parsePercent(w)||0,i=Math.max(0,this._parsePercent(A)||0),f=T,p=this._parsePercent(S)||0,v=this._parsePercent(x)||0}else d=Math.max(0,this._parsePercent(this.strokeWidth)||0),d&&(m=this.strokeColor,u.uTroikaStrokeColor.value.set(m??Aa),h=this.strokeOpacity,h==null&&(h=1)),f=this.fillOpacity;u.uTroikaEdgeOffset.value=s,u.uTroikaPositionOffset.value.set(p,v),u.uTroikaBlurRadius.value=i,u.uTroikaStrokeWidth.value=d,u.uTroikaStrokeOpacity.value=h,u.uTroikaFillOpacity.value=f??1,u.uTroikaCurveRadius.value=this.curveRadius||0;let E=this.clipRect;if(E&&Array.isArray(E)&&E.length===4)u.uTroikaClipRect.value.fromArray(E);else{const w=(this.fontSize||.1)*100;u.uTroikaClipRect.value.set(a[0]-w,a[1]-w,a[2]+w,a[3]+w)}this.geometry.applyClipRect(u.uTroikaClipRect.value)}u.uTroikaSDFDebug.value=!!this.debugSDF,r.polygonOffset=!!this.depthOffset,r.polygonOffsetFactor=r.polygonOffsetUnits=this.depthOffset||0;const e=c?this.outlineColor||0:this.color;if(e==null)delete r.color;else{const o=r.hasOwnProperty("color")?r.color:r.color=new St;(e!==o._input||typeof e=="object")&&o.set(o._input=e)}let n=this.orientation||hn;if(n!==r._orientation){let o=u.uTroikaOrient.value;n=n.replace(/[^-+xyz]/g,"");let a=n!==hn&&n.match(/^([-+])([xyz])([-+])([xyz])$/);if(a){let[,s,i,d,f]=a;Ar.set(0,0,0)[i]=s==="-"?1:-1,fn.set(0,0,0)[f]=d==="-"?-1:1,Ua.lookAt(xl,Ar.cross(fn),fn),o.setFromMatrix4(Ua)}else o.identity();r._orientation=n}}_parsePercent(r){if(typeof r=="string"){let c=r.match(/^(-?[\d.]+)%$/),u=c?parseFloat(c[1]):NaN;r=(isNaN(u)?0:u/100)*this.fontSize}return r}localPositionToTextCoords(r,c=new st){c.copy(r);const u=this.curveRadius;return u&&(c.x=Math.atan2(r.x,Math.abs(u)-Math.abs(r.z))*Math.abs(u)),c}worldPositionToTextCoords(r,c=new st){return Ar.copy(r),this.localPositionToTextCoords(this.worldToLocal(Ar),c)}raycast(r,c){const{textRenderInfo:u,curveRadius:t}=this;if(u){const e=u.blockBounds,n=t?po():mo(),o=n.geometry,{position:a,uv:s}=o.attributes;for(let i=0;i<s.count;i++){let d=e[0]+s.getX(i)*(e[2]-e[0]);const f=e[1]+s.getY(i)*(e[3]-e[1]);let h=0;t&&(h=t-Math.cos(d/t)*t,d=Math.sin(d/t)*t),a.setXYZ(i,d,f,h)}o.boundingSphere=this.geometry.boundingSphere,o.boundingBox=this.geometry.boundingBox,n.matrixWorld=this.matrixWorld,n.material.side=this.material.side,Zt.length=0,n.raycast(r,Zt);for(let i=0;i<Zt.length;i++)Zt[i].object=this,c.push(Zt[i])}}copy(r){const c=this.geometry;return super.copy(r),this.geometry=c,wl.forEach(u=>{this[u]=r[u]}),this}clone(){return new this.constructor().copy(this)}};vo.forEach(l=>{const r="_private_"+l;Object.defineProperty(yo.prototype,l,{get(){return this[r]},set(c){c!==this[r]&&(this[r]=c,this._needsSync=!0)}})});new sr;new St;const tr=b.forwardRef(({sdfGlyphSize:l=64,anchorX:r="center",anchorY:c="middle",font:u,fontSize:t=1,children:e,characters:n,onSync:o,...a},s)=>{const i=ot(({invalidate:m})=>m),[d]=b.useState(()=>new yo),[f,h]=b.useMemo(()=>{const m=[];let p="";return b.Children.forEach(e,v=>{typeof v=="string"||typeof v=="number"?p+=v:m.push(v)}),[m,p]},[e]);return Po(()=>new Promise(m=>il({font:u,characters:n},m)),["troika-text",u,n]),b.useLayoutEffect(()=>{d.sync(()=>{i(),o&&o(d)})}),b.useEffect(()=>()=>d.dispose(),[d]),b.createElement("primitive",$e({object:d,ref:s,font:u,text:h,anchorX:r,anchorY:c,fontSize:t,sdfGlyphSize:l},a),f)});var kl=Object.defineProperty,Cl=(l,r,c)=>r in l?kl(l,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[r]=c,we=(l,r,c)=>(Cl(l,typeof r!="symbol"?r+"":r,c),c);function mn(l,r,c,u,t){let e;if(l=l.subarray||l.slice?l:l.buffer,c=c.subarray||c.slice?c:c.buffer,l=r?l.subarray?l.subarray(r,t&&r+t):l.slice(r,t&&r+t):l,c.set)c.set(l,u);else for(e=0;e<l.length;e++)c[e+u]=l[e];return c}function Ml(l){return l instanceof Float32Array?l:l instanceof za?l.getAttribute("position").array:l.map(r=>{const c=Array.isArray(r);return r instanceof xe?[r.x,r.y,r.z]:r instanceof st?[r.x,r.y,0]:c&&r.length===3?[r[0],r[1],r[2]]:c&&r.length===2?[r[0],r[1],0]:r}).flat()}class Al extends za{constructor(){super(),we(this,"type","MeshLine"),we(this,"isMeshLine",!0),we(this,"positions",[]),we(this,"previous",[]),we(this,"next",[]),we(this,"side",[]),we(this,"width",[]),we(this,"indices_array",[]),we(this,"uvs",[]),we(this,"counters",[]),we(this,"widthCallback",null),we(this,"_attributes"),we(this,"_points",[]),we(this,"points"),we(this,"matrixWorld",new Or),Object.defineProperties(this,{points:{enumerable:!0,get(){return this._points},set(r){this.setPoints(r,this.widthCallback)}}})}setMatrixWorld(r){this.matrixWorld=r}setPoints(r,c){if(r=Ml(r),this._points=r,this.widthCallback=c??null,this.positions=[],this.counters=[],r.length&&r[0]instanceof xe)for(let u=0;u<r.length;u++){const t=r[u],e=u/(r.length-1);this.positions.push(t.x,t.y,t.z),this.positions.push(t.x,t.y,t.z),this.counters.push(e),this.counters.push(e)}else for(let u=0;u<r.length;u+=3){const t=u/(r.length-1);this.positions.push(r[u],r[u+1],r[u+2]),this.positions.push(r[u],r[u+1],r[u+2]),this.counters.push(t),this.counters.push(t)}this.process()}compareV3(r,c){const u=r*6,t=c*6;return this.positions[u]===this.positions[t]&&this.positions[u+1]===this.positions[t+1]&&this.positions[u+2]===this.positions[t+2]}copyV3(r){const c=r*6;return[this.positions[c],this.positions[c+1],this.positions[c+2]]}process(){const r=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];let c,u;this.compareV3(0,r-1)?u=this.copyV3(r-2):u=this.copyV3(0),this.previous.push(u[0],u[1],u[2]),this.previous.push(u[0],u[1],u[2]);for(let t=0;t<r;t++){if(this.side.push(1),this.side.push(-1),this.widthCallback?c=this.widthCallback(t/(r-1)):c=1,this.width.push(c),this.width.push(c),this.uvs.push(t/(r-1),0),this.uvs.push(t/(r-1),1),t<r-1){u=this.copyV3(t),this.previous.push(u[0],u[1],u[2]),this.previous.push(u[0],u[1],u[2]);const e=t*2;this.indices_array.push(e,e+1,e+2),this.indices_array.push(e+2,e+1,e+3)}t>0&&(u=this.copyV3(t),this.next.push(u[0],u[1],u[2]),this.next.push(u[0],u[1],u[2]))}this.compareV3(r-1,0)?u=this.copyV3(1):u=this.copyV3(r-1),this.next.push(u[0],u[1],u[2]),this.next.push(u[0],u[1],u[2]),!this._attributes||this._attributes.position.count!==this.counters.length?this._attributes={position:new pt(new Float32Array(this.positions),3),previous:new pt(new Float32Array(this.previous),3),next:new pt(new Float32Array(this.next),3),side:new pt(new Float32Array(this.side),1),width:new pt(new Float32Array(this.width),1),uv:new pt(new Float32Array(this.uvs),2),index:new pt(new Uint16Array(this.indices_array),1),counters:new pt(new Float32Array(this.counters),1)}:(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}advance({x:r,y:c,z:u}){const t=this._attributes.position.array,e=this._attributes.previous.array,n=this._attributes.next.array,o=t.length;mn(t,0,e,0,o),mn(t,6,t,0,o-6),t[o-6]=r,t[o-5]=c,t[o-4]=u,t[o-3]=r,t[o-2]=c,t[o-1]=u,mn(t,6,n,0,o-6),n[o-6]=r,n[o-5]=c,n[o-4]=u,n[o-3]=r,n[o-2]=c,n[o-1]=u,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0}}const Ul=`
  #include <common>
  #include <logdepthbuf_pars_vertex>
  #include <fog_pars_vertex>
  #include <clipping_planes_pars_vertex>

  attribute vec3 previous;
  attribute vec3 next;
  attribute float side;
  attribute float width;
  attribute float counters;
  
  uniform vec2 resolution;
  uniform float lineWidth;
  uniform vec3 color;
  uniform float opacity;
  uniform float sizeAttenuation;
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  vec2 fix(vec4 i, float aspect) {
    vec2 res = i.xy / i.w;
    res.x *= aspect;
    return res;
  }
  
  void main() {
    float aspect = resolution.x / resolution.y;
    vColor = vec4(color, opacity);
    vUV = uv;
    vCounters = counters;
  
    mat4 m = projectionMatrix * modelViewMatrix;
    vec4 finalPosition = m * vec4(position, 1.0) * aspect;
    vec4 prevPos = m * vec4(previous, 1.0);
    vec4 nextPos = m * vec4(next, 1.0);
  
    vec2 currentP = fix(finalPosition, aspect);
    vec2 prevP = fix(prevPos, aspect);
    vec2 nextP = fix(nextPos, aspect);
  
    float w = lineWidth * width;
  
    vec2 dir;
    if (nextP == currentP) dir = normalize(currentP - prevP);
    else if (prevP == currentP) dir = normalize(nextP - currentP);
    else {
      vec2 dir1 = normalize(currentP - prevP);
      vec2 dir2 = normalize(nextP - currentP);
      dir = normalize(dir1 + dir2);
  
      vec2 perp = vec2(-dir1.y, dir1.x);
      vec2 miter = vec2(-dir.y, dir.x);
      //w = clamp(w / dot(miter, perp), 0., 4. * lineWidth * width);
    }
  
    //vec2 normal = (cross(vec3(dir, 0.), vec3(0., 0., 1.))).xy;
    vec4 normal = vec4(-dir.y, dir.x, 0., 1.);
    normal.xy *= .5 * w;
    //normal *= projectionMatrix;
    if (sizeAttenuation == 0.) {
      normal.xy *= finalPosition.w;
      normal.xy /= (vec4(resolution, 0., 1.) * projectionMatrix).xy * aspect;
    }
  
    finalPosition.xy += normal.xy * side;
    gl_Position = finalPosition;
    #include <logdepthbuf_vertex>
    #include <fog_vertex>
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    #include <clipping_planes_vertex>
    #include <fog_vertex>
  }
`,El=parseInt(Qo.replace(/\D+/g,"")),Tl=El>=154?"colorspace_fragment":"encodings_fragment",Pl=`
  #include <fog_pars_fragment>
  #include <logdepthbuf_pars_fragment>
  #include <clipping_planes_pars_fragment>
  
  uniform sampler2D map;
  uniform sampler2D alphaMap;
  uniform float useGradient;
  uniform float useMap;
  uniform float useAlphaMap;
  uniform float useDash;
  uniform float dashArray;
  uniform float dashOffset;
  uniform float dashRatio;
  uniform float visibility;
  uniform float alphaTest;
  uniform vec2 repeat;
  uniform vec3 gradient[2];
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  void main() {
    #include <logdepthbuf_fragment>
    vec4 diffuseColor = vColor;
    if (useGradient == 1.) diffuseColor = vec4(mix(gradient[0], gradient[1], vCounters), 1.0);
    if (useMap == 1.) diffuseColor *= texture2D(map, vUV * repeat);
    if (useAlphaMap == 1.) diffuseColor.a *= texture2D(alphaMap, vUV * repeat).a;
    if (diffuseColor.a < alphaTest) discard;
    if (useDash == 1.) diffuseColor.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));
    diffuseColor.a *= step(vCounters, visibility);
    #include <clipping_planes_fragment>
    gl_FragColor = diffuseColor;     
    #include <fog_fragment>
    #include <tonemapping_fragment>
    #include <${Tl}>
  }
`;class Fl extends Wa{constructor(r){super({uniforms:{...bn.fog,lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new St(16777215)},gradient:{value:[new St(16711680),new St(65280)]},opacity:{value:1},resolution:{value:new st(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},useGradient:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new st(1,1)}},vertexShader:Ul,fragmentShader:Pl}),we(this,"lineWidth"),we(this,"map"),we(this,"useMap"),we(this,"alphaMap"),we(this,"useAlphaMap"),we(this,"color"),we(this,"gradient"),we(this,"resolution"),we(this,"sizeAttenuation"),we(this,"dashArray"),we(this,"dashOffset"),we(this,"dashRatio"),we(this,"useDash"),we(this,"useGradient"),we(this,"visibility"),we(this,"repeat"),this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get(){return this.uniforms.lineWidth.value},set(c){this.uniforms.lineWidth.value=c}},map:{enumerable:!0,get(){return this.uniforms.map.value},set(c){this.uniforms.map.value=c}},useMap:{enumerable:!0,get(){return this.uniforms.useMap.value},set(c){this.uniforms.useMap.value=c}},alphaMap:{enumerable:!0,get(){return this.uniforms.alphaMap.value},set(c){this.uniforms.alphaMap.value=c}},useAlphaMap:{enumerable:!0,get(){return this.uniforms.useAlphaMap.value},set(c){this.uniforms.useAlphaMap.value=c}},color:{enumerable:!0,get(){return this.uniforms.color.value},set(c){this.uniforms.color.value=c}},gradient:{enumerable:!0,get(){return this.uniforms.gradient.value},set(c){this.uniforms.gradient.value=c}},opacity:{enumerable:!0,get(){return this.uniforms.opacity.value},set(c){this.uniforms.opacity.value=c}},resolution:{enumerable:!0,get(){return this.uniforms.resolution.value},set(c){this.uniforms.resolution.value.copy(c)}},sizeAttenuation:{enumerable:!0,get(){return this.uniforms.sizeAttenuation.value},set(c){this.uniforms.sizeAttenuation.value=c}},dashArray:{enumerable:!0,get(){return this.uniforms.dashArray.value},set(c){this.uniforms.dashArray.value=c,this.useDash=c!==0?1:0}},dashOffset:{enumerable:!0,get(){return this.uniforms.dashOffset.value},set(c){this.uniforms.dashOffset.value=c}},dashRatio:{enumerable:!0,get(){return this.uniforms.dashRatio.value},set(c){this.uniforms.dashRatio.value=c}},useDash:{enumerable:!0,get(){return this.uniforms.useDash.value},set(c){this.uniforms.useDash.value=c}},useGradient:{enumerable:!0,get(){return this.uniforms.useGradient.value},set(c){this.uniforms.useGradient.value=c}},visibility:{enumerable:!0,get(){return this.uniforms.visibility.value},set(c){this.uniforms.visibility.value=c}},alphaTest:{enumerable:!0,get(){return this.uniforms.alphaTest.value},set(c){this.uniforms.alphaTest.value=c}},repeat:{enumerable:!0,get(){return this.uniforms.repeat.value},set(c){this.uniforms.repeat.value.copy(c)}}}),this.setValues(r)}copy(r){return super.copy(r),this.lineWidth=r.lineWidth,this.map=r.map,this.useMap=r.useMap,this.alphaMap=r.alphaMap,this.useAlphaMap=r.useAlphaMap,this.color.copy(r.color),this.gradient=r.gradient,this.opacity=r.opacity,this.resolution.copy(r.resolution),this.sizeAttenuation=r.sizeAttenuation,this.dashArray=r.dashArray,this.dashOffset=r.dashOffset,this.dashRatio=r.dashRatio,this.useDash=r.useDash,this.useGradient=r.useGradient,this.visibility=r.visibility,this.alphaTest=r.alphaTest,this.repeat.copy(r.repeat),this}}const go={width:.2,length:1,decay:1,local:!1,stride:0,interval:1},Dl=(l,r=1)=>(l.set(l.subarray(r)),l.fill(-1/0,-r),l);function Rl(l,r){const{length:c,local:u,decay:t,interval:e,stride:n}={...go,...r},o=b.useRef(null),[a]=b.useState(()=>new xe);b.useLayoutEffect(()=>{l&&(o.current=Float32Array.from({length:c*10*3},(d,f)=>l.position.getComponent(f%3)))},[c,l]);const s=b.useRef(new xe),i=b.useRef(0);return et(()=>{if(l&&o.current){if(i.current===0){let d;u?d=l.position:(l.getWorldPosition(a),d=a);const f=1*t;for(let h=0;h<f;h++)d.distanceTo(s.current)<n||(Dl(o.current,3),o.current.set(d.toArray(),o.current.length-3));s.current.copy(d)}i.current++,i.current=i.current%e}}),o}const Il=b.forwardRef((l,r)=>{const{children:c}=l,{width:u,length:t,decay:e,local:n,stride:o,interval:a}={...go,...l},{color:s="hotpink",attenuation:i,target:d}=l,f=ot(x=>x.size),h=ot(x=>x.scene),m=b.useRef(null),[p,v]=b.useState(null),E=Rl(p,{length:t,decay:e,local:n,stride:o,interval:a});b.useEffect(()=>{const x=d?.current||m.current.children.find(A=>A instanceof qo);x&&v(x)},[E,d]);const w=b.useMemo(()=>new Al,[]),S=b.useMemo(()=>{var x,A;const T=new Fl({lineWidth:.1*u,color:s,sizeAttenuation:1,resolution:new st(f.width,f.height)});let M;if(c)if(Array.isArray(c))M=c.find(U=>{const L=U;return typeof L.type=="string"&&L.type==="meshLineMaterial"});else{const U=c;typeof U.type=="string"&&U.type==="meshLineMaterial"&&(M=U)}return typeof((x=M)==null?void 0:x.props)=="object"&&((A=M)==null?void 0:A.props)!==null&&T.setValues(M.props),T},[u,s,f,c]);return b.useEffect(()=>{S.uniforms.resolution.value.set(f.width,f.height)},[f]),et(()=>{E.current&&w.setPoints(E.current,i)}),b.createElement("group",null,Fo(b.createElement("mesh",{ref:r,geometry:w,material:S}),h),b.createElement("group",{ref:m},c))});function Ll(l,r,c){const u=ot(h=>h.size),t=ot(h=>h.viewport),e=typeof l=="number"?l:u.width*t.dpr,n=u.height*t.dpr,o=(typeof l=="number"?c:l)||{},{samples:a=0,depth:s,...i}=o,d=s??o.depthBuffer,f=b.useMemo(()=>{const h=new Zo(e,n,{minFilter:Fr,magFilter:Fr,type:$o,...i});return d&&(h.depthTexture=new es(e,n,ts)),h.samples=a,h},[]);return b.useLayoutEffect(()=>{f.setSize(e,n),a&&(f.samples=a)},[a,f,e,n]),b.useEffect(()=>()=>f.dispose(),[]),f}const Ol=l=>typeof l=="function",Bl=b.forwardRef(({envMap:l,resolution:r=256,frames:c=1/0,makeDefault:u,children:t,...e},n)=>{const o=ot(({set:v})=>v),a=ot(({camera:v})=>v),s=ot(({size:v})=>v),i=b.useRef(null);b.useImperativeHandle(n,()=>i.current,[]);const d=b.useRef(null),f=Ll(r);b.useLayoutEffect(()=>{e.manual||(i.current.aspect=s.width/s.height)},[s,e]),b.useLayoutEffect(()=>{i.current.updateProjectionMatrix()});let h=0,m=null;const p=Ol(t);return et(v=>{p&&(c===1/0||h<c)&&(d.current.visible=!1,v.gl.setRenderTarget(f),m=v.scene.background,l&&(v.scene.background=l),v.gl.render(v.scene,i.current),v.scene.background=m,v.gl.setRenderTarget(null),d.current.visible=!0,h++)}),b.useLayoutEffect(()=>{if(u){const v=a;return o(()=>({camera:i.current})),()=>o(()=>({camera:v}))}},[i,u,o]),b.createElement(b.Fragment,null,b.createElement("perspectiveCamera",$e({ref:i},e),!p&&t),b.createElement("group",{ref:d},p&&t(f.texture)))}),pn=Xa>=154?"opaque_fragment":"output_fragment";class Gl extends rs{constructor(r){super(r),this.onBeforeCompile=(c,u)=>{const{isWebGL2:t}=u.capabilities;c.fragmentShader=c.fragmentShader.replace(`#include <${pn}>`,`
        ${t?`#include <${pn}>`:`#extension GL_OES_standard_derivatives : enable
#include <${pn}>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <${Xa>=154?"colorspace_fragment":"encodings_fragment"}>
      `)}}}const Nl=b.forwardRef((l,r)=>{const[c]=b.useState(()=>new Gl(null));return b.createElement("primitive",$e({},l,{object:c,ref:r,attach:"material"}))}),ut=1e-5;function jl(l,r,c){const u=new ns,t=c-ut;return u.absarc(ut,ut,ut,-Math.PI/2,-Math.PI,!0),u.absarc(ut,r-t*2,ut,Math.PI,Math.PI/2,!0),u.absarc(l-t*2,r-t*2,ut,Math.PI/2,0,!0),u.absarc(l-t*2,ut,ut,0,-Math.PI/2,!0),u}const Ta=b.forwardRef(function({args:[r=1,c=1,u=1]=[],radius:t=.05,steps:e=1,smoothness:n=4,bevelSegments:o=4,creaseAngle:a=.4,children:s,...i},d){return b.createElement("mesh",$e({ref:d},i),b.createElement(Wl,{args:[r,c,u],radius:t,steps:e,smoothness:n,bevelSegments:o,creaseAngle:a}),s)}),Wl=b.forwardRef(function({args:[r=1,c=1,u=1]=[],radius:t=.05,steps:e=1,smoothness:n=4,bevelSegments:o=4,creaseAngle:a=.4,...s},i){const d=b.useMemo(()=>jl(r,c,t),[r,c,t]),f=b.useMemo(()=>({depth:u-t*2,bevelEnabled:!0,bevelSegments:o*2,steps:e,bevelSize:t-ut,bevelThickness:t,curveSegments:n}),[u,t,n,o,e]),h=b.useRef(null);return b.useLayoutEffect(()=>{h.current&&(h.current.center(),ki(h.current,a))},[d,f,a]),b.useImperativeHandle(i,()=>h.current),b.createElement("extrudeGeometry",$e({ref:h,args:[d,f]},s))}),Dn=b.forwardRef(({children:l,enabled:r=!0,speed:c=1,rotationIntensity:u=1,floatIntensity:t=1,floatingRange:e=[-.1,.1],autoInvalidate:n=!1,...o},a)=>{const s=b.useRef(null);b.useImperativeHandle(a,()=>s.current,[]);const i=b.useRef(Math.random()*1e4);return et(d=>{var f,h;if(!r||c===0)return;n&&d.invalidate();const m=i.current+d.clock.elapsedTime;s.current.rotation.x=Math.cos(m/4*c)/8*u,s.current.rotation.y=Math.sin(m/4*c)/8*u,s.current.rotation.z=Math.sin(m/4*c)/20*u;let p=Math.sin(m/4*c)/10;p=rr.mapLinear(p,-.1,.1,(f=e?.[0])!==null&&f!==void 0?f:-.1,(h=e?.[1])!==null&&h!==void 0?h:.1),s.current.position.y=p*t,s.current.updateMatrix()}),b.createElement("group",o,b.createElement("group",{ref:s,matrixAutoUpdate:!1},l))});let Ut,$t;const zl=b.createContext(null),Pa=new Or,Fa=new xe,Hl=b.forwardRef(({children:l,range:r,limit:c=1e3,...u},t)=>{const e=b.useRef(null);b.useImperativeHandle(t,()=>e.current,[]);const[n,o]=b.useState([]),[[a,s,i]]=b.useState(()=>[new Float32Array(c*3),Float32Array.from({length:c*3},()=>1),Float32Array.from({length:c},()=>1)]);b.useEffect(()=>{e.current.geometry.attributes.position.needsUpdate=!0}),et(()=>{for(e.current.updateMatrix(),e.current.updateMatrixWorld(),Pa.copy(e.current.matrixWorld).invert(),e.current.geometry.drawRange.count=Math.min(c,r!==void 0?r:c,n.length),Ut=0;Ut<n.length;Ut++)$t=n[Ut].current,$t.getWorldPosition(Fa).applyMatrix4(Pa),Fa.toArray(a,Ut*3),e.current.geometry.attributes.position.needsUpdate=!0,$t.matrixWorldNeedsUpdate=!0,$t.color.toArray(s,Ut*3),e.current.geometry.attributes.color.needsUpdate=!0,i.set([$t.size],Ut),e.current.geometry.attributes.size.needsUpdate=!0});const d=b.useMemo(()=>({getParent:()=>e,subscribe:f=>(o(h=>[...h,f]),()=>o(h=>h.filter(m=>m.current!==f.current)))}),[]);return b.createElement("points",$e({userData:{instances:n},matrixAutoUpdate:!1,ref:e,raycast:()=>null},u),b.createElement("bufferGeometry",null,b.createElement("bufferAttribute",{attach:"attributes-position",args:[a,3],usage:Nt}),b.createElement("bufferAttribute",{attach:"attributes-color",args:[s,3],usage:Nt}),b.createElement("bufferAttribute",{attach:"attributes-size",args:[i,1],usage:Nt})),b.createElement(zl.Provider,{value:d},l))}),Vl=b.forwardRef(({children:l,positions:r,colors:c,sizes:u,stride:t=3,...e},n)=>{const o=b.useRef(null);return b.useImperativeHandle(n,()=>o.current,[]),et(()=>{const a=o.current.geometry.attributes;a.position.needsUpdate=!0,c&&(a.color.needsUpdate=!0),u&&(a.size.needsUpdate=!0)}),b.createElement("points",$e({ref:o},e),b.createElement("bufferGeometry",null,b.createElement("bufferAttribute",{attach:"attributes-position",args:[r,t],usage:Nt}),c&&b.createElement("bufferAttribute",{attach:"attributes-color",args:[c,t],count:c.length/t,usage:Nt}),u&&b.createElement("bufferAttribute",{attach:"attributes-size",args:[u,1],count:u.length/t,usage:Nt})),l)}),Xl=b.forwardRef((l,r)=>l.positions instanceof Float32Array?b.createElement(Vl,$e({},l,{ref:r})):b.createElement(Hl,$e({},l,{ref:r})));function Yl(l,{container:r,accept:c,walk:u}){let t=b.useRef(c),e=b.useRef(u);b.useEffect(()=>{t.current=c,e.current=u},[c,u]),nr(()=>{if(!r||!l)return;let n=fs(r);if(!n)return;let o=t.current,a=e.current,s=Object.assign(d=>o(d),{acceptNode:o}),i=n.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,s,!1);for(;i.nextNode();)a(i.currentNode)},[r,l,t,e])}var Jl=Object.defineProperty,Kl=(l,r,c)=>r in l?Jl(l,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[r]=c,Da=(l,r,c)=>(Kl(l,typeof r!="symbol"?r+"":r,c),c),ze=(l=>(l[l.Open=0]="Open",l[l.Closed=1]="Closed",l))(ze||{}),Rr=(l=>(l[l.Pointer=0]="Pointer",l[l.Other=1]="Other",l))(Rr||{}),Me=(l=>(l[l.OpenMenu=0]="OpenMenu",l[l.CloseMenu=1]="CloseMenu",l[l.GoToItem=2]="GoToItem",l[l.Search=3]="Search",l[l.ClearSearch=4]="ClearSearch",l[l.RegisterItems=5]="RegisterItems",l[l.UnregisterItems=6]="UnregisterItems",l[l.SetButtonElement=7]="SetButtonElement",l[l.SetItemsElement=8]="SetItemsElement",l[l.SortItems=9]="SortItems",l[l.MarkButtonAsMoved=10]="MarkButtonAsMoved",l))(Me||{});function Ra(l,r=c=>c){let c=l.activeItemIndex!==null?l.items[l.activeItemIndex]:null,u=ys(r(l.items.slice()),e=>e.dataRef.current.domRef.current),t=c?u.indexOf(c):null;return t===-1&&(t=null),{items:u,activeItemIndex:t}}let Ql={1(l){if(l.menuState===1)return l;let r=l.buttonElement?Er.Tracked(vs(l.buttonElement)):l.buttonPositionState;return{...l,activeItemIndex:null,pendingFocus:{focus:Le.Nothing},menuState:1,buttonPositionState:r}},0(l,r){return l.menuState===0?l:{...l,__demoMode:!1,pendingFocus:r.focus,menuState:0,buttonPositionState:Er.Idle}},2:(l,r)=>{var c,u,t,e,n;if(l.menuState===1)return l;let o={...l,searchQuery:"",activationTrigger:(c=r.trigger)!=null?c:1,__demoMode:!1};if(r.focus===Le.Nothing)return{...o,activeItemIndex:null};if(r.focus===Le.Specific)return{...o,activeItemIndex:l.items.findIndex(i=>i.id===r.id)};if(r.focus===Le.Previous){let i=l.activeItemIndex;if(i!==null){let d=l.items[i].dataRef.current.domRef,f=_r(r,{resolveItems:()=>l.items,resolveActiveIndex:()=>l.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.current.disabled});if(f!==null){let h=l.items[f].dataRef.current.domRef;if(((u=d.current)==null?void 0:u.previousElementSibling)===h.current||((t=h.current)==null?void 0:t.previousElementSibling)===null)return{...o,activeItemIndex:f}}}}else if(r.focus===Le.Next){let i=l.activeItemIndex;if(i!==null){let d=l.items[i].dataRef.current.domRef,f=_r(r,{resolveItems:()=>l.items,resolveActiveIndex:()=>l.activeItemIndex,resolveId:h=>h.id,resolveDisabled:h=>h.dataRef.current.disabled});if(f!==null){let h=l.items[f].dataRef.current.domRef;if(((e=d.current)==null?void 0:e.nextElementSibling)===h.current||((n=h.current)==null?void 0:n.nextElementSibling)===null)return{...o,activeItemIndex:f}}}}let a=Ra(l),s=_r(r,{resolveItems:()=>a.items,resolveActiveIndex:()=>a.activeItemIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled});return{...o,...a,activeItemIndex:s}},3:(l,r)=>{let c=l.searchQuery!==""?0:1,u=l.searchQuery+r.value.toLowerCase(),t=(l.activeItemIndex!==null?l.items.slice(l.activeItemIndex+c).concat(l.items.slice(0,l.activeItemIndex+c)):l.items).find(n=>{var o;return((o=n.dataRef.current.textValue)==null?void 0:o.startsWith(u))&&!n.dataRef.current.disabled}),e=t?l.items.indexOf(t):-1;return e===-1||e===l.activeItemIndex?{...l,searchQuery:u}:{...l,searchQuery:u,activeItemIndex:e,activationTrigger:1}},4(l){return l.searchQuery===""?l:{...l,searchQuery:"",searchActiveItemIndex:null}},5:(l,r)=>{let c=l.items.concat(r.items.map(t=>t)),u=l.activeItemIndex;return l.pendingFocus.focus!==Le.Nothing&&(u=_r(l.pendingFocus,{resolveItems:()=>c,resolveActiveIndex:()=>l.activeItemIndex,resolveId:t=>t.id,resolveDisabled:t=>t.dataRef.current.disabled})),{...l,items:c,activeItemIndex:u,pendingFocus:{focus:Le.Nothing},pendingShouldSort:!0}},6:(l,r)=>{let c=l.items,u=[],t=new Set(r.items);for(let[e,n]of c.entries())if(t.has(n.id)&&(u.push(e),t.delete(n.id),t.size===0))break;if(u.length>0){c=c.slice();for(let e of u.reverse())c.splice(e,1)}return{...l,items:c,activationTrigger:1}},7:(l,r)=>l.buttonElement===r.element?l:{...l,buttonElement:r.element},8:(l,r)=>l.itemsElement===r.element?l:{...l,itemsElement:r.element},9:l=>l.pendingShouldSort?{...l,...Ra(l),pendingShouldSort:!1}:l,10(l){return l.buttonPositionState.kind!=="Tracked"?l:{...l,buttonPositionState:Er.Moved}}};class Rn extends hs{constructor(r){super(r),Da(this,"actions",{registerItem:sa(()=>{let c=[],u=new Set;return[(t,e)=>{u.has(e)||(u.add(e),c.push({id:t,dataRef:e}))},()=>(u.clear(),this.send({type:5,items:c.splice(0)}))]}),unregisterItem:sa(()=>{let c=[];return[u=>c.push(u),()=>this.send({type:6,items:c.splice(0)})]})}),Da(this,"selectors",{activeDescendantId(c){var u;let t=c.activeItemIndex,e=c.items;return t===null||(u=e[t])==null?void 0:u.id},isActive(c,u){var t;let e=c.activeItemIndex,n=c.items;return e!==null?((t=n[e])==null?void 0:t.id)===u:!1},shouldScrollIntoView(c,u){return c.__demoMode||c.menuState!==0||c.activationTrigger===0?!1:this.isActive(c,u)},didButtonMove(c){return c.buttonPositionState.kind==="Moved"}}),this.on(5,()=>{this.disposables.requestAnimationFrame(()=>{this.send({type:9})})});{let c=this.state.id,u=Ya.get(null);this.disposables.add(u.on(ms.Push,t=>{!u.selectors.isTop(t,c)&&this.state.menuState===0&&this.send({type:1})})),this.on(0,()=>u.actions.push(c)),this.on(1,()=>u.actions.pop(c))}this.disposables.group(c=>{this.on(1,u=>{u.buttonElement&&(c.dispose(),c.add(ps(u.buttonElement,u.buttonPositionState,()=>{this.send({type:10})})))})})}static new({id:r,__demoMode:c=!1}){return new Rn({id:r,__demoMode:c,menuState:c?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1,pendingShouldSort:!1,pendingFocus:{focus:Le.Nothing},buttonPositionState:Er.Idle})}reduce(r,c){return Ja(c.type,Ql,r,c)}}const bo=b.createContext(null);function In(l){let r=b.useContext(bo);if(r===null){let c=new Error(`<${l} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,xo),c}return r}function xo({id:l,__demoMode:r=!1}){let c=b.useMemo(()=>Rn.new({id:l,__demoMode:r}),[]);return gs(()=>c.dispose()),c}let ql=b.Fragment;function Zl(l,r){let c=b.useId(),{__demoMode:u=!1,...t}=l,e=xo({id:c,__demoMode:u}),[n,o,a]=dt(e,v=>[v.menuState,v.itemsElement,v.buttonElement]),s=Br(r),i=Ya.get(null),d=dt(i,b.useCallback(v=>i.selectors.isTop(v,c),[i,c]));Xs(d,[a,o],(v,E)=>{var w;e.send({type:Me.CloseMenu}),Ys(E,Js.Loose)||(v.preventDefault(),(w=e.state.buttonElement)==null||w.focus())});let f=Ze(()=>{e.send({type:Me.CloseMenu})}),h=Gr({open:n===ze.Open,close:f}),m={ref:s},p=Dt();return Et.createElement(Ks,null,Et.createElement(bo.Provider,{value:e},Et.createElement(Qs,{value:Ja(n,{[ze.Open]:Dr.Open,[ze.Closed]:Dr.Closed})},p({ourProps:m,theirProps:t,slot:h,defaultTag:ql,name:"Menu"}))))}let $l="button";function ec(l,r){let c=In("Menu.Button"),u=b.useId(),{id:t=`headlessui-menu-button-${u}`,disabled:e=!1,autoFocus:n=!1,...o}=l,a=b.useRef(null),s=bs(),i=Br(r,a,xs(),Ze(g=>c.send({type:Me.SetButtonElement,element:g}))),d=Ze(g=>{switch(g.key){case We.Space:case We.Enter:case We.ArrowDown:g.preventDefault(),g.stopPropagation(),c.send({type:Me.OpenMenu,focus:{focus:Le.First}});break;case We.ArrowUp:g.preventDefault(),g.stopPropagation(),c.send({type:Me.OpenMenu,focus:{focus:Le.Last}});break}}),f=Ze(g=>{g.key===We.Space&&g.preventDefault()}),[h,m,p]=dt(c,g=>[g.menuState,g.buttonElement,g.itemsElement]),v=h===ze.Open;_s(v,{trigger:m,action:b.useCallback(g=>{if(m!=null&&m.contains(g.target))return Sr.Ignore;let O=g.target.closest('[role="menuitem"]:not([data-disabled])');return Ss(O)?Sr.Select(O):p!=null&&p.contains(g.target)?Sr.Ignore:Sr.Close},[m,p]),close:b.useCallback(()=>c.send({type:Me.CloseMenu}),[]),select:b.useCallback(g=>g.click(),[])});let E=ws(g=>{var O;e||(h===ze.Open?(xn.flushSync(()=>c.send({type:Me.CloseMenu})),(O=a.current)==null||O.focus({preventScroll:!0})):(g.preventDefault(),c.send({type:Me.OpenMenu,focus:{focus:Le.Nothing},trigger:Rr.Pointer})))}),{isFocusVisible:w,focusProps:S}=ks({autoFocus:n}),{isHovered:x,hoverProps:A}=Cs({isDisabled:e}),{pressed:T,pressProps:M}=Ms({disabled:e}),U=Gr({open:h===ze.Open,active:T||h===ze.Open,disabled:e,hover:x,focus:w,autofocus:n}),L=Ka(s(),{ref:i,id:t,type:As(l,a.current),"aria-haspopup":"menu","aria-controls":p?.id,"aria-expanded":h===ze.Open,disabled:e||void 0,autoFocus:n,onKeyDown:d,onKeyUp:f},E,S,A,M);return Dt()({ourProps:L,theirProps:o,slot:U,defaultTag:$l,name:"Menu.Button"})}let tc="div",rc=ca.RenderStrategy|ca.Static;function nc(l,r){let c=b.useId(),{id:u=`headlessui-menu-items-${c}`,anchor:t,portal:e=!1,modal:n=!0,transition:o=!1,...a}=l,s=Us(t),i=In("Menu.Items"),[d,f]=Es(s),h=Ts(),[m,p]=b.useState(null),v=Br(r,s?d:null,Ze(W=>i.send({type:Me.SetItemsElement,element:W})),p),[E,w]=dt(i,W=>[W.menuState,W.buttonElement]),S=ia(w),x=ia(m);s&&(e=!0);let A=Ps(),[T,M]=Fs(o,m,A!==null?(A&Dr.Open)===Dr.Open:E===ze.Open);Ds(T,w,()=>{i.send({type:Me.CloseMenu})});let U=dt(i,W=>W.__demoMode),L=U?!1:n&&E===ze.Open;Rs(L,x);let g=U?!1:n&&E===ze.Open;Is(g,{allowed:b.useCallback(()=>[w,m],[w,m])});let O=dt(i,i.selectors.didButtonMove)?!1:T;b.useEffect(()=>{let W=m;W&&E===ze.Open&&(Ls(W)||W.focus({preventScroll:!0}))},[E,m]),Yl(E===ze.Open,{container:m,accept(W){return W.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:W.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(W){W.setAttribute("role","none")}});let _=Os(),I=Ze(W=>{var N,B,y;switch(_.dispose(),W.key){case We.Space:if(i.state.searchQuery!=="")return W.preventDefault(),W.stopPropagation(),i.send({type:Me.Search,value:W.key});case We.Enter:if(W.preventDefault(),W.stopPropagation(),i.state.activeItemIndex!==null){let{dataRef:k}=i.state.items[i.state.activeItemIndex];(B=(N=k.current)==null?void 0:N.domRef.current)==null||B.click()}i.send({type:Me.CloseMenu}),Qa(i.state.buttonElement);break;case We.ArrowDown:return W.preventDefault(),W.stopPropagation(),i.send({type:Me.GoToItem,focus:Le.Next});case We.ArrowUp:return W.preventDefault(),W.stopPropagation(),i.send({type:Me.GoToItem,focus:Le.Previous});case We.Home:case We.PageUp:return W.preventDefault(),W.stopPropagation(),i.send({type:Me.GoToItem,focus:Le.First});case We.End:case We.PageDown:return W.preventDefault(),W.stopPropagation(),i.send({type:Me.GoToItem,focus:Le.Last});case We.Escape:W.preventDefault(),W.stopPropagation(),xn.flushSync(()=>i.send({type:Me.CloseMenu})),(y=i.state.buttonElement)==null||y.focus({preventScroll:!0});break;case We.Tab:W.preventDefault(),W.stopPropagation(),xn.flushSync(()=>i.send({type:Me.CloseMenu})),Bs(i.state.buttonElement,W.shiftKey?la.Previous:la.Next);break;default:W.key.length===1&&(i.send({type:Me.Search,value:W.key}),_.setTimeout(()=>i.send({type:Me.ClearSearch}),350));break}}),F=Ze(W=>{W.key===We.Space&&W.preventDefault()}),V=Gr({open:E===ze.Open}),Y=Ka(s?h():{},{"aria-activedescendant":dt(i,i.selectors.activeDescendantId),"aria-labelledby":dt(i,W=>{var N;return(N=W.buttonElement)==null?void 0:N.id}),id:u,onKeyDown:I,onKeyUp:F,role:"menu",tabIndex:E===ze.Open?0:void 0,ref:v,style:{...a.style,...f,"--button-width":Ns(T,w,!0).width},...Gs(M)}),Q=Dt();return Et.createElement(js,{enabled:e?l.static||T:!1,ownerDocument:S},Q({ourProps:Y,theirProps:a,slot:V,defaultTag:tc,features:rc,visible:O,name:"Menu.Items"}))}let ac=b.Fragment;function oc(l,r){let c=b.useId(),{id:u=`headlessui-menu-item-${c}`,disabled:t=!1,...e}=l,n=In("Menu.Item"),o=dt(n,O=>n.selectors.isActive(O,u)),a=b.useRef(null),s=Br(r,a),i=dt(n,O=>n.selectors.shouldScrollIntoView(O,u));nr(()=>{if(i)return Ws().requestAnimationFrame(()=>{var O,_;(_=(O=a.current)==null?void 0:O.scrollIntoView)==null||_.call(O,{block:"nearest"})})},[i,a]);let d=zs(a),f=b.useRef({disabled:t,domRef:a,get textValue(){return d()}});nr(()=>{f.current.disabled=t},[f,t]),nr(()=>(n.actions.registerItem(u,f),()=>n.actions.unregisterItem(u)),[f,u]);let h=Ze(()=>{n.send({type:Me.CloseMenu})}),m=Ze(O=>{if(t)return O.preventDefault();n.send({type:Me.CloseMenu}),Qa(n.state.buttonElement)}),p=Ze(()=>{if(t)return n.send({type:Me.GoToItem,focus:Le.Nothing});n.send({type:Me.GoToItem,focus:Le.Specific,id:u})}),v=Hs(),E=Ze(O=>v.update(O)),w=Ze(O=>{v.wasMoved(O)&&(t||o||n.send({type:Me.GoToItem,focus:Le.Specific,id:u,trigger:Rr.Pointer}))}),S=Ze(O=>{v.wasMoved(O)&&(t||o&&n.state.activationTrigger===Rr.Pointer&&n.send({type:Me.GoToItem,focus:Le.Nothing}))}),[x,A]=qa(),[T,M]=Vs(),U=Gr({active:o,focus:o,disabled:t,close:h}),L={id:u,ref:s,role:"menuitem",tabIndex:t===!0?void 0:-1,"aria-disabled":t===!0?!0:void 0,"aria-labelledby":x,"aria-describedby":T,disabled:void 0,onClick:m,onFocus:p,onPointerEnter:E,onMouseEnter:E,onPointerMove:w,onMouseMove:w,onPointerLeave:S,onMouseLeave:S},g=Dt();return Et.createElement(A,null,Et.createElement(M,null,g({ourProps:L,theirProps:e,slot:U,defaultTag:ac,name:"Menu.Item"})))}let sc="div";function ic(l,r){let[c,u]=qa(),t=l,e={ref:r,"aria-labelledby":c,role:"group"},n=Dt();return Et.createElement(u,null,n({ourProps:e,theirProps:t,slot:{},defaultTag:sc,name:"Menu.Section"}))}let lc="header";function cc(l,r){let c=b.useId(),{id:u=`headlessui-menu-heading-${c}`,...t}=l,e=qs();nr(()=>e.register(u),[u,e.register]);let n={id:u,ref:r,role:"presentation",...e.props};return Dt()({ourProps:n,theirProps:t,slot:{},defaultTag:lc,name:"Menu.Heading"})}let uc="div";function dc(l,r){let c=l,u={ref:r,role:"separator"};return Dt()({ourProps:u,theirProps:c,slot:{},defaultTag:uc,name:"Menu.Separator"})}let fc=Ft(Zl),_o=Ft(ec),So=Ft(nc),wo=Ft(oc),hc=Ft(ic),mc=Ft(cc),pc=Ft(dc),vc=Object.assign(fc,{Button:_o,Items:So,Item:wo,Section:hc,Heading:mc,Separator:pc});const Ke=[{number:1,symbol:"H",name:"Hydrogen",atomic_mass:1.008,category:"diatomic nonmetal",xpos:1,ypos:1,cpk_hex:"ffffff",phase:"Gas",discovered_by:"Henry Cavendish",summary:"Hydrogen is the chemical element with the symbol H and atomic number 1. Highly flammable.",reaction_type:"Combustion"},{number:2,symbol:"He",name:"Helium",atomic_mass:4.0026,category:"noble gas",xpos:18,ypos:1,cpk_hex:"d9ffff",phase:"Gas",discovered_by:"Pierre Janssen",summary:"Helium is a colorless, odorless, tasteless, non-toxic, inert, monatomic gas.",reaction_type:"Inert"},{number:3,symbol:"Li",name:"Lithium",atomic_mass:6.94,category:"alkali metal",xpos:1,ypos:2,cpk_hex:"cc80ff",phase:"Solid",discovered_by:"Johan August Arfwedson",summary:"Lithium is a soft, silvery-white alkali metal.",crystal_structure:"BCC",reaction_type:"Oxidation"},{number:4,symbol:"Be",name:"Beryllium",atomic_mass:9.0122,category:"alkaline earth metal",xpos:2,ypos:2,cpk_hex:"c2ff00",phase:"Solid",discovered_by:"Louis Nicolas Vauquelin",summary:"Beryllium is a steel-gray, strong, lightweight and brittle alkaline earth metal.",crystal_structure:"HCP"},{number:5,symbol:"B",name:"Boron",atomic_mass:10.81,category:"metalloid",xpos:13,ypos:2,cpk_hex:"ffb5b5",phase:"Solid",discovered_by:"Joseph Louis Gay-Lussac",summary:"Boron is a metalloid found in the Earth's crust as borates."},{number:6,symbol:"C",name:"Carbon",atomic_mass:12.011,category:"polyatomic nonmetal",xpos:14,ypos:2,cpk_hex:"909090",phase:"Solid",discovered_by:"Ancient",summary:"Carbon forms diamonds and graphite. Essential for life.",crystal_structure:"Diamond",reaction_type:"Combustion"},{number:7,symbol:"N",name:"Nitrogen",atomic_mass:14.007,category:"diatomic nonmetal",xpos:15,ypos:2,cpk_hex:"3050f8",phase:"Gas",discovered_by:"Daniel Rutherford",summary:"Nitrogen is a diatomic gas making up 78% of Earth's atmosphere."},{number:8,symbol:"O",name:"Oxygen",atomic_mass:15.999,category:"diatomic nonmetal",xpos:16,ypos:2,cpk_hex:"ff0d0d",phase:"Gas",discovered_by:"Carl Wilhelm Scheele",summary:"Oxygen is a reactive nonmetal and an oxidizing agent."},{number:9,symbol:"F",name:"Fluorine",atomic_mass:18.998,category:"diatomic nonmetal",xpos:17,ypos:2,cpk_hex:"90e050",phase:"Gas",discovered_by:"Andr-Marie Ampre",summary:"Fluorine is the most electronegative and reactive of all elements."},{number:10,symbol:"Ne",name:"Neon",atomic_mass:20.18,category:"noble gas",xpos:18,ypos:2,cpk_hex:"b3e3f5",phase:"Gas",discovered_by:"Morris Travers",summary:"Neon is a noble gas that glows reddish-orange in a discharge tube."},{number:11,symbol:"Na",name:"Sodium",atomic_mass:22.99,category:"alkali metal",xpos:1,ypos:3,cpk_hex:"ab5cf2",phase:"Solid",discovered_by:"Humphry Davy",summary:"Sodium is a soft, silvery-white, highly reactive alkali metal.",crystal_structure:"BCC",reaction_type:"Oxidation"},{number:12,symbol:"Mg",name:"Magnesium",atomic_mass:24.305,category:"alkaline earth metal",xpos:2,ypos:3,cpk_hex:"8aff00",phase:"Solid",discovered_by:"Joseph Black",summary:"Magnesium burns with a brilliant white light.",crystal_structure:"HCP",reaction_type:"Combustion"},{number:13,symbol:"Al",name:"Aluminium",atomic_mass:26.982,category:"post-transition metal",xpos:13,ypos:3,cpk_hex:"bfa6a6",phase:"Solid",discovered_by:"Hans Christian rsted",summary:"Aluminium is a lightweight metal with high reflectivity.",crystal_structure:"FCC"},{number:14,symbol:"Si",name:"Silicon",atomic_mass:28.085,category:"metalloid",xpos:14,ypos:3,cpk_hex:"f0c8a0",phase:"Solid",discovered_by:"Jns Jacob Berzelius",summary:"Silicon is a hard and brittle crystalline solid."},{number:15,symbol:"P",name:"Phosphorus",atomic_mass:30.974,category:"polyatomic nonmetal",xpos:15,ypos:3,cpk_hex:"ff8000",phase:"Solid",discovered_by:"Hennig Brand",summary:"Phosphorus exists in two main forms, white and red."},{number:16,symbol:"S",name:"Sulfur",atomic_mass:32.06,category:"polyatomic nonmetal",xpos:16,ypos:3,cpk_hex:"ffff30",phase:"Solid",discovered_by:"Ancient",summary:"Sulfur is a bright yellow crystalline solid."},{number:17,symbol:"Cl",name:"Chlorine",atomic_mass:35.45,category:"diatomic nonmetal",xpos:17,ypos:3,cpk_hex:"1ff01f",phase:"Gas",discovered_by:"Carl Wilhelm Scheele",summary:"Chlorine is a yellow-green gas and powerful oxidizer."},{number:18,symbol:"Ar",name:"Argon",atomic_mass:39.948,category:"noble gas",xpos:18,ypos:3,cpk_hex:"80d1e3",phase:"Gas",discovered_by:"Lord Rayleigh",summary:"Argon is the third-most abundant gas in Earth's atmosphere."},{number:19,symbol:"K",name:"Potassium",atomic_mass:39.098,category:"alkali metal",xpos:1,ypos:4,cpk_hex:"8f40d4",phase:"Solid",discovered_by:"Humphry Davy",summary:"Silvery-white metal that reacts violently with water.",crystal_structure:"BCC"},{number:20,symbol:"Ca",name:"Calcium",atomic_mass:40.078,category:"alkaline earth metal",xpos:2,ypos:4,cpk_hex:"3dff00",phase:"Solid",discovered_by:"Humphry Davy",summary:"Calcium is essential for bone health.",crystal_structure:"FCC"},{number:21,symbol:"Sc",name:"Scandium",atomic_mass:44.956,category:"transition metal",xpos:3,ypos:4,cpk_hex:"e6e6e6",phase:"Solid",discovered_by:"Lars Fredrik Nilson",summary:"Silvery-white metallic transition element.",crystal_structure:"HCP"},{number:22,symbol:"Ti",name:"Titanium",atomic_mass:47.867,category:"transition metal",xpos:4,ypos:4,cpk_hex:"bfc2c7",phase:"Solid",discovered_by:"William Gregor",summary:"Known for strength and corrosion resistance.",crystal_structure:"HCP"},{number:23,symbol:"V",name:"Vanadium",atomic_mass:50.942,category:"transition metal",xpos:5,ypos:4,cpk_hex:"a6a6ab",phase:"Solid",discovered_by:"Andrs Manuel del Ro",summary:"Hard, silvery-grey, ductile transition metal.",crystal_structure:"BCC"},{number:24,symbol:"Cr",name:"Chromium",atomic_mass:51.996,category:"transition metal",xpos:6,ypos:4,cpk_hex:"8a99c7",phase:"Solid",discovered_by:"Louis Nicolas Vauquelin",summary:"Steely-grey, hard and brittle metal.",crystal_structure:"BCC"},{number:25,symbol:"Mn",name:"Manganese",atomic_mass:54.938,category:"transition metal",xpos:7,ypos:4,cpk_hex:"9c7ac7",phase:"Solid",discovered_by:"Torbern Olof Bergman",summary:"Essential to iron and steel production."},{number:26,symbol:"Fe",name:"Iron",atomic_mass:55.845,category:"transition metal",xpos:8,ypos:4,cpk_hex:"e06633",phase:"Solid",discovered_by:"Ancient",summary:"Most abundant element on Earth by mass.",crystal_structure:"BCC",reaction_type:"Oxidation"},{number:27,symbol:"Co",name:"Cobalt",atomic_mass:58.933,category:"transition metal",xpos:9,ypos:4,cpk_hex:"f090a0",phase:"Solid",discovered_by:"Georg Brandt",summary:"Used in high-strength alloys.",crystal_structure:"HCP"},{number:28,symbol:"Ni",name:"Nickel",atomic_mass:58.693,category:"transition metal",xpos:10,ypos:4,cpk_hex:"50d050",phase:"Solid",discovered_by:"Axel Fredrik Cronstedt",summary:"Silvery-white lustrous metal with golden tinge.",crystal_structure:"FCC"},{number:29,symbol:"Cu",name:"Copper",atomic_mass:63.546,category:"transition metal",xpos:11,ypos:4,cpk_hex:"c88033",phase:"Solid",discovered_by:"Ancient",summary:"Soft, malleable, and ductile metal.",crystal_structure:"FCC"},{number:30,symbol:"Zn",name:"Zinc",atomic_mass:65.38,category:"transition metal",xpos:12,ypos:4,cpk_hex:"7d80b0",phase:"Solid",discovered_by:"Ancient",summary:"Used to galvanize steel.",crystal_structure:"HCP"},{number:31,symbol:"Ga",name:"Gallium",atomic_mass:69.723,category:"post-transition metal",xpos:13,ypos:4,cpk_hex:"c28f8f",phase:"Solid",discovered_by:"Paul-mile Lecoq de Boisbaudran",summary:"Melts at room temperature."},{number:32,symbol:"Ge",name:"Germanium",atomic_mass:72.63,category:"metalloid",xpos:14,ypos:4,cpk_hex:"668f8f",phase:"Solid",discovered_by:"Clemens Winkler",summary:"Important semiconductor material."},{number:33,symbol:"As",name:"Arsenic",atomic_mass:74.922,category:"metalloid",xpos:15,ypos:4,cpk_hex:"bd80e3",phase:"Solid",discovered_by:"Bronze Age",summary:"Well known as a potent poison."},{number:34,symbol:"Se",name:"Selenium",atomic_mass:78.971,category:"polyatomic nonmetal",xpos:16,ypos:4,cpk_hex:"ffa100",phase:"Solid",discovered_by:"Jns Jacob Berzelius",summary:"Used in photocells and solar cells."},{number:35,symbol:"Br",name:"Bromine",atomic_mass:79.904,category:"diatomic nonmetal",xpos:17,ypos:4,cpk_hex:"a62929",phase:"Liquid",discovered_by:"Antoine Jrme Balard",summary:"Fuming red-brown liquid."},{number:36,symbol:"Kr",name:"Krypton",atomic_mass:83.798,category:"noble gas",xpos:18,ypos:4,cpk_hex:"5cb8d1",phase:"Gas",discovered_by:"William Ramsay",summary:"Noble gas used in lighting."},{number:37,symbol:"Rb",name:"Rubidium",atomic_mass:85.468,category:"alkali metal",xpos:1,ypos:5,cpk_hex:"702eb0",phase:"Solid",discovered_by:"Robert Bunsen",summary:"Highly reactive alkali metal.",crystal_structure:"BCC"},{number:38,symbol:"Sr",name:"Strontium",atomic_mass:87.62,category:"alkaline earth metal",xpos:2,ypos:5,cpk_hex:"00ff00",phase:"Solid",discovered_by:"Adair Crawford",summary:"Used in fireworks for red color.",crystal_structure:"FCC"},{number:39,symbol:"Y",name:"Yttrium",atomic_mass:88.906,category:"transition metal",xpos:3,ypos:5,cpk_hex:"94ffff",phase:"Solid",discovered_by:"Johan Gadolin",summary:"Rare-earth transition metal.",crystal_structure:"HCP"},{number:40,symbol:"Zr",name:"Zirconium",atomic_mass:91.224,category:"transition metal",xpos:4,ypos:5,cpk_hex:"94e0e0",phase:"Solid",discovered_by:"Martin Heinrich Klaproth",summary:"High resistance to corrosion.",crystal_structure:"HCP"},{number:41,symbol:"Nb",name:"Niobium",atomic_mass:92.906,category:"transition metal",xpos:5,ypos:5,cpk_hex:"73c2c9",phase:"Solid",discovered_by:"Charles Hatchett",summary:"Used in superconducting magnets.",crystal_structure:"BCC"},{number:42,symbol:"Mo",name:"Molybdenum",atomic_mass:95.95,category:"transition metal",xpos:6,ypos:5,cpk_hex:"54b5b5",phase:"Solid",discovered_by:"Carl Wilhelm Scheele",summary:"Used in steel alloys.",crystal_structure:"BCC"},{number:43,symbol:"Tc",name:"Technetium",atomic_mass:98,category:"transition metal",xpos:7,ypos:5,cpk_hex:"3b9e9e",phase:"Solid",discovered_by:"Emilio Segr",summary:"First element to be produced artificially."},{number:44,symbol:"Ru",name:"Ruthenium",atomic_mass:101.07,category:"transition metal",xpos:8,ypos:5,cpk_hex:"248f8f",phase:"Solid",discovered_by:"Karl Ernst Claus",summary:"Rare transition metal.",crystal_structure:"HCP"},{number:45,symbol:"Rh",name:"Rhodium",atomic_mass:102.91,category:"transition metal",xpos:9,ypos:5,cpk_hex:"0a7d8c",phase:"Solid",discovered_by:"William Hyde Wollaston",summary:"Extremely rare precious metal.",crystal_structure:"FCC"},{number:46,symbol:"Pd",name:"Palladium",atomic_mass:106.42,category:"transition metal",xpos:10,ypos:5,cpk_hex:"006985",phase:"Solid",discovered_by:"William Hyde Wollaston",summary:"Key in catalytic converters.",crystal_structure:"FCC"},{number:47,symbol:"Ag",name:"Silver",atomic_mass:107.87,category:"transition metal",xpos:11,ypos:5,cpk_hex:"c0c0c0",phase:"Solid",discovered_by:"Ancient",summary:"Highest electrical conductivity.",crystal_structure:"FCC"},{number:48,symbol:"Cd",name:"Cadmium",atomic_mass:112.41,category:"transition metal",xpos:12,ypos:5,cpk_hex:"ffd98f",phase:"Solid",discovered_by:"Karl Hermann",summary:"Used in rechargeable batteries.",crystal_structure:"HCP"},{number:49,symbol:"In",name:"Indium",atomic_mass:114.82,category:"post-transition metal",xpos:13,ypos:5,cpk_hex:"a67573",phase:"Solid",discovered_by:"Ferdinand Reich",summary:"Soft metal used in touchscreens."},{number:50,symbol:"Sn",name:"Tin",atomic_mass:118.71,category:"post-transition metal",xpos:14,ypos:5,cpk_hex:"668080",phase:"Solid",discovered_by:"Ancient",summary:"Silvery-white metal."},{number:51,symbol:"Sb",name:"Antimony",atomic_mass:121.76,category:"metalloid",xpos:15,ypos:5,cpk_hex:"9e63b5",phase:"Solid",discovered_by:"Ancient",summary:"Used in fire retardants."},{number:52,symbol:"Te",name:"Tellurium",atomic_mass:127.6,category:"metalloid",xpos:16,ypos:5,cpk_hex:"d47a00",phase:"Solid",discovered_by:"Franz Mller",summary:"Rare silvery-white metalloid."},{number:53,symbol:"I",name:"Iodine",atomic_mass:126.9,category:"diatomic nonmetal",xpos:17,ypos:5,cpk_hex:"940094",phase:"Solid",discovered_by:"Bernard Courtois",summary:"Lustrous purple-black solid."},{number:54,symbol:"Xe",name:"Xenon",atomic_mass:131.29,category:"noble gas",xpos:18,ypos:5,cpk_hex:"429eb0",phase:"Gas",discovered_by:"William Ramsay",summary:"Denser than air, noble gas."},{number:55,symbol:"Cs",name:"Cesium",atomic_mass:132.91,category:"alkali metal",xpos:1,ypos:6,cpk_hex:"57178f",phase:"Solid",discovered_by:"Robert Bunsen",summary:"Extremely reactive metal.",crystal_structure:"BCC"},{number:56,symbol:"Ba",name:"Barium",atomic_mass:137.33,category:"alkaline earth metal",xpos:2,ypos:6,cpk_hex:"00c900",phase:"Solid",discovered_by:"Carl Wilhelm Scheele",summary:"Highly reactive metal.",crystal_structure:"BCC"},{number:57,symbol:"La",name:"Lanthanum",atomic_mass:138.91,category:"lanthanide",xpos:4,ypos:9,cpk_hex:"70d4ff",phase:"Solid",discovered_by:"Carl Gustaf Mosander",summary:"Silvery-white metallic element.",crystal_structure:"HCP"},{number:58,symbol:"Ce",name:"Cerium",atomic_mass:140.12,category:"lanthanide",xpos:5,ypos:9,cpk_hex:"ffffc7",phase:"Solid",discovered_by:"Martin Klaproth",summary:"Most abundant rare-earth.",crystal_structure:"FCC"},{number:59,symbol:"Pr",name:"Praseodymium",atomic_mass:140.91,category:"lanthanide",xpos:6,ypos:9,cpk_hex:"d9ffc7",phase:"Solid",discovered_by:"Carl von Welsbach",summary:"Soft silvery metal.",crystal_structure:"HCP"},{number:60,symbol:"Nd",name:"Neodymium",atomic_mass:144.24,category:"lanthanide",xpos:7,ypos:9,cpk_hex:"c7ffc7",phase:"Solid",discovered_by:"Carl von Welsbach",summary:"Strong permanent magnets.",crystal_structure:"HCP"},{number:61,symbol:"Pm",name:"Promethium",atomic_mass:145,category:"lanthanide",xpos:8,ypos:9,cpk_hex:"a3ffc7",phase:"Solid",discovered_by:"Wu",summary:"All isotopes are radioactive."},{number:62,symbol:"Sm",name:"Samarium",atomic_mass:150.36,category:"lanthanide",xpos:9,ypos:9,cpk_hex:"8fffc7",phase:"Solid",discovered_by:"Lecoq de Boisbaudran",summary:"Moderately hard silvery metal."},{number:63,symbol:"Eu",name:"Europium",atomic_mass:151.96,category:"lanthanide",xpos:10,ypos:9,cpk_hex:"61ffc7",phase:"Solid",discovered_by:"Eugne Demaray",summary:"Most reactive rare-earth.",crystal_structure:"BCC"},{number:64,symbol:"Gd",name:"Gadolinium",atomic_mass:157.25,category:"lanthanide",xpos:11,ypos:9,cpk_hex:"45ffc7",phase:"Solid",discovered_by:"Marignac",summary:"Used in MRI contrast agents.",crystal_structure:"HCP"},{number:65,symbol:"Tb",name:"Terbium",atomic_mass:158.93,category:"lanthanide",xpos:12,ypos:9,cpk_hex:"30ffc7",phase:"Solid",discovered_by:"Mosander",summary:"Rare earth metal.",crystal_structure:"HCP"},{number:66,symbol:"Dy",name:"Dysprosium",atomic_mass:162.5,category:"lanthanide",xpos:13,ypos:9,cpk_hex:"1fffc7",phase:"Solid",discovered_by:"Boisbaudran",summary:"Used in high power magnets.",crystal_structure:"HCP"},{number:67,symbol:"Ho",name:"Holmium",atomic_mass:164.93,category:"lanthanide",xpos:14,ypos:9,cpk_hex:"00ff9c",phase:"Solid",discovered_by:"Delafontaine",summary:"Highest magnetic strength.",crystal_structure:"HCP"},{number:68,symbol:"Er",name:"Erbium",atomic_mass:167.26,category:"lanthanide",xpos:15,ypos:9,cpk_hex:"00e675",phase:"Solid",discovered_by:"Mosander",summary:"Pink ions used in lasers.",crystal_structure:"HCP"},{number:69,symbol:"Tm",name:"Thulium",atomic_mass:168.93,category:"lanthanide",xpos:16,ypos:9,cpk_hex:"00d452",phase:"Solid",discovered_by:"Cleve",summary:"Rare earth element.",crystal_structure:"HCP"},{number:70,symbol:"Yb",name:"Ytterbium",atomic_mass:173.05,category:"lanthanide",xpos:17,ypos:9,cpk_hex:"00bf38",phase:"Solid",discovered_by:"Marignac",summary:"Soft and malleable.",crystal_structure:"FCC"},{number:71,symbol:"Lu",name:"Lutetium",atomic_mass:174.97,category:"lanthanide",xpos:18,ypos:9,cpk_hex:"00ab24",phase:"Solid",discovered_by:"Urbain",summary:"Hardest rare-earth metal.",crystal_structure:"HCP"},{number:72,symbol:"Hf",name:"Hafnium",atomic_mass:178.49,category:"transition metal",xpos:4,ypos:6,cpk_hex:"4dc2ff",phase:"Solid",discovered_by:"Dirk Coster",summary:"Lustrous silvery grey metal.",crystal_structure:"HCP"},{number:73,symbol:"Ta",name:"Tantalum",atomic_mass:180.95,category:"transition metal",xpos:5,ypos:6,cpk_hex:"4da6ff",phase:"Solid",discovered_by:"Ekeberg",summary:"Rare and hard metal.",crystal_structure:"BCC"},{number:74,symbol:"W",name:"Tungsten",atomic_mass:183.84,category:"transition metal",xpos:6,ypos:6,cpk_hex:"2194d6",phase:"Solid",discovered_by:"Scheele",summary:"Highest melting point of metals.",crystal_structure:"BCC"},{number:75,symbol:"Re",name:"Rhenium",atomic_mass:186.21,category:"transition metal",xpos:7,ypos:6,cpk_hex:"267daa",phase:"Solid",discovered_by:"Ogawa",summary:"One of the rarest elements.",crystal_structure:"HCP"},{number:76,symbol:"Os",name:"Osmium",atomic_mass:190.23,category:"transition metal",xpos:8,ypos:6,cpk_hex:"266696",phase:"Solid",discovered_by:"Tennant",summary:"Densest natural element.",crystal_structure:"HCP"},{number:77,symbol:"Ir",name:"Iridium",atomic_mass:192.22,category:"transition metal",xpos:9,ypos:6,cpk_hex:"175487",phase:"Solid",discovered_by:"Tennant",summary:"Most corrosion resistant.",crystal_structure:"FCC"},{number:78,symbol:"Pt",name:"Platinum",atomic_mass:195.08,category:"transition metal",xpos:10,ypos:6,cpk_hex:"d0d0e0",phase:"Solid",discovered_by:"Ulloa",summary:"Precious metal.",crystal_structure:"FCC"},{number:79,symbol:"Au",name:"Gold",atomic_mass:196.97,category:"transition metal",xpos:11,ypos:6,cpk_hex:"ffd123",phase:"Solid",discovered_by:"Ancient",summary:"Most malleable of all metals.",crystal_structure:"FCC",reaction_type:"Inert"},{number:80,symbol:"Hg",name:"Mercury",atomic_mass:200.59,category:"transition metal",xpos:12,ypos:6,cpk_hex:"b8b8d0",phase:"Liquid",discovered_by:"Ancient",summary:"Only liquid metal at room temp."},{number:81,symbol:"Tl",name:"Thallium",atomic_mass:204.38,category:"post-transition metal",xpos:13,ypos:6,cpk_hex:"a6544d",phase:"Solid",discovered_by:"Crookes",summary:"Highly toxic metal.",crystal_structure:"HCP"},{number:82,symbol:"Pb",name:"Lead",atomic_mass:207.2,category:"post-transition metal",xpos:14,ypos:6,cpk_hex:"575961",phase:"Solid",discovered_by:"Ancient",summary:"Heavy and dense metal.",crystal_structure:"FCC"},{number:83,symbol:"Bi",name:"Bismuth",atomic_mass:208.98,category:"post-transition metal",xpos:15,ypos:6,cpk_hex:"9e4fb5",phase:"Solid",discovered_by:"Geoffroy",summary:"Brittle pinkish metal."},{number:84,symbol:"Po",name:"Polonium",atomic_mass:209,category:"post-transition metal",xpos:16,ypos:6,cpk_hex:"ab5c00",phase:"Solid",discovered_by:"Curie",summary:"Highly radioactive metal.",crystal_structure:"SimpleCubic"},{number:85,symbol:"At",name:"Astatine",atomic_mass:210,category:"metalloid",xpos:17,ypos:6,cpk_hex:"754f45",phase:"Solid",discovered_by:"Corson",summary:"Rarest natural element."},{number:86,symbol:"Rn",name:"Radon",atomic_mass:222,category:"noble gas",xpos:18,ypos:6,cpk_hex:"428296",phase:"Gas",discovered_by:"Dorn",summary:"Radioactive noble gas."},{number:87,symbol:"Fr",name:"Francium",atomic_mass:223,category:"alkali metal",xpos:1,ypos:7,cpk_hex:"420066",phase:"Solid",discovered_by:"Marguerite Perey",summary:"Extremely radioactive.",crystal_structure:"BCC"},{number:88,symbol:"Ra",name:"Radium",atomic_mass:226,category:"alkaline earth metal",xpos:2,ypos:7,cpk_hex:"006600",phase:"Solid",discovered_by:"Marie Curie",summary:"Used in luminous paints.",crystal_structure:"BCC"},{number:89,symbol:"Ac",name:"Actinium",atomic_mass:227,category:"actinide",xpos:4,ypos:10,cpk_hex:"70abff",phase:"Solid",discovered_by:"Friedrich Oskar Giesel",summary:"Soft silvery radioactive metal.",crystal_structure:"FCC"},{number:90,symbol:"Th",name:"Thorium",atomic_mass:232.04,category:"actinide",xpos:5,ypos:10,cpk_hex:"00baff",phase:"Solid",discovered_by:"Berzelius",summary:"Weakly radioactive metal.",crystal_structure:"FCC"},{number:91,symbol:"Pa",name:"Protactinium",atomic_mass:231.04,category:"actinide",xpos:6,ypos:10,cpk_hex:"00a1ff",phase:"Solid",discovered_by:"Crookes",summary:"Dense silvery-grey actinide.",crystal_structure:"BCC"},{number:92,symbol:"U",name:"Uranium",atomic_mass:238.03,category:"actinide",xpos:7,ypos:10,cpk_hex:"008fff",phase:"Solid",discovered_by:"Klaproth",summary:"Used in nuclear power."},{number:93,symbol:"Np",name:"Neptunium",atomic_mass:237,category:"actinide",xpos:8,ypos:10,cpk_hex:"0080ff",phase:"Solid",discovered_by:"McMillan",summary:"Transuranic radioactive element."},{number:94,symbol:"Pu",name:"Plutonium",atomic_mass:244,category:"actinide",xpos:9,ypos:10,cpk_hex:"006bff",phase:"Solid",discovered_by:"Seaborg",summary:"Radioactive actinide metal."},{number:95,symbol:"Am",name:"Americium",atomic_mass:243,category:"actinide",xpos:10,ypos:10,cpk_hex:"545cf2",phase:"Solid",discovered_by:"Seaborg",summary:"Used in smoke detectors."},{number:96,symbol:"Cm",name:"Curium",atomic_mass:247,category:"actinide",xpos:11,ypos:10,cpk_hex:"785ce3",phase:"Solid",discovered_by:"Seaborg",summary:"Named after the Curies."},{number:97,symbol:"Bk",name:"Berkelium",atomic_mass:247,category:"actinide",xpos:12,ypos:10,cpk_hex:"8a4fe3",phase:"Solid",discovered_by:"Seaborg",summary:"Named after Berkeley."},{number:98,symbol:"Cf",name:"Californium",atomic_mass:251,category:"actinide",xpos:13,ypos:10,cpk_hex:"a136d4",phase:"Solid",discovered_by:"Seaborg",summary:"Radioactive element."},{number:99,symbol:"Es",name:"Einsteinium",atomic_mass:252,category:"actinide",xpos:14,ypos:10,cpk_hex:"b31fd4",phase:"Solid",discovered_by:"Ghiorso",summary:"Named after Einstein."},{number:100,symbol:"Fm",name:"Fermium",atomic_mass:257,category:"actinide",xpos:15,ypos:10,cpk_hex:"b31fba",phase:"Solid",discovered_by:"Ghiorso",summary:"Named after Fermi."},{number:101,symbol:"Md",name:"Mendelevium",atomic_mass:258,category:"actinide",xpos:16,ypos:10,cpk_hex:"b30da6",phase:"Solid",discovered_by:"Ghiorso",summary:"Named after Mendeleev."},{number:102,symbol:"No",name:"Nobelium",atomic_mass:259,category:"actinide",xpos:17,ypos:10,cpk_hex:"bd0d87",phase:"Solid",discovered_by:"Nobel Institute",summary:"Named after Nobel."},{number:103,symbol:"Lr",name:"Lawrencium",atomic_mass:262,category:"actinide",xpos:18,ypos:10,cpk_hex:"c70066",phase:"Solid",discovered_by:"Ghiorso",summary:"Named after Lawrence."},{number:104,symbol:"Rf",name:"Rutherfordium",atomic_mass:267,category:"transition metal",xpos:4,ypos:7,cpk_hex:"cc0059",phase:"Solid",discovered_by:"JINR",summary:"Synthetic radioactive element."},{number:105,symbol:"Db",name:"Dubnium",atomic_mass:268,category:"transition metal",xpos:5,ypos:7,cpk_hex:"d1004f",phase:"Solid",discovered_by:"JINR",summary:"Synthetic radioactive element."},{number:106,symbol:"Sg",name:"Seaborgium",atomic_mass:269,category:"transition metal",xpos:6,ypos:7,cpk_hex:"d90045",phase:"Solid",discovered_by:"Berkeley",summary:"Synthetic radioactive element."},{number:107,symbol:"Bh",name:"Bohrium",atomic_mass:270,category:"transition metal",xpos:7,ypos:7,cpk_hex:"e00038",phase:"Solid",discovered_by:"GSI",summary:"Synthetic radioactive element."},{number:108,symbol:"Hs",name:"Hassium",atomic_mass:269,category:"transition metal",xpos:8,ypos:7,cpk_hex:"e6002e",phase:"Solid",discovered_by:"GSI",summary:"Synthetic radioactive element."},{number:109,symbol:"Mt",name:"Meitnerium",atomic_mass:278,category:"unknown",xpos:9,ypos:7,cpk_hex:"eb0024",phase:"Solid",discovered_by:"GSI",summary:"Synthetic radioactive element."},{number:110,symbol:"Ds",name:"Darmstadtium",atomic_mass:281,category:"unknown",xpos:10,ypos:7,cpk_hex:"null",phase:"Solid",discovered_by:"GSI",summary:"Synthetic radioactive element."},{number:111,symbol:"Rg",name:"Roentgenium",atomic_mass:282,category:"unknown",xpos:11,ypos:7,cpk_hex:"null",phase:"Solid",discovered_by:"GSI",summary:"Synthetic radioactive element."},{number:112,symbol:"Cn",name:"Copernicium",atomic_mass:285,category:"transition metal",xpos:12,ypos:7,cpk_hex:"null",phase:"Gas",discovered_by:"GSI",summary:"Synthetic radioactive element."},{number:113,symbol:"Nh",name:"Nihonium",atomic_mass:286,category:"unknown",xpos:13,ypos:7,cpk_hex:"null",phase:"Solid",discovered_by:"RIKEN",summary:"Synthetic radioactive element."},{number:114,symbol:"Fl",name:"Flerovium",atomic_mass:289,category:"post-transition metal",xpos:14,ypos:7,cpk_hex:"null",phase:"Solid",discovered_by:"JINR",summary:"Synthetic radioactive element."},{number:115,symbol:"Mc",name:"Moscovium",atomic_mass:290,category:"unknown",xpos:15,ypos:7,cpk_hex:"null",phase:"Solid",discovered_by:"JINR",summary:"Synthetic radioactive element."},{number:116,symbol:"Lv",name:"Livermorium",atomic_mass:293,category:"unknown",xpos:16,ypos:7,cpk_hex:"null",phase:"Solid",discovered_by:"JINR",summary:"Synthetic radioactive element."},{number:117,symbol:"Ts",name:"Tennessine",atomic_mass:294,category:"unknown",xpos:17,ypos:7,cpk_hex:"null",phase:"Solid",discovered_by:"JINR",summary:"Synthetic radioactive element."},{number:118,symbol:"Og",name:"Oganesson",atomic_mass:294,category:"noble gas",xpos:18,ypos:7,cpk_hex:"null",phase:"Solid",discovered_by:"JINR",summary:"Synthetic radioactive element."}],Ir={"diatomic nonmetal":"#4ade80","noble gas":"#60a5fa","alkali metal":"#f87171","alkaline earth metal":"#fbbf24",metalloid:"#c084fc","polyatomic nonmetal":"#34d399","post-transition metal":"#94a3b8","transition metal":"#f472b6",lanthanide:"#a78bfa",actinide:"#fb7185",unknown:"#525252"};var at=(l=>(l.TABLE="Table",l.SPHERE="Sphere",l.HELIX="Helix",l.GRID="Grid",l))(at||{}),vt=(l=>(l.ATOMIC="Atomic",l.CRYSTAL="Crystal",l.REACTION="Reaction",l))(vt||{}),Qe=(l=>(l.LOW="Low",l.MEDIUM="Medium",l.HIGH="High",l))(Qe||{});const vn="elemental3d-settings",Ia=1;class yc{save(r){const u={...this.load()||{isPanelOpen:!0,performance:Qe.MEDIUM,layout:at.TABLE},...r,savedAt:Date.now(),version:Ia};try{return Io(vn,u),!0}catch(t){return console.error("Failed to save settings:",t),!1}}load(){try{const r=Lo(vn,!0);if(r&&r.version===Ia)return r}catch(r){console.error("Failed to load settings:",r)}return null}getSettings(){const r=this.load();return{isPanelOpen:r?.isPanelOpen??!0,performance:r?.performance??Qe.MEDIUM,layout:r?.layout??at.TABLE}}deleteSave(){try{return Oo(vn),!0}catch{return!1}}hasSave(){return this.load()!==null}}const Ur=new yc,gc=({element:l,position:r,isSelected:c,isMatched:u,onSelect:t})=>{const e=b.useRef(null),n=b.useRef(null),o=b.useRef(null),[a,s]=b.useState(!1),i=b.useMemo(()=>Ir[l.category]||Ir.unknown,[l.category]);et(h=>{if(e.current&&(e.current.position.lerp(new xe(r.x,r.y,r.z),.1),e.current.position.y+=Math.sin(h.clock.elapsedTime*.5+l.number)*.005),n.current){const m=u?.9:.05;n.current.opacity=rr.lerp(n.current.opacity,m,.1);const p=u?c?2.5:.6:0;n.current.emissiveIntensity=rr.lerp(n.current.emissiveIntensity,p,.1)}if(o.current){const m=a&&u&&!c?.4:0;o.current.opacity=rr.lerp(o.current.opacity,m,.15)}});const d=h=>{h.stopPropagation(),u&&(document.body.style.cursor="pointer",s(!0))},f=h=>{h.stopPropagation(),document.body.style.cursor="auto",s(!1)};return C.jsxs("group",{ref:e,onClick:h=>{h.stopPropagation(),u&&t(l)},onPointerOver:d,onPointerOut:f,children:[C.jsx(Ta,{args:[1.5,2,1.6],radius:.08,smoothness:4,children:C.jsx("meshStandardMaterial",{ref:n,color:i,emissive:i,transparent:!0,roughness:.15,metalness:.7,opacity:.9})}),C.jsx(Ta,{args:[1.58,2.08,1.68],radius:.1,smoothness:4,raycast:()=>null,children:C.jsx("meshBasicMaterial",{ref:o,color:"white",transparent:!0,opacity:0,depthWrite:!1})}),u&&c&&C.jsxs("mesh",{raycast:()=>null,children:[C.jsx("boxGeometry",{args:[1.6,2.1,1.65]}),C.jsx("meshBasicMaterial",{color:"white",transparent:!0,opacity:.15,wireframe:!0})]}),C.jsxs("group",{position:[0,0,.81],raycast:()=>null,children:[C.jsx(tr,{position:[-.55,.8,0],fontSize:.16,color:"black",anchorX:"left",anchorY:"top",fillOpacity:u?1:.1,children:l.number}),C.jsx(tr,{position:[0,.15,0],fontSize:.7,fontWeight:"bold",color:"black",anchorX:"center",anchorY:"middle",fillOpacity:u?1:.1,children:l.symbol}),C.jsx(tr,{position:[0,-.4,0],fontSize:.18,color:"black",anchorX:"center",anchorY:"top",fillOpacity:u?1:.1,children:l.name}),C.jsx(tr,{position:[0,-.7,0],fontSize:.11,color:"black",anchorX:"center",anchorY:"top",fillOpacity:u?1:.1,children:l.atomic_mass.toFixed(3)})]})]})},bc=({element:l,isOpen:r,onClose:c})=>{if(!l)return null;const u=Ir[l.category]||Ir.unknown,t=e=>e==null||e===""?C.jsx("span",{className:"text-slate-600 italic",children:"N/A"}):C.jsx("span",{className:"text-white",children:e});return C.jsxs("div",{className:`fixed z-50 bg-slate-900/95 backdrop-blur-3xl shadow-2xl transition-all duration-500 ease-in-out text-slate-100 overflow-y-auto details-scrollbar
                md:top-1/2 md:-translate-y-1/2 md:right-8 md:left-auto md:w-122.5 md:h-[90vh] md:border md:border-white/10 md:p-10 md:rounded-2xl
                bottom-0 left-0 right-0 w-full max-h-[75vh] rounded-t-2xl p-6 border-t border-white/10
                ${r?"translate-y-0 opacity-100 md:translate-x-0":"translate-y-full opacity-0 md:translate-x-[calc(100%+2rem)]"}`,children:[C.jsx("div",{className:"w-12 h-1.5 bg-white/20 rounded-full mx-auto mb-6 md:hidden shrink-0"}),C.jsxs("div",{className:"flex justify-between items-start mb-8 md:mb-12",children:[C.jsxs("div",{children:[C.jsx("span",{className:"text-4xl md:text-6xl font-black tracking-tighter",style:{color:u},children:l.symbol}),C.jsx("h2",{className:"text-2xl md:text-4xl font-bold mt-3 text-white",children:l.name}),C.jsx("p",{className:"text-[10px] md:text-xs font-bold opacity-50 uppercase tracking-[0.2em] mt-2",children:l.category})]}),C.jsx("button",{onClick:c,className:"p-2 hover:bg-white/10 rounded-full transition-all active:scale-90",title:"Hide Details",children:C.jsx(os,{className:"w-5 h-5 md:w-7 md:h-7"})})]}),C.jsxs("div",{className:"grid grid-cols-2 gap-3 md:gap-5 mb-8 md:mb-12",children:[C.jsxs("div",{className:"bg-white/5 p-4 md:p-6 rounded-2xl border border-white/10",children:[C.jsxs("p",{className:"text-[9px] md:text-[11px] text-slate-500 font-bold uppercase mb-2 flex items-center gap-1",children:[C.jsx(Ha,{className:"w-3 h-3"})," Atomic No."]}),C.jsx("p",{className:"text-lg md:text-2xl font-mono font-bold",children:t(l.number)})]}),C.jsxs("div",{className:"bg-white/5 p-4 md:p-6 rounded-2xl border border-white/10",children:[C.jsx("p",{className:"text-[9px] md:text-[11px] text-slate-500 font-bold uppercase mb-2",children:"Atomic Mass"}),C.jsxs("p",{className:"text-lg md:text-2xl font-mono font-bold truncate",children:[t(l.atomic_mass)," ",C.jsx("span",{className:"text-[10px] text-slate-400",children:"u"})]})]}),C.jsxs("div",{className:"bg-white/5 p-4 md:p-6 rounded-2xl border border-white/10",children:[C.jsx("p",{className:"text-[9px] md:text-[11px] text-slate-500 font-bold uppercase mb-2",children:"Phase (STP)"}),C.jsx("p",{className:"text-lg md:text-2xl font-mono font-bold",children:t(l.phase)})]}),C.jsxs("div",{className:"bg-white/5 p-4 md:p-6 rounded-2xl border border-white/10",children:[C.jsxs("p",{className:"text-[9px] md:text-[11px] text-slate-500 font-bold uppercase mb-2 flex items-center gap-1",children:[C.jsx(hi,{className:"w-3 h-3"})," Discoverer"]}),C.jsx("p",{className:"text-xs md:text-base truncate font-mono font-bold",children:t(l.discovered_by)})]}),C.jsxs("div",{className:"bg-white/5 p-4 md:p-6 rounded-2xl border border-white/10",children:[C.jsxs("p",{className:"text-[9px] md:text-[11px] text-slate-500 font-bold uppercase mb-2 flex items-center gap-1",children:[C.jsx(Za,{className:"w-3 h-3"})," Crystal"]}),C.jsx("p",{className:"text-xs md:text-base font-mono font-bold",children:t(l.crystal_structure)})]}),C.jsxs("div",{className:"bg-white/5 p-4 md:p-6 rounded-2xl border border-white/10",children:[C.jsxs("p",{className:"text-[9px] md:text-[11px] text-slate-500 font-bold uppercase mb-2 flex items-center gap-1",children:[C.jsx($a,{className:"w-3 h-3"})," Reactivity"]}),C.jsx("p",{className:"text-xs md:text-base font-mono font-bold",children:t(l.reaction_type)})]})]}),C.jsxs("div",{className:"mb-8 md:mb-12",children:[C.jsxs("h3",{className:"flex items-center gap-2 text-xs md:text-sm font-bold uppercase tracking-widest mb-4 md:mb-6 text-slate-400",children:[C.jsx(oi,{className:"w-3.5 h-3.5 md:w-5 md:h-5 text-blue-400"}),"Chemical Summary"]}),C.jsxs("p",{className:"text-slate-300 leading-relaxed text-xs md:text-base bg-black/40 p-5 md:p-7 rounded-2xl border border-white/5 shadow-inner italic",children:['"',l.summary||"Scientific information currently unavailable for this element.",'"']})]}),C.jsx("div",{className:"p-5 bg-blue-500/10 border border-blue-500/20 rounded-2xl text-[10px] md:text-xs text-blue-300/80 text-center font-medium",children:'The model remains active. Click "Back to Elements" in the top bar to return to the periodic table.'})]})},xc=({radius:l,speed:r,offset:c,trailLength:u})=>{const t=b.useRef(null);return et(e=>{if(t.current){const n=e.clock.getElapsedTime()*r+c;t.current.position.set(Math.cos(n)*l,0,Math.sin(n)*l)}}),C.jsx("group",{ref:t,children:C.jsx(Il,{width:.25,length:u,color:"#facc15",attenuation:e=>e*e,children:C.jsx(Un,{args:[.06,12,12],children:C.jsx("meshBasicMaterial",{color:"#facc15"})})})})},_c=({radius:l})=>{const r=b.useMemo(()=>{const c=[];for(let t=0;t<=128;t++){const e=t/128*Math.PI*2;c.push(new xe(Math.cos(e)*l,0,Math.sin(e)*l))}return c},[l]);return C.jsx(ao,{points:r,color:"white",lineWidth:.5,transparent:!0,opacity:.15})},Sc=({protons:l,neutrons:r,maxParticles:c,isPanelOpen:u})=>{const t=b.useRef(null),e=l+r,n=Math.min(e,c),o=b.useMemo(()=>{const a=[],s=Array.from({length:n},(d,f)=>f<n*(l/e)?"#ef4444":"#3b82f6");for(let d=s.length-1;d>0;d--){const f=Math.floor(Math.random()*(d+1));[s[d],s[f]]=[s[f],s[d]]}const i=.22*Math.pow(n,1/3);for(let d=0;d<n;d++){const f=Math.random(),h=Math.random(),m=2*Math.PI*f,p=Math.acos(2*h-1),v=i*Math.pow(Math.random(),.33);a.push({pos:[v*Math.sin(p)*Math.cos(m),v*Math.sin(p)*Math.sin(m),v*Math.cos(p)],color:s[d]})}return a},[l,r,n]);return et(a=>{if(t.current){const s=a.clock.getElapsedTime(),i=1+Math.sin(s*1.5)*.01;t.current.scale.set(i,i,i),t.current.rotation.y+=.005}}),C.jsxs("group",{children:[C.jsx("group",{ref:t,children:o.map((a,s)=>C.jsx("group",{position:a.pos,children:C.jsx(Un,{args:[.18,12,12],children:C.jsx("meshStandardMaterial",{color:a.color,emissive:a.color,emissiveIntensity:.5,roughness:.2,metalness:.4})})},s))}),C.jsx(wi,{position:[0,1.5,0],center:!0,distanceFactor:10,style:{transition:"opacity 0.3s ease-in-out",opacity:u?0:1,pointerEvents:"none"},children:C.jsxs("div",{className:"whitespace-nowrap bg-black/90 backdrop-blur-md text-white px-3 py-1.5 rounded-full text-[9px] font-black uppercase tracking-tighter border border-white/20 flex items-center gap-3 shadow-2xl",children:[C.jsxs("span",{className:"flex items-center gap-1.5",children:[C.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500"}),l,"P"]}),C.jsx("div",{className:"w-px h-2 bg-white/20"}),C.jsxs("span",{className:"flex items-center gap-1.5",children:[C.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),r,"N"]})]})})]})},wc=({element:l,performance:r=Qe.MEDIUM,isPanelOpen:c})=>{const u=l.number,t=Math.round(l.atomic_mass)-u,e=b.useMemo(()=>{switch(r){case Qe.LOW:return{maxParticles:20,trail:1};case Qe.HIGH:return{maxParticles:150,trail:6};default:return{maxParticles:80,trail:3}}},[r]),n=b.useMemo(()=>{let o=u;const a=[2,8,18,32,32,18,8],s=[];for(const i of a){if(o<=0)break;const d=Math.min(o,i);s.push(d),o-=d}return s},[u]);return C.jsx(Dn,{speed:1,rotationIntensity:.05,floatIntensity:.05,children:C.jsxs("group",{scale:1,children:[C.jsx(Sc,{protons:u,neutrons:t,maxParticles:e.maxParticles,isPanelOpen:c}),n.map((o,a)=>{const s=(a+1)*2.2;return C.jsxs("group",{children:[C.jsx(_c,{radius:s}),C.jsx(Ui,{position:[s,.2,0],children:C.jsxs(tr,{fontSize:.12,color:"#94a3b8",anchorX:"center",anchorY:"bottom",fontWeight:"bold",children:["n=",a+1]})}),Array.from({length:o}).map((i,d)=>C.jsx(xc,{radius:s,speed:.4/(a+1),offset:d/o*Math.PI*2,trailLength:e.trail},d))]},a)})]})})},kc=({element:l})=>{const r=l.crystal_structure||"SimpleCubic",{points:c,bonds:u}=b.useMemo(()=>{const t=[],e=[],o=[[-2,-2,-2],[2,-2,-2],[2,2,-2],[-2,2,-2],[-2,-2,2],[2,-2,2],[2,2,2],[-2,2,2]];if(t.push(...o),[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]].forEach(([s,i])=>e.push([o[s],o[i]])),r==="BCC")t.push([0,0,0]),o.forEach(s=>e.push([[0,0,0],s]));else if(r==="FCC"){const s=[[2,0,0],[-2,0,0],[0,2,0],[0,-2,0],[0,0,2],[0,0,-2]];t.push(...s)}else if(r==="Diamond"){const s=[[-1,-1,-1],[1,1,-1],[-1,1,1],[1,-1,1]];t.push(...s)}return{points:t,bonds:e}},[r]);return C.jsx(Dn,{speed:1.5,rotationIntensity:.5,floatIntensity:.5,children:C.jsxs("group",{scale:1.2,children:[c.map((t,e)=>C.jsx(Un,{position:t,args:[.3,16,16],children:C.jsx("meshStandardMaterial",{color:l.cpk_hex?`#${l.cpk_hex}`:"#fff",metalness:.8,roughness:.2})},e)),u.map((t,e)=>C.jsx(ao,{points:t,color:"white",lineWidth:1,transparent:!0,opacity:.3},e))]})})},Cc=({element:l,performance:r=Qe.MEDIUM})=>{const c=b.useRef(null),u=b.useMemo(()=>{switch(r){case Qe.LOW:return 500;case Qe.HIGH:return 5e3;default:return 2e3}},[r]),t=b.useMemo(()=>{const n=new Float32Array(u*3);for(let o=0;o<u;o++)n[o*3]=(Math.random()-.5)*2,n[o*3+1]=(Math.random()-.5)*2,n[o*3+2]=(Math.random()-.5)*2;return n},[u]);et(n=>{if(!c.current)return;const o=n.clock.getElapsedTime(),a=l.reaction_type,s=c.current.geometry.attributes.position.array;for(let i=0;i<u;i++){const d=i*3;a==="Combustion"?(s[d+1]+=Math.random()*.1,s[d+1]>5&&(s[d]=(Math.random()-.5)*1,s[d+1]=-2,s[d+2]=(Math.random()-.5)*1)):a==="Oxidation"?(s[d+1]-=Math.random()*.01,s[d+1]<-3&&(s[d+1]=3),s[d]+=Math.sin(o+i)*.005):(s[d]+=Math.sin(o*.2+i)*.002,s[d+1]+=Math.cos(o*.2+i)*.002)}c.current.geometry.attributes.position.needsUpdate=!0});const e=b.useMemo(()=>l.name==="Magnesium"?"#ffffff":l.reaction_type==="Combustion"?"#ff6600":l.reaction_type==="Oxidation"?"#8b4513":"#4fc3f7",[l]);return C.jsxs("group",{children:[C.jsx(Xl,{ref:c,positions:t,stride:3,children:C.jsx(Nl,{transparent:!0,vertexColors:!1,color:e,size:.15,sizeAttenuation:!0,depthWrite:!1,blending:as})}),C.jsx("pointLight",{intensity:2,color:e,distance:10})]})},Mc=({orbitRef:l,isSelected:r,selectedElementId:c,isPanelOpen:u})=>{const{camera:t}=ot(),e=Oa(),n=b.useRef(!1),o=b.useRef(!1),a=b.useRef(void 0);return b.useEffect(()=>{r&&c!==a.current?(n.current=!0,a.current=c):r||(a.current=void 0)},[r,c]),b.useEffect(()=>{const s=l.current;if(!s)return;const i=()=>{o.current=!0},d=()=>{o.current=!1};return s.addEventListener("start",i),s.addEventListener("end",d),()=>{s.removeEventListener("start",i),s.removeEventListener("end",d)}},[l.current]),et(()=>{if(!l.current)return;const s=new xe(0,0,0);if(!e&&r&&u&&(s.x=2.5),l.current.target.lerp(s,.1),r){if(n.current){const i=e?new xe(0,10,25):new xe(0,7,14);!e&&u&&(i.x=-1.5),t.position.distanceTo(i)>.1?t.position.lerp(i,.1):n.current=!1}}else if(!o.current){const i=e?new xe(0,0,100):new xe(0,0,60);t.position.distanceTo(i)>.1&&t.position.lerp(i,.02)}l.current.update()}),null},La=({performance:l,onPerformanceChange:r,isMobile:c})=>C.jsxs(vc,{as:"div",className:"relative",children:[C.jsxs(_o,{className:"flex items-center gap-2 bg-slate-900/80 backdrop-blur-xl border border-white/10 px-3 md:px-4 py-2 md:py-2.5 rounded-full text-[10px] md:text-xs font-bold hover:bg-slate-800 transition-colors",children:[C.jsx($s,{className:"w-3 h-3 md:w-4 md:h-4 text-blue-400"}),C.jsx("span",{children:c?l:`Performance: ${l}`}),C.jsx(Zs,{className:"w-3 h-3 opacity-50"})]}),C.jsx(So,{className:"absolute right-0 mt-2 w-40 origin-top-right rounded-2xl bg-slate-900 border border-white/10 p-2 shadow-2xl focus:outline-none z-50",children:[Qe.LOW,Qe.MEDIUM,Qe.HIGH].map(u=>C.jsx(wo,{children:({focus:t})=>C.jsx("button",{onClick:()=>r(u),className:`${t||l===u?"bg-blue-600 text-white":"text-slate-400"} group flex w-full items-center rounded-xl px-3 py-2 text-xs font-bold transition-colors mb-1 last:mb-0`,children:u})},u))})]}),Ac=()=>{const l=b.useMemo(()=>Ur.getSettings(),[]),[r,c]=b.useState(l.layout),[u,t]=b.useState(null),[e,n]=b.useState(l.isPanelOpen),[o,a]=b.useState(vt.ATOMIC),[s,i]=b.useState(l.performance),[d,f]=b.useState(""),{isVisible:h}=Bo(),m=Oa(),p=b.useRef(null),v=b.useRef(null);b.useEffect(()=>{m&&n(!1)},[m]);const E=b.useMemo(()=>{if(!d)return new Set(Ke.map(O=>O.number));const g=d.toLowerCase();return new Set(Ke.filter(O=>O.name.toLowerCase().includes(g)||O.symbol.toLowerCase().includes(g)||O.number.toString().includes(g)).map(O=>O.number))},[d]),w=b.useMemo(()=>{const g=new Map;return Ke.forEach((O,_)=>{let I=0,F=0,V=0;switch(r){case at.TABLE:I=(O.xpos-9.5)*2,F=(5-O.ypos)*2.5,V=0;break;case at.GRID:const Y=15;I=(_%Y-Y/2)*2.2,F=(Math.floor(_/Y)-4)*-2.8,V=0;break;case at.SPHERE:const Q=Math.acos(-1+2*_/Ke.length),W=Math.sqrt(Ke.length*Math.PI)*Q,N=22;I=N*Math.cos(W)*Math.sin(Q),F=N*Math.sin(W)*Math.sin(Q),V=N*Math.cos(Q);break;case at.HELIX:const B=_*.18+Math.PI,y=(_-Ke.length/2)*.45;I=Math.cos(B)*18,V=Math.sin(B)*18,F=y;break}g.set(O.number,{x:I,y:F,z:V})}),g},[r]),S=g=>{n(g),Ur.save({isPanelOpen:g})},x=g=>{c(g),Ur.save({layout:g})},A=g=>{i(g),Ur.save({performance:g})},T=g=>{t(g),g&&a(vt.ATOMIC)},M=g=>{if(g.stopPropagation(),!u)return;const _=(Ke.findIndex(I=>I.number===u.number)-1+Ke.length)%Ke.length;T(Ke[_])},U=g=>{if(g.stopPropagation(),!u)return;const _=(Ke.findIndex(I=>I.number===u.number)+1)%Ke.length;T(Ke[_])},L=b.useMemo(()=>{switch(s){case Qe.LOW:return{count:3e3,factor:4};case Qe.HIGH:return{count:2e4,factor:8};default:return{count:12e3,factor:7}}},[s]);return C.jsxs("div",{className:"relative w-full h-dvh bg-dark-bg overflow-hidden text-white",children:[C.jsxs(Do,{shadows:!0,dpr:[1,2],frameloop:h?"always":"never",children:[C.jsx(Bl,{ref:v,makeDefault:!0,position:[0,0,m?100:60],fov:40}),C.jsx(Ro,{ref:p,enableDamping:!0,dampingFactor:.05,minDistance:5,maxDistance:250,enablePan:!1}),C.jsx("ambientLight",{intensity:.5}),C.jsx("spotLight",{position:[100,100,100],angle:.15,penumbra:1,intensity:1,castShadow:!0}),C.jsx("pointLight",{position:[20,20,20],intensity:1.5,color:"#3b82f6"}),C.jsx(ls,{radius:250,depth:60,count:L.count,factor:L.factor,saturation:.5,fade:!0,speed:2}),C.jsxs(b.Suspense,{fallback:null,children:[C.jsx(Mc,{orbitRef:p,isSelected:!!u,selectedElementId:u?.number,isPanelOpen:e}),!u&&C.jsx(Dn,{speed:1.5,rotationIntensity:.2,floatIntensity:.3,children:Ke.map(g=>{const O=w.get(g.number);return O?C.jsx(gc,{element:g,position:O,isSelected:!1,isMatched:E.has(g.number),onSelect:T},g.number):null})}),u&&C.jsxs("group",{position:[0,0,0],children:[o===vt.ATOMIC&&C.jsx(wc,{element:u,performance:s,isPanelOpen:e}),o===vt.CRYSTAL&&C.jsx(kc,{element:u}),o===vt.REACTION&&C.jsx(Cc,{element:u,performance:s})]})]})]}),C.jsxs("div",{className:`absolute top-0 left-0 z-40 p-3 md:p-6 flex flex-col md:flex-row items-center justify-between gap-3 md:gap-4 pointer-events-none transition-all duration-300 ${e?"w-full md:w-[calc(100%-490px)]":"w-full"}`,children:[C.jsxs("div",{className:"pointer-events-auto flex items-center justify-between w-full md:w-auto gap-4",children:[C.jsx("div",{className:"flex items-center gap-4",children:u?C.jsxs("button",{onClick:()=>T(null),className:"flex items-center gap-2 text-white bg-blue-600/90 hover:bg-blue-500 backdrop-blur-md px-4 md:px-6 py-2 md:py-3 rounded-full transition-all shadow-[0_0_20px_rgba(37,99,235,0.4)] active:scale-95 group",children:[C.jsx(cs,{className:"w-4 h-4 md:w-5 md:h-5 group-hover:-translate-x-1 transition-transform"}),C.jsx("span",{className:"font-bold tracking-wide text-xs md:text-sm",children:"Back"})]}):C.jsx("div",{className:"bg-slate-900/40 p-2 md:p-4 rounded-2xl backdrop-blur-sm border border-white/10 shadow-xl flex items-center gap-3 md:gap-4",children:C.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[C.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 bg-linear-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-[10px] md:text-xs shadow-lg font-mono",children:"P"}),C.jsxs("div",{className:"flex flex-col",children:[C.jsxs("h1",{className:"text-lg md:text-2xl font-black text-white tracking-tighter",children:["ELEMENTAL",C.jsx("span",{className:"text-blue-500",children:"3D"})]}),C.jsx("p",{className:"text-[7px] md:text-[10px] text-blue-400/80 uppercase tracking-[0.3em] font-bold hidden xs:block",children:"Interactive 3D Explorer"})]})]})})}),C.jsx("div",{className:"md:hidden",children:C.jsx(La,{performance:s,onPerformanceChange:A,isMobile:!0})})]}),C.jsx("div",{className:"hidden md:block pointer-events-auto",children:C.jsx(La,{performance:s,onPerformanceChange:A,isMobile:!1})}),!u&&C.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/80 backdrop-blur-2xl border border-white/10 p-1.5 md:p-2.5 rounded-full pointer-events-auto shadow-2xl transition-all hover:border-blue-500/30",children:[C.jsxs("div",{className:"relative group px-1 md:px-2",children:[C.jsx(ci,{className:"absolute left-4 md:left-6 top-1/2 -translate-y-1/2 w-3.5 h-3.5 md:w-4 md:h-4 text-slate-500 group-focus-within:text-blue-400 transition-colors"}),C.jsx("input",{type:"text",placeholder:"Search...",value:d,onChange:g=>f(g.target.value),className:"bg-slate-950/80 border border-slate-700/50 rounded-full py-2 md:py-2.5 pl-9 md:pl-11 pr-4 md:pr-5 text-xs md:text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/40 w-36 md:w-64 transition-all"})]}),C.jsx("div",{className:"h-6 md:h-8 w-px bg-white/10 mx-0.5 md:mx-1"}),C.jsx("div",{className:"flex gap-0.5 md:gap-1",children:[{id:at.TABLE,icon:di,label:"Table"},{id:at.GRID,icon:ii,label:"Grid"},{id:at.SPHERE,icon:ri,label:"Sphere"},{id:at.HELIX,icon:us,label:"Helix"}].map(g=>C.jsxs("button",{onClick:()=>x(g.id),className:`p-1.5 md:p-2 rounded-full transition-all flex items-center gap-2 px-2 md:px-3 ${r===g.id?"bg-blue-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-slate-800"}`,children:[C.jsx(g.icon,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),C.jsx("span",{className:"text-[10px] font-bold hidden xl:block",children:g.label})]},g.id))})]})]}),u&&C.jsxs(C.Fragment,{children:[C.jsx("button",{onClick:M,className:"fixed left-4 md:left-8 top-1/2 -translate-y-1/2 z-40 p-3 md:p-6 bg-white/5 hover:bg-white/10 backdrop-blur-xl border border-white/10 rounded-full transition-all active:scale-90 group shadow-2xl",children:C.jsx(ss,{className:"w-8 h-8 md:w-12 md:h-12 text-white/50 group-hover:text-white group-hover:-translate-x-1 transition-all"})}),C.jsx("button",{onClick:U,className:`fixed ${e?"right-122.5":"right-8"} top-1/2 -translate-y-1/2 z-40 p-6 bg-white/5 hover:bg-white/10 backdrop-blur-xl border border-white/10 rounded-full active:scale-90 group hidden md:block shadow-2xl transition-all duration-300`,children:C.jsx(oa,{className:"w-12 h-12 text-white/50 group-hover:text-white group-hover:translate-x-1 transition-all"})}),!e&&C.jsx("button",{onClick:U,className:"fixed right-4 top-1/2 -translate-y-1/2 z-40 p-3 bg-white/5 hover:bg-white/10 backdrop-blur-xl border border-white/10 rounded-full transition-all active:scale-90 group md:hidden shadow-2xl",children:C.jsx(oa,{className:"w-8 h-8 text-white/50 group-hover:text-white group-hover:translate-x-1 transition-all"})})]}),u&&C.jsxs("div",{className:`absolute bottom-8 md:bottom-10 left-1/2 z-40 flex items-center gap-2 md:gap-4 bg-slate-900/90 backdrop-blur-3xl border border-white/10 p-2 md:p-4 rounded-3xl md:rounded-4xl shadow-2xl transition-all duration-300 ${e?"max-md:opacity-0 max-md:pointer-events-none max-md:translate-y-10 -translate-x-1/2 md:-translate-x-[calc(50%+241px)]":"-translate-x-1/2 opacity-100"}`,children:[[{id:vt.ATOMIC,icon:ds,label:"Atomic",available:!0},{id:vt.CRYSTAL,icon:Za,label:"Crystal",available:!!u.crystal_structure},{id:vt.REACTION,icon:$a,label:"Reactivity",available:!!u.reaction_type}].map(g=>C.jsxs("button",{disabled:!g.available,onClick:()=>a(g.id),className:`flex items-center gap-2 md:gap-2.5 px-4 md:px-6 py-2 md:py-3 rounded-xl md:rounded-2xl transition-all duration-300 ${o===g.id?"bg-blue-600 text-white shadow-[0_0_25px_rgba(37,99,235,0.5)] scale-105":g.available?"text-slate-400 hover:bg-white/10 hover:text-white":"opacity-20 cursor-not-allowed"}`,children:[C.jsx(g.icon,{className:"w-4 h-4 md:w-5 md:h-5"}),C.jsx("span",{className:"font-bold text-xs md:text-sm hidden sm:block",children:g.label})]},g.id)),C.jsx("div",{className:"w-px h-6 bg-white/10 mx-1 md:mx-2"}),C.jsxs("button",{onClick:()=>S(!e),className:`flex items-center gap-2 md:gap-2.5 px-4 md:px-6 py-2 md:py-3 rounded-xl md:rounded-2xl transition-all duration-300 ${e?"bg-white/10 text-white":"bg-indigo-600 text-white shadow-[0_0_20px_rgba(79,70,229,0.4)]"}`,children:[C.jsx(Ha,{className:"w-4 h-4 md:w-5 md:h-5"}),C.jsx("span",{className:"font-bold text-xs md:text-sm hidden sm:block",children:"Info"})]})]}),e&&C.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 md:hidden transition-opacity animate-fade-in",onClick:()=>S(!1)}),C.jsx(bc,{element:u,isOpen:e,onClose:()=>S(!1)})]})},Qc={fullscreen:!0};function qc(){return[{title:"3D Periodic Table | Elemental3D"},{property:"og:title",content:"3D Periodic Table | Elemental3D"},{name:"description",content:"An interactive 3D Periodic Table explorer built with React Three Fiber. Explore elements in 3D space with atomic, crystal, and reaction views."}]}const Zc=To(Ac);export{Zc as default,Qc as handle,qc as meta};
