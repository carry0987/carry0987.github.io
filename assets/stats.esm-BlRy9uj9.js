var l=Object.defineProperty;var m=(o,i,s)=>i in o?l(o,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[i]=s;var e=(o,i,s)=>m(o,typeof i!="symbol"?i+"":i,s);class r{constructor(i,s,n){e(this,"name");e(this,"fg");e(this,"bg");e(this,"min",1/0);e(this,"max",0);e(this,"round",Math.round);e(this,"sizeOptions");e(this,"dom");this.name=i,this.fg=s,this.bg=n;const t=this.round(window.devicePixelRatio||1);this.sizeOptions={pr:t,width:80*t,height:48*t,textX:3*t,textY:2*t,graphX:3*t,graphY:15*t,graphWidth:74*t,graphHeight:30*t},this.dom=document.createElement("canvas"),this.dom.width=this.sizeOptions.width,this.dom.height=this.sizeOptions.height,this.dom.style.cssText="width:80px;height:48px";const h=this.dom.getContext("2d");if(!h)throw new Error("Unable to get 2d context");h.font=`bold ${9*t}px Helvetica,Arial,sans-serif`,h.textBaseline="top",h.fillStyle=this.bg,h.fillRect(0,0,this.sizeOptions.width,this.sizeOptions.height),h.fillStyle=this.fg,h.fillText(this.name,this.sizeOptions.textX,this.sizeOptions.textY),h.fillRect(this.sizeOptions.graphX,this.sizeOptions.graphY,this.sizeOptions.graphWidth,this.sizeOptions.graphHeight),h.fillStyle=this.bg,h.globalAlpha=.9,h.fillRect(this.sizeOptions.graphX,this.sizeOptions.graphY,this.sizeOptions.graphWidth,this.sizeOptions.graphHeight)}update(i,s){this.min=Math.min(this.min,i),this.max=Math.max(this.max,i);const n=this.sizeOptions.pr,t=this.dom.getContext("2d");if(!t)throw new Error("Unable to get 2d context");t.fillStyle=this.bg,t.globalAlpha=1,t.fillRect(0,0,this.sizeOptions.width,this.sizeOptions.graphY),t.fillStyle=this.fg,t.fillText(`${this.round(i)} ${this.name} (${this.round(this.min)}-${this.round(this.max)})`,this.sizeOptions.textX,this.sizeOptions.textY),t.drawImage(this.dom,this.sizeOptions.graphX+n,this.sizeOptions.graphY,this.sizeOptions.graphWidth-n,this.sizeOptions.graphHeight,this.sizeOptions.graphX,this.sizeOptions.graphY,this.sizeOptions.graphWidth-n,this.sizeOptions.graphHeight),t.fillRect(this.sizeOptions.graphX+this.sizeOptions.graphWidth-n,this.sizeOptions.graphY,n,this.sizeOptions.graphHeight),t.fillStyle=this.bg,t.globalAlpha=.9,t.fillRect(this.sizeOptions.graphX+this.sizeOptions.graphWidth-n,this.sizeOptions.graphY,n,this.round((1-i/s)*this.sizeOptions.graphHeight))}}const a=class a{constructor(){e(this,"performanceInfo",self.performance);e(this,"mode",0);e(this,"container");e(this,"beginTime",(this.performanceInfo||Date).now());e(this,"prevTime",this.beginTime);e(this,"frames",0);e(this,"fpsPanel");e(this,"msPanel");e(this,"memPanel");this.container=document.createElement("div"),this.container.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:90000",this.container.addEventListener("click",i=>{i.preventDefault(),this.showPanel(++this.mode%this.container.children.length)},!1),this.fpsPanel=this.addPanel(new r("FPS","#0ff","#002")),this.msPanel=this.addPanel(new r("MS","#0f0","#020")),"memory"in this.performanceInfo&&(this.memPanel=this.addPanel(new r("MB","#f08","#201"))),this.showPanel(0)}begin(){this.beginTime=(this.performanceInfo||Date).now()}end(){this.frames++;const i=(this.performanceInfo||Date).now();if(this.msPanel.update(i-this.beginTime,200),i>=this.prevTime+1e3&&(this.fpsPanel.update(this.frames*1e3/(i-this.prevTime),100),this.prevTime=i,this.frames=0,this.memPanel)){const s=this.performanceInfo.memory;this.memPanel.update(s.usedJSHeapSize/1048576,s.jsHeapSizeLimit/1048576)}return i}update(){this.beginTime=this.end()}get version(){return a.version}get dom(){return this.container}setMode(i){this.showPanel(i)}addPanel(i){return this.container.appendChild(i.dom),i}showPanel(i){for(let s=0;s<this.container.children.length;s++)this.container.children[s].style.display=s===i?"block":"none";this.mode=i}};e(a,"version","1.0.1");let p=a;export{p as S};
